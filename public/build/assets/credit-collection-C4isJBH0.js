import{r as S,u as L,j as e}from"./app-B6lirdlh.js";import{I as u}from"./InputError-DSsPX8nw.js";import{B as te}from"./badge-BCXijmTV.js";import{c as ae,F as p}from"./createLucideIcon-D4jR-BHI.js";import{C as n,a as c,b as o,c as i}from"./card-y7TeMzlQ.js";import{D as P,a as le,b as B,c as R,d as q}from"./dialog-CPHFziJb.js";import{I as d}from"./index-C1QFYvfO.js";import{L as x}from"./label-Bxf_TVtZ.js";import{S as re,a as ne,b as ce,c as oe,d as ie}from"./select-CRDghA5t.js";import{T,a as D,b as r,c as l,d as _,e as t}from"./table-Dwi86hgx.js";import{A as de}from"./app-layout-C1wjfMPJ.js";import{T as xe}from"./trending-down-BvVsSVUd.js";import{T as k}from"./triangle-alert-1Pejf9t_.js";import{P as me}from"./plus-Bt8nBrhT.js";import"./index-F8aK6LC_.js";import"./index-B05QmqfG.js";import"./index-B5z19LkR.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],M=ae("Wallet",he);function Ee({credit_collections:g=[],outstanding_debts:N=[],expenses:f=[],customers:V=[]}){const[Q,b]=S.useState(!1),[H,W]=S.useState(""),[z,E]=S.useState(!1),$=N.filter(s=>s.customer.toLowerCase().includes(H.toLowerCase())),{data:v,setData:m,post:J,processing:A,errors:h,reset:K}=L({customer_id:"",amount_collected:"",notes:""}),{data:C,setData:y,post:U,processing:O,errors:j,reset:X}=L({description:"",amount:"",notes:"",date:new Date().toISOString().split("T")[0]}),Y=[{title:"Credit Collection",href:"/credit-collection"}];function Z(s){s.preventDefault(),U(route("expenses.store"),{onSuccess:()=>{X(),E(!1)},onError:a=>{},preserveScroll:!0})}function ee(s){m({customer_id:s.customer_id,amount_collected:"",notes:""}),b(!0)}function se(s){s.preventDefault(),J(route("credit-collection.store"),{onSuccess:()=>{K(),b(!1)},preserveScroll:!0})}const F=g.reduce((s,a)=>s+parseFloat(a.amount_collected),0),w=f.reduce((s,a)=>s+parseFloat(a.amount),0),G=F-w,I=N.reduce((s,a)=>s+parseFloat(a.balance),0);return e.jsx(de,{breadcrumbs:Y,children:e.jsxs("div",{className:"min-h-screen space-y-6 bg-gray-100 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Credit Collection & Debt Management"})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-4",children:[e.jsxs(n,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Collections Today"}),e.jsx(M,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(i,{children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["GH₵",F.toFixed(2)]}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:["From ",g.length," customers"]})]})]}),e.jsxs(n,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Expenses Today"}),e.jsx(xe,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(i,{children:[e.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["GH₵",w.toFixed(2)]}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:[f.length," expense items"]})]})]}),e.jsxs(n,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Net Amount"}),e.jsx(M,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(i,{children:[e.jsxs("div",{className:`text-2xl font-bold ${G>=0?"text-green-600":"text-red-600"}`,children:["GH₵",G.toFixed(2)]}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Collections - Expenses"})]})]}),e.jsxs(n,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"Total Outstanding"}),e.jsx(k,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(i,{children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["GH₵",I.toFixed(2)]}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:[N.length," customers"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[e.jsxs(n,{children:[e.jsx(c,{children:e.jsx(o,{children:"Amount Collected from Creditors Today"})}),e.jsx(i,{children:e.jsxs(T,{children:[e.jsx(D,{children:e.jsxs(r,{children:[e.jsx(l,{children:"Customer Name"}),e.jsx(l,{children:"Amount Collected"})]})}),e.jsxs(_,{children:[g.map((s,a)=>e.jsxs(r,{children:[e.jsx(t,{className:"font-medium",children:s.customer}),e.jsxs(t,{className:"font-medium text-green-600",children:["GH₵",parseFloat(s.amount_collected).toFixed(2)]})]},a)),e.jsxs(r,{className:"bg-green-50",children:[e.jsx(t,{className:"font-bold",children:"Total Collected"}),e.jsxs(t,{className:"font-bold text-green-600",children:["GH₵",F.toFixed(2)]})]})]})]})})]}),e.jsxs(n,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between",children:[e.jsx(o,{children:"Daily Expenses"}),e.jsxs(P,{open:z,onOpenChange:E,children:[e.jsx(le,{asChild:!0,children:e.jsxs(p,{children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Add Expense"]})}),e.jsxs(B,{className:"sm:max-w-[425px]",children:[e.jsx(R,{children:e.jsx(q,{children:"Add New Expense"})}),e.jsxs("form",{onSubmit:Z,className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(x,{htmlFor:"description",className:"text-right",children:"Description"}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(d,{id:"description",placeholder:"Expense description",value:C.description,onChange:s=>y("description",s.target.value),required:!0}),j.description&&e.jsx(u,{message:j.description,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(x,{htmlFor:"amount",className:"text-right",children:"Amount (GH₵)"}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(d,{id:"amount",type:"number",placeholder:"0.00",value:C.amount,onChange:s=>y("amount",s.target.value),required:!0}),j.amount&&e.jsx(u,{message:j.amount,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(x,{htmlFor:"notes",className:"text-right",children:"Notes"}),e.jsx("div",{className:"col-span-3",children:e.jsx(d,{id:"notes",placeholder:"Optional notes",value:C.notes,onChange:s=>y("notes",s.target.value)})})]}),e.jsx(p,{type:"submit",disabled:O,children:O?"Adding...":"Add Expense"})]})]})]})]}),e.jsx(i,{children:e.jsxs(T,{children:[e.jsx(D,{children:e.jsxs(r,{children:[e.jsx(l,{children:"Description"}),e.jsx(l,{children:"Amount"})]})}),e.jsxs(_,{children:[f.map((s,a)=>e.jsxs(r,{children:[e.jsx(t,{className:"font-medium",children:s.description}),e.jsxs(t,{className:"font-medium text-red-600",children:["GH₵",parseFloat(s.amount).toFixed(2)]})]},a)),e.jsxs(r,{className:"bg-red-50",children:[e.jsx(t,{className:"font-bold",children:"Total Expenses"}),e.jsxs(t,{className:"font-bold text-red-600",children:["GH₵",w.toFixed(2)]})]})]})]})})]})]}),e.jsxs(n,{children:[e.jsxs(c,{className:"flex flex-col space-y-4",children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-orange-600"}),"Outstanding Customer Debts"]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(d,{placeholder:"Search customers...",value:H,onChange:s=>W(s.target.value),className:"max-w-sm"})})]}),e.jsx(i,{children:e.jsxs(T,{children:[e.jsx(D,{children:e.jsxs(r,{children:[e.jsx(l,{children:"Customer Name"}),e.jsx(l,{children:"Total Debt"}),e.jsx(l,{children:"Amount Paid"}),e.jsx(l,{children:"Outstanding Balance"}),e.jsx(l,{children:"Last Payment"}),e.jsx(l,{children:"Days Overdue"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Actions"})]})}),e.jsxs(_,{children:[$.map((s,a)=>e.jsxs(r,{children:[e.jsx(t,{className:"font-medium",children:s.customer}),e.jsxs(t,{children:["GH₵",parseFloat(s.total_debt).toFixed(2)]}),e.jsxs(t,{className:"text-green-600",children:["GH₵",parseFloat(s.amount_paid).toFixed(2)]}),e.jsxs(t,{className:"font-medium text-orange-600",children:["GH₵",parseFloat(s.balance).toFixed(2)]}),e.jsx(t,{children:s.last_payment}),e.jsxs(t,{className:s.days_overdue>14?"font-medium text-red-600":"text-orange-600",children:[s.days_overdue," days"]}),e.jsx(t,{children:e.jsx(te,{className:s.days_overdue>14?"bg-red-600 text-white hover:bg-red-700":"bg-orange-600 text-white hover:bg-orange-700",children:s.days_overdue>14?"Critical":"Overdue"})}),e.jsx(t,{children:e.jsx(p,{variant:"outline",size:"sm",onClick:()=>ee(s),children:"Collect"})})]},a)),e.jsxs(r,{className:"bg-orange-50",children:[e.jsx(t,{colSpan:3,className:"font-bold",children:"Total Outstanding"}),e.jsxs(t,{className:"font-bold text-orange-600",children:["GH₵",I.toFixed(2)]}),e.jsx(t,{colSpan:4})]})]})]})})]}),e.jsx(P,{open:Q,onOpenChange:b,children:e.jsxs(B,{className:"sm:max-w-[425px]",children:[e.jsx(R,{children:e.jsx(q,{children:"Record Credit Collection"})}),e.jsxs("form",{onSubmit:se,className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(x,{htmlFor:"customer",className:"text-right",children:"Customer"}),e.jsxs(re,{value:v.customer_id,onValueChange:s=>m("customer_id",s),disabled:!0,children:[e.jsx(ne,{className:"col-span-3",children:e.jsx(ce,{placeholder:"Select customer"})}),e.jsx(oe,{children:V.map(s=>e.jsx(ie,{value:s.id,children:s.name},s.id))})]}),h.customer_id&&e.jsx(u,{message:h.customer_id,className:"mt-2"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(x,{htmlFor:"amount",className:"text-right",children:"Amount (GH₵)"}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(d,{id:"amount",type:"number",className:"w-full",placeholder:"0.00",value:v.amount_collected,onChange:s=>m("amount_collected",s.target.value),required:!0}),h.amount_collected&&e.jsx(u,{message:h.amount_collected,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(x,{htmlFor:"notes",className:"text-right",children:"Notes"}),e.jsx("div",{className:"col-span-3",children:e.jsx(d,{id:"notes",placeholder:"Optional notes",value:v.notes,onChange:s=>m("notes",s.target.value)})})]}),e.jsx(p,{type:"submit",disabled:A,children:A?"Recording...":"Record Collection"})]})]})})]})})}export{Ee as default};
