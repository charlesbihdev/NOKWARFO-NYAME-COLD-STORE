import{r as x,u as k,j as e,a as z}from"./app-BYPHfxF9.js";import{I as y}from"./InputError-mjMIRtxw.js";import{B as M}from"./badge-BPiTQ2HT.js";import{F as w}from"./createLucideIcon-BUPQzdq3.js";import{C as h,a as u,b as j,c as g}from"./card-_ST2Ydw7.js";import{D as J,b as K,c as U,d as X}from"./dialog-B5TgrcrI.js";import{I as d}from"./input-D4pf4mNP.js";import{L as p}from"./label-C_223ziE.js";import{S as Y,a as Z,b as $,c as ee,d as se}from"./select-DIkBi26I.js";import{T as F,a as _,b as n,c as a,d as T,e as t}from"./table-BA4D_exN.js";import{A as te,W as ae}from"./app-layout-FyhEREU3.js";import{T as H}from"./triangle-alert-LqmwBNm1.js";import"./index-Duea9iH8.js";import"./index-BZ5I5kC3.js";import"./index-iqFZZ2qt.js";function fe({credit_collections:N=[],outstanding_debts:f=[],customers:O=[],date:G}){const[A,b]=x.useState(!1),[v,L]=x.useState(""),[c,I]=x.useState(G||new Date().toISOString().split("T")[0]),[o,B]=x.useState(null),P=f.filter(s=>s.customer.toLowerCase().includes(v.toLowerCase())),{data:m,setData:i,post:R,processing:C,errors:r,reset:E}=k({customer_id:"",amount_collected:"",payment_date:new Date().toISOString().split("T")[0],notes:""}),q=[{title:"Credit Collection",href:"/credit-collection"}];function Q(s){B(s),i({customer_id:s.customer_id,amount_collected:"",payment_date:new Date().toISOString().split("T")[0],notes:""}),b(!0)}function V(s){s.preventDefault(),R(route("credit-collection.store"),{onSuccess:()=>{E(),b(!1)},preserveScroll:!0})}const D=N.reduce((s,l)=>s+parseFloat(l.amount_collected),0),S=f.reduce((s,l)=>s+parseFloat(l.balance),0),W=s=>{const l=s.target.value;I(l),z.get(route("credit-collection.index"),{date:l},{preserveState:!0,replace:!0})};return e.jsx(te,{breadcrumbs:q,children:e.jsxs("div",{className:"min-h-screen space-y-6 bg-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Credit Collection & Debt Management"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"Collection Date"}),e.jsx(d,{type:"date",value:c,onChange:W,className:"w-auto"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs(h,{children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:"Collections for Selected Date"}),e.jsx(ae,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(g,{children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["GH₵",D.toFixed(2)]}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:["From ",N.length," customers on ",new Date(c).toLocaleDateString()]})]})]}),e.jsxs(h,{children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:"Total Outstanding (As of Date)"}),e.jsx(H,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(g,{children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["GH₵",S.toFixed(2)]}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:[f.length," customers as of ",new Date(c).toLocaleDateString()]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:e.jsxs(h,{children:[e.jsx(u,{children:e.jsxs(j,{children:["Amount Collected from Creditors (",new Date(c).toLocaleDateString(),")"]})}),e.jsx(g,{children:e.jsxs(F,{children:[e.jsx(_,{children:e.jsxs(n,{children:[e.jsx(a,{children:"Customer Name"}),e.jsx(a,{children:"Amount Collected"}),e.jsx(a,{children:"Payment Date"})]})}),e.jsxs(T,{children:[N.map((s,l)=>e.jsxs(n,{children:[e.jsx(t,{className:"font-medium",children:s.customer}),e.jsxs(t,{className:"font-medium text-green-600",children:["GH₵",parseFloat(s.amount_collected).toFixed(2)]}),e.jsx(t,{className:"text-gray-600",children:s.payment_date})]},l)),e.jsxs(n,{className:"bg-green-50",children:[e.jsx(t,{className:"font-bold",children:"Total Collected"}),e.jsxs(t,{className:"font-bold text-green-600",children:["GH₵",D.toFixed(2)]}),e.jsx(t,{})]})]})]})})]})}),e.jsxs(h,{children:[e.jsxs(u,{className:"flex flex-col space-y-4",children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5 text-orange-600"}),"Outstanding Customer Debts (As of ",new Date(c).toLocaleDateString(),")"]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(d,{placeholder:"Search customers...",value:v,onChange:s=>L(s.target.value),className:"max-w-sm"})})]}),e.jsx(g,{children:e.jsxs(F,{children:[e.jsx(_,{children:e.jsxs(n,{children:[e.jsx(a,{children:"Customer Name"}),e.jsx(a,{children:"Total Debt"}),e.jsx(a,{children:"Amount Paid"}),e.jsx(a,{children:"Outstanding Balance"}),e.jsx(a,{children:"Last Payment"}),e.jsx(a,{children:"Days Overdue"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Actions"})]})}),e.jsxs(T,{children:[P.map((s,l)=>e.jsxs(n,{children:[e.jsx(t,{className:"font-medium",children:s.customer}),e.jsxs(t,{children:["GH₵",parseFloat(s.total_debt).toFixed(2)]}),e.jsxs(t,{className:"text-green-600",children:["GH₵",parseFloat(s.amount_paid).toFixed(2)]}),e.jsxs(t,{className:"font-medium text-orange-600",children:["GH₵",parseFloat(s.balance).toFixed(2)]}),e.jsx(t,{children:s.last_payment}),e.jsxs(t,{className:s.days_overdue>14?"font-medium text-red-600":"text-orange-600",children:[s.days_overdue," days"]}),e.jsx(t,{children:e.jsx(M,{className:s.days_overdue>14?"bg-red-600 text-white hover:bg-red-700":"bg-orange-600 text-white hover:bg-orange-700",children:s.days_overdue>14?"Critical":"Overdue"})}),e.jsx(t,{children:e.jsx(w,{variant:"outline",size:"sm",onClick:()=>Q(s),children:"Collect"})})]},l)),e.jsxs(n,{className:"bg-orange-50",children:[e.jsx(t,{colSpan:3,className:"font-bold",children:"Total Outstanding"}),e.jsxs(t,{className:"font-bold text-orange-600",children:["GH₵",S.toFixed(2)]}),e.jsx(t,{colSpan:4})]})]})]})})]}),e.jsx(J,{open:A,onOpenChange:b,children:e.jsxs(K,{className:"sm:max-w-[425px]",children:[e.jsx(U,{children:e.jsx(X,{children:"Record Credit Collection"})}),o&&e.jsxs("div",{className:"rounded-lg border border-orange-200 bg-orange-50 p-4",children:[e.jsx("div",{className:"mb-2",children:e.jsx("h4",{className:"font-semibold text-gray-900",children:o.customer})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Outstanding Debt:"}),e.jsxs("span",{className:"text-xl font-bold text-orange-600",children:["GH₵",parseFloat(o.balance).toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total Debt:"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["GH₵",parseFloat(o.total_debt).toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Paid So Far:"}),e.jsxs("span",{className:"font-medium text-green-600",children:["GH₵",parseFloat(o.amount_paid).toFixed(2)]})]})]})]}),e.jsxs("form",{onSubmit:V,className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(p,{htmlFor:"customer",className:"text-right",children:"Customer"}),e.jsxs(Y,{value:m.customer_id,onValueChange:s=>i("customer_id",s),disabled:!0,children:[e.jsx(Z,{className:"col-span-3",children:e.jsx($,{placeholder:"Select customer"})}),e.jsx(ee,{children:O.map(s=>e.jsx(se,{value:s.id,children:s.name},s.id))})]}),r.customer_id&&e.jsx(y,{message:r.customer_id,className:"mt-2"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(p,{htmlFor:"amount",className:"text-right",children:"Amount (GH₵)"}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(d,{id:"amount",type:"number",className:"w-full",placeholder:"0.00",value:m.amount_collected,onChange:s=>i("amount_collected",s.target.value),required:!0}),r.amount_collected&&e.jsx(y,{message:r.amount_collected,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(p,{htmlFor:"payment_date",className:"text-right",children:"Payment Date"}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(d,{id:"payment_date",type:"date",className:"w-full",value:m.payment_date,onChange:s=>i("payment_date",s.target.value),required:!0}),r.payment_date&&e.jsx(y,{message:r.payment_date,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(p,{htmlFor:"notes",className:"text-right",children:"Notes"}),e.jsx("div",{className:"col-span-3",children:e.jsx(d,{id:"notes",placeholder:"Optional notes",value:m.notes,onChange:s=>i("notes",s.target.value)})})]}),e.jsx(w,{type:"submit",disabled:C,children:C?"Recording...":"Record Collection"})]})]})})]})})}export{fe as default};
