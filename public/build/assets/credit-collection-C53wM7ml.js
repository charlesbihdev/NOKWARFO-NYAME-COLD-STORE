import{r as N,u as M,j as e,a as V}from"./app-CXv92zGC.js";import{I as v}from"./InputError-DlFXiFDr.js";import{B as Q}from"./badge-CwFSuoKi.js";import{c as W,F as S}from"./createLucideIcon-DeduJ6FE.js";import{C as m,a as x,b as h,c as u}from"./card-DPUFczs4.js";import{D as z,b as J,c as K,d as U}from"./dialog-sXuYTDer.js";import{I as i}from"./input-D1-NHXK8.js";import{L as j}from"./label-0YKF92up.js";import{S as X,a as Y,b as Z,c as $,d as ee}from"./select-JIxnTnpV.js";import{T as _,a as w,b as c,c as a,d as F,e as t}from"./table-CnwhADRq.js";import{A as se}from"./app-layout-Cw1uuZE5.js";import{T}from"./triangle-alert-ouj7r8DW.js";import"./index-C1-XX1L-.js";import"./index-DPINtf2A.js";import"./index-xkERhRTZ.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],ae=W("Wallet",te);function Ne({credit_collections:g=[],outstanding_debts:p=[],customers:H=[],date:O}){const[L,f]=N.useState(!1),[C,A]=N.useState(""),[n,G]=N.useState(O||new Date().toISOString().split("T")[0]),I=p.filter(s=>s.customer.toLowerCase().includes(C.toLowerCase())),{data:d,setData:o,post:B,processing:y,errors:r,reset:R}=M({customer_id:"",amount_collected:"",payment_date:new Date().toISOString().split("T")[0],notes:""}),P=[{title:"Credit Collection",href:"/credit-collection"}];function k(s){o({customer_id:s.customer_id,amount_collected:"",payment_date:new Date().toISOString().split("T")[0],notes:""}),f(!0)}function q(s){s.preventDefault(),B(route("credit-collection.store"),{onSuccess:()=>{R(),f(!1)},preserveScroll:!0})}const b=g.reduce((s,l)=>s+parseFloat(l.amount_collected),0),D=p.reduce((s,l)=>s+parseFloat(l.balance),0),E=s=>{const l=s.target.value;G(l),V.get(route("credit-collection.index"),{date:l},{preserveState:!0,replace:!0})};return e.jsx(se,{breadcrumbs:P,children:e.jsxs("div",{className:"min-h-screen space-y-6 bg-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Credit Collection & Debt Management"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"Collection Date"}),e.jsx(i,{type:"date",value:n,onChange:E,className:"w-auto"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs(m,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium",children:"Collections for Selected Date"}),e.jsx(ae,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(u,{children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["GH₵",b.toFixed(2)]}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:["From ",g.length," customers on ",new Date(n).toLocaleDateString()]})]})]}),e.jsxs(m,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium",children:"Total Outstanding (As of Date)"}),e.jsx(T,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(u,{children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["GH₵",D.toFixed(2)]}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:[p.length," customers as of ",new Date(n).toLocaleDateString()]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs(h,{children:["Amount Collected from Creditors (",new Date(n).toLocaleDateString(),")"]})}),e.jsx(u,{children:e.jsxs(_,{children:[e.jsx(w,{children:e.jsxs(c,{children:[e.jsx(a,{children:"Customer Name"}),e.jsx(a,{children:"Amount Collected"}),e.jsx(a,{children:"Payment Date"})]})}),e.jsxs(F,{children:[g.map((s,l)=>e.jsxs(c,{children:[e.jsx(t,{className:"font-medium",children:s.customer}),e.jsxs(t,{className:"font-medium text-green-600",children:["GH₵",parseFloat(s.amount_collected).toFixed(2)]}),e.jsx(t,{className:"text-gray-600",children:s.payment_date})]},l)),e.jsxs(c,{className:"bg-green-50",children:[e.jsx(t,{className:"font-bold",children:"Total Collected"}),e.jsxs(t,{className:"font-bold text-green-600",children:["GH₵",b.toFixed(2)]}),e.jsx(t,{})]})]})]})})]})}),e.jsxs(m,{children:[e.jsxs(x,{className:"flex flex-col space-y-4",children:[e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5 text-orange-600"}),"Outstanding Customer Debts (As of ",new Date(n).toLocaleDateString(),")"]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(i,{placeholder:"Search customers...",value:C,onChange:s=>A(s.target.value),className:"max-w-sm"})})]}),e.jsx(u,{children:e.jsxs(_,{children:[e.jsx(w,{children:e.jsxs(c,{children:[e.jsx(a,{children:"Customer Name"}),e.jsx(a,{children:"Total Debt"}),e.jsx(a,{children:"Amount Paid"}),e.jsx(a,{children:"Outstanding Balance"}),e.jsx(a,{children:"Last Payment"}),e.jsx(a,{children:"Days Overdue"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Actions"})]})}),e.jsxs(F,{children:[I.map((s,l)=>e.jsxs(c,{children:[e.jsx(t,{className:"font-medium",children:s.customer}),e.jsxs(t,{children:["GH₵",parseFloat(s.total_debt).toFixed(2)]}),e.jsxs(t,{className:"text-green-600",children:["GH₵",parseFloat(s.amount_paid).toFixed(2)]}),e.jsxs(t,{className:"font-medium text-orange-600",children:["GH₵",parseFloat(s.balance).toFixed(2)]}),e.jsx(t,{children:s.last_payment}),e.jsxs(t,{className:s.days_overdue>14?"font-medium text-red-600":"text-orange-600",children:[s.days_overdue," days"]}),e.jsx(t,{children:e.jsx(Q,{className:s.days_overdue>14?"bg-red-600 text-white hover:bg-red-700":"bg-orange-600 text-white hover:bg-orange-700",children:s.days_overdue>14?"Critical":"Overdue"})}),e.jsx(t,{children:e.jsx(S,{variant:"outline",size:"sm",onClick:()=>k(s),children:"Collect"})})]},l)),e.jsxs(c,{className:"bg-orange-50",children:[e.jsx(t,{colSpan:3,className:"font-bold",children:"Total Outstanding"}),e.jsxs(t,{className:"font-bold text-orange-600",children:["GH₵",D.toFixed(2)]}),e.jsx(t,{colSpan:4})]})]})]})})]}),e.jsx(z,{open:L,onOpenChange:f,children:e.jsxs(J,{className:"sm:max-w-[425px]",children:[e.jsx(K,{children:e.jsx(U,{children:"Record Credit Collection"})}),e.jsxs("form",{onSubmit:q,className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(j,{htmlFor:"customer",className:"text-right",children:"Customer"}),e.jsxs(X,{value:d.customer_id,onValueChange:s=>o("customer_id",s),disabled:!0,children:[e.jsx(Y,{className:"col-span-3",children:e.jsx(Z,{placeholder:"Select customer"})}),e.jsx($,{children:H.map(s=>e.jsx(ee,{value:s.id,children:s.name},s.id))})]}),r.customer_id&&e.jsx(v,{message:r.customer_id,className:"mt-2"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(j,{htmlFor:"amount",className:"text-right",children:"Amount (GH₵)"}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{id:"amount",type:"number",className:"w-full",placeholder:"0.00",value:d.amount_collected,onChange:s=>o("amount_collected",s.target.value),required:!0}),r.amount_collected&&e.jsx(v,{message:r.amount_collected,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(j,{htmlFor:"payment_date",className:"text-right",children:"Payment Date"}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(i,{id:"payment_date",type:"date",className:"w-full",value:d.payment_date,onChange:s=>o("payment_date",s.target.value),required:!0}),r.payment_date&&e.jsx(v,{message:r.payment_date,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(j,{htmlFor:"notes",className:"text-right",children:"Notes"}),e.jsx("div",{className:"col-span-3",children:e.jsx(i,{id:"notes",placeholder:"Optional notes",value:d.notes,onChange:s=>o("notes",s.target.value)})})]}),e.jsx(S,{type:"submit",disabled:y,children:y?"Recording...":"Record Collection"})]})]})})]})})}export{Ne as default};
