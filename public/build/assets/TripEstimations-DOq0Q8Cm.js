import{j as e,r as w,G as Y,u as oe,L as ne,a as re}from"./app-BsTl-jtS.js";import{A as Se,M as Te,T as ce}from"./app-layout-CxsX89b6.js";import{D as Ae}from"./DateRangePicker-BwoWWjnY.js";import{c as ee,u as de,a as Pe,b as U,d as me,F as T}from"./createLucideIcon-DqPu5nj0.js";import{C as G,a as H,b as z,c as Q}from"./card-CpArIIAG.js";import{B as ke}from"./badge-Basujmit.js";import{T as qe,a as Ee,b as X,c as F,d as Fe,e as k}from"./table-Cb5fe21K.js";import{c as Ie,a as Me}from"./index-D_DDstXb.js";import{g as xe,R as Re,P as Oe,W as Ue,C as Le,T as Ge,h as He,i as pe,O as ze,j as Qe,D as te,b as se,c as ae,d as le}from"./dialog-Dr4RSNtO.js";import{I as h}from"./input-DNFionIr.js";import{L as o}from"./label-Ce2cjAzt.js";import{T as ue}from"./textarea-B9EwZDcA.js";import{I as u}from"./InputError-DAeUpwyY.js";import{P as ie}from"./plus-bko0k5mB.js";import{T as B}from"./trash-2-Dv8_XEWT.js";import{D as Z}from"./dollar-sign-D5C6XolU.js";import{C as Be}from"./calendar-C3F2nz_B.js";import"./index-BvTb0DQp.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],he=ee("Calculator",We);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ye=ee("Eye",Ve);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Je=ee("Pen",Ke);var ge="AlertDialog",[Xe]=Ie(ge,[xe]),M=xe(),je=x=>{const{__scopeAlertDialog:c,...r}=x,p=M(c);return e.jsx(Re,{...p,...r,modal:!0})};je.displayName=ge;var Ze="AlertDialogTrigger",et=w.forwardRef((x,c)=>{const{__scopeAlertDialog:r,...p}=x,l=M(r);return e.jsx(Qe,{...l,...p,ref:c})});et.displayName=Ze;var tt="AlertDialogPortal",fe=x=>{const{__scopeAlertDialog:c,...r}=x,p=M(c);return e.jsx(Oe,{...p,...r})};fe.displayName=tt;var st="AlertDialogOverlay",ve=w.forwardRef((x,c)=>{const{__scopeAlertDialog:r,...p}=x,l=M(r);return e.jsx(ze,{...l,...p,ref:c})});ve.displayName=st;var V="AlertDialogContent",[at,lt]=Xe(V),it=Pe("AlertDialogContent"),Ne=w.forwardRef((x,c)=>{const{__scopeAlertDialog:r,children:p,...l}=x,n=M(r),f=w.useRef(null),b=de(c,f),j=w.useRef(null);return e.jsx(Ue,{contentName:V,titleName:_e,docsSlug:"alert-dialog",children:e.jsx(at,{scope:r,cancelRef:j,children:e.jsxs(Le,{role:"alertdialog",...n,...l,ref:b,onOpenAutoFocus:Me(l.onOpenAutoFocus,y=>{var A;y.preventDefault(),(A=j.current)==null||A.focus({preventScroll:!0})}),onPointerDownOutside:y=>y.preventDefault(),onInteractOutside:y=>y.preventDefault(),children:[e.jsx(it,{children:p}),e.jsx(rt,{contentRef:f})]})})})});Ne.displayName=V;var _e="AlertDialogTitle",ye=w.forwardRef((x,c)=>{const{__scopeAlertDialog:r,...p}=x,l=M(r);return e.jsx(Ge,{...l,...p,ref:c})});ye.displayName=_e;var be="AlertDialogDescription",Ce=w.forwardRef((x,c)=>{const{__scopeAlertDialog:r,...p}=x,l=M(r);return e.jsx(He,{...l,...p,ref:c})});Ce.displayName=be;var nt="AlertDialogAction",we=w.forwardRef((x,c)=>{const{__scopeAlertDialog:r,...p}=x,l=M(r);return e.jsx(pe,{...l,...p,ref:c})});we.displayName=nt;var $e="AlertDialogCancel",De=w.forwardRef((x,c)=>{const{__scopeAlertDialog:r,...p}=x,{cancelRef:l}=lt($e,r),n=M(r),f=de(c,l);return e.jsx(pe,{...n,...p,ref:f})});De.displayName=$e;var rt=({contentRef:x})=>{const c=`\`${V}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${V}\` by passing a \`${be}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${V}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return w.useEffect(()=>{var p;document.getElementById((p=x.current)==null?void 0:p.getAttribute("aria-describedby"))||console.warn(c)},[c,x]),null},ct=je,ot=fe,dt=ve,mt=Ne,xt=we,pt=De,ut=ye,ht=Ce;const gt=ct,jt=ot,ft=Y.forwardRef(function({className:c,...r},p){return e.jsx(dt,{className:U("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",c),...r,ref:p})}),vt=Y.forwardRef(function({className:c,...r},p){return e.jsxs(jt,{children:[e.jsx(ft,{}),e.jsx(mt,{ref:p,className:U("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",c),...r})]})}),Nt=function({className:c,...r}){return e.jsx("div",{className:U("flex flex-col space-y-2 text-center sm:text-left",c),...r})},_t=function({className:c,...r}){return e.jsx("div",{className:U("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",c),...r})},yt=Y.forwardRef(function({className:c,...r},p){return e.jsx(ut,{ref:p,className:U("text-lg font-semibold",c),...r})}),bt=Y.forwardRef(function({className:c,...r},p){return e.jsx(ht,{ref:p,className:U("text-sm text-muted-foreground",c),...r})}),Ct=Y.forwardRef(function({className:c,...r},p){return e.jsx(xt,{ref:p,className:U(me(),c),...r})}),wt=Y.forwardRef(function({className:c,...r},p){return e.jsx(pt,{ref:p,className:U(me({variant:"outline"}),"mt-2 sm:mt-0",c),...r})});function $t({isOpen:x,onClose:c,products:r=[],suppliers:p=[],errors:l={}}){const[n,f]=w.useState([{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}]),{data:b,setData:j,post:y,processing:A,reset:P,clearErrors:_}=oe({trip_date:new Date().toISOString().split("T")[0],description:"",location:"",transportation_cost:"",other_expenses:"",notes:"",items:[{product_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}]});w.useEffect(()=>{if(x){const a=[{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}];f(a),P(),_(),j(t=>({...t,trip_date:new Date().toISOString().split("T")[0],description:"",location:"",transportation_cost:"",other_expenses:"",notes:"",items:a}))}},[x,P,_]);function I(a){a.preventDefault(),j({...b,items:n}),y(route("trip-estimations.store"),{onSuccess:()=>{P(),_(),f([{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}]),c()},preserveScroll:!0,preserveState:!0,only:["trips","overview","errors","flash"]})}function R(){P(),_(),f([{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}]),c()}function K(){const a=[...n,{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}];f(a),j("items",a)}function L(a){if(n.length>1){const t=n.filter((s,g)=>g!==a);f(t),j("items",t)}}function q(a,t){const s=[...n];s[a]={...s[a],product_name:t},f(s),j("items",s)}function N(a,t,s){const g=[...n];g[a]={...g[a],[t]:s},f(g),j("items",g)}const S=n.reduce((a,t)=>{const s=parseInt(t.quantity)||0,g=parseFloat(t.unit_cost_price)||0,C=parseFloat(t.unit_selling_price)||0,D=s*g,d=s*C,v=d-D;return{totalCost:a.totalCost+D,totalSelling:a.totalSelling+d,grossProfit:a.grossProfit+v}},{totalCost:0,totalSelling:0,grossProfit:0}),E=parseFloat(b.transportation_cost)||0,J=parseFloat(b.other_expenses)||0,W=E+J,O=S.grossProfit-W;function $(a){return`${parseFloat(a||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}return e.jsx(te,{open:x,onOpenChange:c,children:e.jsxs(se,{className:"max-h-[95vh] w-[95vw] max-w-none overflow-y-auto",children:[e.jsx(ae,{children:e.jsx(le,{children:"Add Trip Estimation"})}),e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"trip_date",children:"Trip Date *"}),e.jsx(h,{id:"trip_date",type:"date",value:b.trip_date,onChange:a=>j("trip_date",a.target.value),required:!0}),l.trip_date&&e.jsx(u,{message:l.trip_date,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"description",children:"Description"}),e.jsx(h,{id:"description",placeholder:"e.g., Weekly stock purchase",value:b.description,onChange:a=>j("description",a.target.value)}),l.description&&e.jsx(u,{message:l.description,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"location",children:"Location"}),e.jsx(h,{id:"location",placeholder:"e.g., Kumasi Market",value:b.location,onChange:a=>j("location",a.target.value)}),l.location&&e.jsx(u,{message:l.location,className:"mt-1"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"text-base font-semibold",children:"Products *"}),e.jsxs(T,{type:"button",variant:"outline",size:"sm",onClick:K,className:"h-8",children:[e.jsx(ie,{className:"mr-1 h-3 w-3"}),"Add Product"]})]}),n.map((a,t)=>{const s=parseInt(a.quantity)||0,g=parseFloat(a.unit_cost_price)||0,C=parseFloat(a.unit_selling_price)||0,D=s*g,v=s*C-D;return e.jsxs("div",{className:"rounded-lg border bg-white shadow-sm",children:[e.jsxs("div",{className:"block lg:hidden p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium text-gray-700",children:["Product ",t+1]}),e.jsx(T,{type:"button",variant:"outline",size:"sm",onClick:()=>L(t),disabled:n.length===1,className:"h-8 w-8 p-0 text-red-600 disabled:text-gray-400 disabled:cursor-not-allowed",children:e.jsx(B,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Product *"}),e.jsx(h,{list:`product-list-${t}`,value:a.product_name,onChange:i=>q(t,i.target.value),placeholder:"Type or select a product",className:"mt-1"}),e.jsx("datalist",{id:`product-list-${t}`,children:r.map(i=>e.jsx("option",{value:i.name},i.id))}),l[`items.${t}.product_name`]&&e.jsx(u,{message:l[`items.${t}.product_name`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Supplier"}),e.jsx(h,{list:`supplier-list-${t}`,value:a.supplier_name,onChange:i=>N(t,"supplier_name",i.target.value),placeholder:"Type or select a supplier",className:"mt-1"}),e.jsx("datalist",{id:`supplier-list-${t}`,children:p.map(i=>e.jsx("option",{value:i.name},i.id))}),l[`items.${t}.supplier_name`]&&e.jsx(u,{message:l[`items.${t}.supplier_name`],className:"mt-1"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Quantity"}),e.jsx(h,{type:"number",placeholder:"1",value:a.quantity,onChange:i=>N(t,"quantity",i.target.value),min:"1",required:!0,className:"mt-1 w-full text-center text-lg font-medium h-12"}),l[`items.${t}.quantity`]&&e.jsx(u,{message:l[`items.${t}.quantity`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Unit Cost (GHC)"}),e.jsx(h,{type:"number",step:"0.01",placeholder:"0.00",value:a.unit_cost_price,onChange:i=>N(t,"unit_cost_price",i.target.value),min:"0",required:!0,className:"mt-1"}),l[`items.${t}.unit_cost_price`]&&e.jsx(u,{message:l[`items.${t}.unit_cost_price`],className:"mt-1"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Total Cost"}),e.jsx("div",{className:"mt-1 flex h-10 w-full rounded-md border border-input bg-gray-50 px-3 py-2 text-sm text-gray-700 items-center",children:$(D)})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Unit Selling (GHC)"}),e.jsx(h,{type:"number",step:"0.01",placeholder:"0.00",value:a.unit_selling_price,onChange:i=>N(t,"unit_selling_price",i.target.value),min:"0",required:!0,className:"mt-1"}),l[`items.${t}.unit_selling_price`]&&e.jsx(u,{message:l[`items.${t}.unit_selling_price`],className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Profit"}),e.jsxs("div",{className:`mt-1 flex h-16 w-full rounded-md border-2 py-3 text-lg font-bold items-center justify-center ${v>0?"bg-green-50 text-green-700 border-green-300":v<0?"bg-red-50 text-red-700 border-red-300":"bg-gray-50 text-gray-700 border-gray-300"}`,children:[v>0?"+":"",$(v)]})]})]})]}),e.jsxs("div",{className:"hidden xl:block xl:p-4 xl:space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Product *"}),e.jsx(h,{list:`product-list-${t}`,value:a.product_name,onChange:i=>q(t,i.target.value),placeholder:"Type or select a product",className:"w-full h-12"}),e.jsx("datalist",{id:`product-list-${t}`,children:r.map(i=>e.jsx("option",{value:i.name},i.id))}),l[`items.${t}.product_name`]&&e.jsx(u,{message:l[`items.${t}.product_name`],className:"mt-1"})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Supplier"}),e.jsx(h,{list:`supplier-list-${t}`,value:a.supplier_name,onChange:i=>N(t,"supplier_name",i.target.value),placeholder:"Type or select a supplier",className:"w-full h-12"}),e.jsx("datalist",{id:`supplier-list-${t}`,children:p.map(i=>e.jsx("option",{value:i.name},i.id))}),l[`items.${t}.supplier_name`]&&e.jsx(u,{message:l[`items.${t}.supplier_name`],className:"mt-1"})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Profit"}),e.jsxs("div",{className:`inline-flex items-center justify-center px-4 py-2 rounded-lg text-xl font-bold h-12 ${v>0?"bg-green-100 text-green-800 border-2 border-green-300":v<0?"bg-red-100 text-red-800 border-2 border-red-300":"bg-gray-100 text-gray-800 border-2 border-gray-300"}`,children:[v>0?"+":"",$(v)]})]})})]}),e.jsxs("div",{className:"grid gap-4",style:{gridTemplateColumns:"1fr 1fr 1fr 40px"},children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Quantity"}),e.jsx(h,{type:"number",placeholder:"1",value:a.quantity,onChange:i=>N(t,"quantity",i.target.value),min:"1",required:!0,className:"text-center w-full text-lg font-bold h-12"}),l[`items.${t}.quantity`]&&e.jsx(u,{message:l[`items.${t}.quantity`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Unit Cost"}),e.jsx(h,{type:"number",step:"0.01",placeholder:"0.00",value:a.unit_cost_price,onChange:i=>N(t,"unit_cost_price",i.target.value),min:"0",required:!0,className:"w-full h-12"}),e.jsxs("div",{className:"text-center text-xs text-gray-600 mt-1",children:["Total: ",$(s*g)]}),l[`items.${t}.unit_cost_price`]&&e.jsx(u,{message:l[`items.${t}.unit_cost_price`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Unit Selling"}),e.jsx(h,{type:"number",step:"0.01",placeholder:"0.00",value:a.unit_selling_price,onChange:i=>N(t,"unit_selling_price",i.target.value),min:"0",required:!0,className:"w-full h-12"}),e.jsxs("div",{className:"text-center text-xs text-gray-600 mt-1",children:["Total: ",$(s*C)]}),l[`items.${t}.unit_selling_price`]&&e.jsx(u,{message:l[`items.${t}.unit_selling_price`],className:"mt-1"})]}),e.jsx("div",{className:"flex justify-center items-end h-12",children:e.jsx(B,{className:`h-5 w-5 cursor-pointer transition-colors ${n.length===1?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-800"}`,onClick:()=>n.length>1&&L(t)})})]})]}),e.jsxs("div",{className:"hidden lg:block xl:hidden lg:p-3 lg:space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Product *"}),e.jsx(h,{list:`product-list-${t}`,value:a.product_name,onChange:i=>q(t,i.target.value),placeholder:"Type or select a product",className:"w-full h-10"}),e.jsx("datalist",{id:`product-list-${t}`,children:r.map(i=>e.jsx("option",{value:i.name},i.id))}),l[`items.${t}.product_name`]&&e.jsx(u,{message:l[`items.${t}.product_name`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Supplier"}),e.jsx(h,{list:`supplier-list-${t}`,value:a.supplier_name,onChange:i=>N(t,"supplier_name",i.target.value),placeholder:"Type or select a supplier",className:"w-full h-10"}),e.jsx("datalist",{id:`supplier-list-${t}`,children:p.map(i=>e.jsx("option",{value:i.name},i.id))}),l[`items.${t}.supplier_name`]&&e.jsx(u,{message:l[`items.${t}.supplier_name`],className:"mt-1"})]}),e.jsx("div",{children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Profit"}),e.jsxs("div",{className:`inline-flex items-center justify-center px-3 py-2 rounded-lg text-base font-bold h-10 w-full ${v>0?"bg-green-100 text-green-800 border-2 border-green-300":v<0?"bg-red-100 text-red-800 border-2 border-red-300":"bg-gray-100 text-gray-800 border-2 border-gray-300"}`,children:[v>0?"+":"",$(v)]})]})})]}),e.jsxs("div",{className:"grid gap-3",style:{gridTemplateColumns:"1fr 1fr 1fr 32px"},children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Quantity"}),e.jsx(h,{type:"number",placeholder:"1",value:a.quantity,onChange:i=>N(t,"quantity",i.target.value),min:"1",required:!0,className:"text-center w-full text-base font-medium h-10"}),l[`items.${t}.quantity`]&&e.jsx(u,{message:l[`items.${t}.quantity`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Unit Cost"}),e.jsx(h,{type:"number",step:"0.01",placeholder:"0.00",value:a.unit_cost_price,onChange:i=>N(t,"unit_cost_price",i.target.value),min:"0",required:!0,className:"w-full h-10"}),e.jsx("div",{className:"text-center text-xs text-gray-600 mt-1",children:$(s*g)}),l[`items.${t}.unit_cost_price`]&&e.jsx(u,{message:l[`items.${t}.unit_cost_price`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Unit Selling"}),e.jsx(h,{type:"number",step:"0.01",placeholder:"0.00",value:a.unit_selling_price,onChange:i=>N(t,"unit_selling_price",i.target.value),min:"0",required:!0,className:"w-full h-10"}),e.jsx("div",{className:"text-center text-xs text-gray-600 mt-1",children:$(s*C)}),l[`items.${t}.unit_selling_price`]&&e.jsx(u,{message:l[`items.${t}.unit_selling_price`],className:"mt-1"})]}),e.jsx("div",{className:"flex justify-center items-end h-10",children:e.jsx(B,{className:`h-4 w-4 cursor-pointer transition-colors ${n.length===1?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-800"}`,onClick:()=>n.length>1&&L(t)})})]})]})]},t)})]}),e.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[e.jsx(o,{className:"text-base font-semibold",children:"Trip Expenses"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"transportation_cost",children:"Transportation Cost (GHC)"}),e.jsx(h,{id:"transportation_cost",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:b.transportation_cost,onChange:a=>j("transportation_cost",a.target.value)}),l.transportation_cost&&e.jsx(u,{message:l.transportation_cost,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"other_expenses",children:"Other Expenses (GHC)"}),e.jsx(h,{id:"other_expenses",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:b.other_expenses,onChange:a=>j("other_expenses",a.target.value)}),l.other_expenses&&e.jsx(u,{message:l.other_expenses,className:"mt-1"})]})]})]}),e.jsxs("div",{className:"space-y-4 rounded-lg bg-blue-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5 text-blue-600"}),e.jsx(o,{className:"text-base font-semibold text-blue-900",children:"Trip Summary"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Cost"}),e.jsx("div",{className:"text-lg font-semibold text-red-600",children:$(S.totalCost)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Selling"}),e.jsx("div",{className:"text-lg font-semibold text-green-600",children:$(S.totalSelling)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Gross Profit"}),e.jsx("div",{className:`text-lg font-semibold ${S.grossProfit>0?"text-green-600":S.grossProfit<0?"text-red-600":"text-gray-600"}`,children:$(S.grossProfit)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Expenses"}),e.jsx("div",{className:"text-lg font-semibold text-orange-600",children:$(W)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Net Profit"}),e.jsx("div",{className:`text-lg font-semibold ${O>0?"text-green-600":O<0?"text-red-600":"text-gray-600"}`,children:$(O)})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"notes",children:"Notes"}),e.jsx(ue,{id:"notes",placeholder:"Additional notes about this trip",value:b.notes,onChange:a=>j("notes",a.target.value),rows:2}),l.notes&&e.jsx(u,{message:l.notes,className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(T,{type:"button",variant:"outline",onClick:R,children:"Cancel"}),e.jsx(T,{type:"submit",disabled:A,children:A?"Creating...":"Create Trip Estimation"})]})]})]})})}function Dt({isOpen:x,onClose:c,trip:r,products:p=[],suppliers:l=[],errors:n={}}){const[f,b]=w.useState([]),{data:j,setData:y,put:A,processing:P,reset:_,clearErrors:I}=oe({trip_date:"",description:"",location:"",transportation_cost:"",other_expenses:"",notes:"",items:[]});w.useEffect(()=>{if(r&&x){const s=new Date(r.trip_date).toISOString().split("T")[0],g=r.items||[{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}];b(g),y({trip_date:s,description:r.description||"",location:r.location||"",transportation_cost:r.transportation_cost||"",other_expenses:r.other_expenses||"",notes:r.notes||"",items:g}),I()}},[r,x,I]);function R(t){t.preventDefault(),r&&(y({...j,items:f}),A(route("trip-estimations.update",r.id),{onSuccess:()=>{_(),I(),c()},preserveScroll:!0,preserveState:!0,only:["trips","overview","errors","flash"]}))}function K(){_(),I(),b([]),c()}function L(){const t=[...f,{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}];b(t),y("items",t)}function q(t){if(f.length>1){const s=f.filter((g,C)=>C!==t);b(s),y("items",s)}}function N(t,s,g){const C=[...f];C[t]={...C[t],[s]:g},b(C),y("items",C)}function S(t,s){const g=[...f];g[t]={...g[t],product_name:s},b(g),y("items",g)}if(!r)return null;const E=f.reduce((t,s)=>{const g=parseInt(s.quantity)||0,C=parseFloat(s.unit_cost_price)||0,D=parseFloat(s.unit_selling_price)||0,d=g*C,v=g*D,i=v-d;return{totalCost:t.totalCost+d,totalSelling:t.totalSelling+v,grossProfit:t.grossProfit+i}},{totalCost:0,totalSelling:0,grossProfit:0}),J=parseFloat(j.transportation_cost)||0,W=parseFloat(j.other_expenses)||0,O=J+W,$=E.grossProfit-O;function a(t){return`${parseFloat(t||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}return e.jsx(te,{open:x,onOpenChange:c,children:e.jsxs(se,{className:"max-h-[95vh] w-[95vw] max-w-none overflow-y-auto",children:[e.jsx(ae,{children:e.jsx(le,{children:"Edit Trip Estimation"})}),e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"trip_date",children:"Trip Date *"}),e.jsx(h,{id:"trip_date",type:"date",value:j.trip_date,onChange:t=>y("trip_date",t.target.value),required:!0}),n.trip_date&&e.jsx(u,{message:n.trip_date,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"description",children:"Description"}),e.jsx(h,{id:"description",placeholder:"e.g., Weekly stock purchase",value:j.description,onChange:t=>y("description",t.target.value)}),n.description&&e.jsx(u,{message:n.description,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"location",children:"Location"}),e.jsx(h,{id:"location",placeholder:"e.g., Kumasi Market",value:j.location,onChange:t=>y("location",t.target.value)}),n.location&&e.jsx(u,{message:n.location,className:"mt-1"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"text-base font-semibold",children:"Products *"}),e.jsxs(T,{type:"button",variant:"outline",size:"sm",onClick:L,className:"h-8",children:[e.jsx(ie,{className:"mr-1 h-3 w-3"}),"Add Product"]})]}),f.map((t,s)=>{const g=parseInt(t.quantity)||0,C=parseFloat(t.unit_cost_price)||0,D=parseFloat(t.unit_selling_price)||0,d=g*C,i=g*D-d;return e.jsxs("div",{className:"rounded-lg border bg-white shadow-sm",children:[e.jsxs("div",{className:"block lg:hidden p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium text-gray-700",children:["Product ",s+1]}),e.jsx(T,{type:"button",variant:"outline",size:"sm",onClick:()=>q(s),disabled:f.length===1,className:"h-8 w-8 p-0 text-red-600 disabled:text-gray-400 disabled:cursor-not-allowed",children:e.jsx(B,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Product *"}),e.jsx(h,{list:`product-list-${s}`,value:t.product_name,onChange:m=>S(s,m.target.value),placeholder:"Type or select a product",className:"mt-1"}),e.jsx("datalist",{id:`product-list-${s}`,children:p.map(m=>e.jsx("option",{value:m.name},m.id))}),n[`items.${s}.product_name`]&&e.jsx(u,{message:n[`items.${s}.product_name`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Supplier"}),e.jsx(h,{list:`supplier-list-${s}`,value:t.supplier_name,onChange:m=>N(s,"supplier_name",m.target.value),placeholder:"Type or select a supplier",className:"mt-1"}),e.jsx("datalist",{id:`supplier-list-${s}`,children:l.map(m=>e.jsx("option",{value:m.name},m.id))}),n[`items.${s}.supplier_name`]&&e.jsx(u,{message:n[`items.${s}.supplier_name`],className:"mt-1"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Quantity"}),e.jsx(h,{type:"number",placeholder:"1",value:t.quantity,onChange:m=>N(s,"quantity",m.target.value),min:"1",required:!0,className:"mt-1 w-full text-center text-lg font-medium h-12"}),n[`items.${s}.quantity`]&&e.jsx(u,{message:n[`items.${s}.quantity`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Unit Cost (GHC)"}),e.jsx(h,{type:"number",step:"0.01",placeholder:"0.00",value:t.unit_cost_price,onChange:m=>N(s,"unit_cost_price",m.target.value),min:"0",required:!0,className:"mt-1"}),n[`items.${s}.unit_cost_price`]&&e.jsx(u,{message:n[`items.${s}.unit_cost_price`],className:"mt-1"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Total Cost"}),e.jsx("div",{className:"mt-1 flex h-10 w-full rounded-md border border-input bg-gray-50 px-3 py-2 text-sm text-gray-700 items-center",children:a(d)})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Unit Selling (GHC)"}),e.jsx(h,{type:"number",step:"0.01",placeholder:"0.00",value:t.unit_selling_price,onChange:m=>N(s,"unit_selling_price",m.target.value),min:"0",required:!0,className:"mt-1"}),n[`items.${s}.unit_selling_price`]&&e.jsx(u,{message:n[`items.${s}.unit_selling_price`],className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium",children:"Profit"}),e.jsxs("div",{className:`mt-1 flex h-16 w-full rounded-md border-2 px-4 py-3 text-lg font-bold items-center justify-center ${i>0?"bg-green-50 text-green-700 border-green-300":i<0?"bg-red-50 text-red-700 border-red-300":"bg-gray-50 text-gray-700 border-gray-300"}`,children:[i>0?"+":"",a(i)]})]})]})]}),e.jsxs("div",{className:"hidden xl:block xl:p-4 xl:space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Product *"}),e.jsx(h,{list:`product-list-${s}`,value:t.product_name,onChange:m=>S(s,m.target.value),placeholder:"Type or select a product",className:"w-full h-12"}),e.jsx("datalist",{id:`product-list-${s}`,children:p.map(m=>e.jsx("option",{value:m.name},m.id))}),n[`items.${s}.product_name`]&&e.jsx(u,{message:n[`items.${s}.product_name`],className:"mt-1"})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Supplier"}),e.jsx(h,{list:`supplier-list-${s}`,value:t.supplier_name,onChange:m=>N(s,"supplier_name",m.target.value),placeholder:"Type or select a supplier",className:"w-full h-12"}),e.jsx("datalist",{id:`supplier-list-${s}`,children:l.map(m=>e.jsx("option",{value:m.name},m.id))}),n[`items.${s}.supplier_name`]&&e.jsx(u,{message:n[`items.${s}.supplier_name`],className:"mt-1"})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Profit"}),e.jsxs("div",{className:`inline-flex items-center justify-center px-4 py-2 rounded-lg text-xl font-bold h-12 ${i>0?"bg-green-100 text-green-800 border-2 border-green-300":i<0?"bg-red-100 text-red-800 border-2 border-red-300":"bg-gray-100 text-gray-800 border-2 border-gray-300"}`,children:[i>0?"+":"",a(i)]})]})})]}),e.jsxs("div",{className:"grid gap-4",style:{gridTemplateColumns:"1fr 1fr 1fr 40px"},children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Quantity"}),e.jsx(h,{type:"number",placeholder:"1",value:t.quantity,onChange:m=>N(s,"quantity",m.target.value),min:"1",required:!0,className:"text-center w-full text-lg font-bold h-12"}),n[`items.${s}.quantity`]&&e.jsx(u,{message:n[`items.${s}.quantity`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Unit Cost"}),e.jsx(h,{type:"number",step:"0.01",placeholder:"0.00",value:t.unit_cost_price,onChange:m=>N(s,"unit_cost_price",m.target.value),min:"0",required:!0,className:"w-full h-12"}),e.jsxs("div",{className:"text-center text-xs text-gray-600 mt-1",children:["Total: ",a(g*C)]}),n[`items.${s}.unit_cost_price`]&&e.jsx(u,{message:n[`items.${s}.unit_cost_price`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Unit Selling"}),e.jsx(h,{type:"number",step:"0.01",placeholder:"0.00",value:t.unit_selling_price,onChange:m=>N(s,"unit_selling_price",m.target.value),min:"0",required:!0,className:"w-full h-12"}),e.jsxs("div",{className:"text-center text-xs text-gray-600 mt-1",children:["Total: ",a(g*D)]}),n[`items.${s}.unit_selling_price`]&&e.jsx(u,{message:n[`items.${s}.unit_selling_price`],className:"mt-1"})]}),e.jsx("div",{className:"flex justify-center items-end h-12",children:e.jsx(B,{className:`h-5 w-5 cursor-pointer transition-colors ${f.length===1?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-800"}`,onClick:()=>f.length>1&&q(s)})})]})]}),e.jsxs("div",{className:"hidden lg:block xl:hidden lg:p-3 lg:space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Product *"}),e.jsx(h,{list:`product-list-${s}`,value:t.product_name,onChange:m=>S(s,m.target.value),placeholder:"Type or select a product",className:"w-full h-10"}),e.jsx("datalist",{id:`product-list-${s}`,children:p.map(m=>e.jsx("option",{value:m.name},m.id))}),n[`items.${s}.product_name`]&&e.jsx(u,{message:n[`items.${s}.product_name`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Supplier"}),e.jsx(h,{list:`supplier-list-${s}`,value:t.supplier_name,onChange:m=>N(s,"supplier_name",m.target.value),placeholder:"Type or select a supplier",className:"w-full h-10"}),e.jsx("datalist",{id:`supplier-list-${s}`,children:l.map(m=>e.jsx("option",{value:m.name},m.id))}),n[`items.${s}.supplier_name`]&&e.jsx(u,{message:n[`items.${s}.supplier_name`],className:"mt-1"})]}),e.jsx("div",{children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Profit"}),e.jsxs("div",{className:`inline-flex items-center justify-center px-3 py-2 rounded-lg text-base font-bold h-10 w-full ${i>0?"bg-green-100 text-green-800 border-2 border-green-300":i<0?"bg-red-100 text-red-800 border-2 border-red-300":"bg-gray-100 text-gray-800 border-2 border-gray-300"}`,children:[i>0?"+":"",a(i)]})]})})]}),e.jsxs("div",{className:"grid gap-3",style:{gridTemplateColumns:"1fr 1fr 1fr 32px"},children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Quantity"}),e.jsx(h,{type:"number",placeholder:"1",value:t.quantity,onChange:m=>N(s,"quantity",m.target.value),min:"1",required:!0,className:"text-center w-full text-base font-medium h-10"}),n[`items.${s}.quantity`]&&e.jsx(u,{message:n[`items.${s}.quantity`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Unit Cost"}),e.jsx(h,{type:"number",step:"0.01",placeholder:"0.00",value:t.unit_cost_price,onChange:m=>N(s,"unit_cost_price",m.target.value),min:"0",required:!0,className:"w-full h-10"}),e.jsx("div",{className:"text-center text-xs text-gray-600 mt-1",children:a(g*C)}),n[`items.${s}.unit_cost_price`]&&e.jsx(u,{message:n[`items.${s}.unit_cost_price`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-sm font-medium mb-2 block",children:"Unit Selling"}),e.jsx(h,{type:"number",step:"0.01",placeholder:"0.00",value:t.unit_selling_price,onChange:m=>N(s,"unit_selling_price",m.target.value),min:"0",required:!0,className:"w-full h-10"}),e.jsx("div",{className:"text-center text-xs text-gray-600 mt-1",children:a(g*D)}),n[`items.${s}.unit_selling_price`]&&e.jsx(u,{message:n[`items.${s}.unit_selling_price`],className:"mt-1"})]}),e.jsx("div",{className:"flex justify-center items-end h-10",children:e.jsx(B,{className:`h-4 w-4 cursor-pointer transition-colors ${f.length===1?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-800"}`,onClick:()=>f.length>1&&q(s)})})]})]})]},s)})]}),e.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[e.jsx(o,{className:"text-base font-semibold",children:"Trip Expenses"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"transportation_cost",children:"Transportation Cost (GHC)"}),e.jsx(h,{id:"transportation_cost",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:j.transportation_cost,onChange:t=>y("transportation_cost",t.target.value)}),n.transportation_cost&&e.jsx(u,{message:n.transportation_cost,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"other_expenses",children:"Other Expenses (GHC)"}),e.jsx(h,{id:"other_expenses",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:j.other_expenses,onChange:t=>y("other_expenses",t.target.value)}),n.other_expenses&&e.jsx(u,{message:n.other_expenses,className:"mt-1"})]})]})]}),e.jsxs("div",{className:"space-y-4 rounded-lg bg-blue-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5 text-blue-600"}),e.jsx(o,{className:"text-base font-semibold text-blue-900",children:"Trip Summary"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Cost"}),e.jsx("div",{className:"text-lg font-semibold text-red-600",children:a(E.totalCost)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Selling"}),e.jsx("div",{className:"text-lg font-semibold text-green-600",children:a(E.totalSelling)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Gross Profit"}),e.jsx("div",{className:`text-lg font-semibold ${E.grossProfit>0?"text-green-600":E.grossProfit<0?"text-red-600":"text-gray-600"}`,children:a(E.grossProfit)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Expenses"}),e.jsx("div",{className:"text-lg font-semibold text-orange-600",children:a(O)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Net Profit"}),e.jsx("div",{className:`text-lg font-semibold ${$>0?"text-green-600":$<0?"text-red-600":"text-gray-600"}`,children:a($)})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"notes",children:"Notes"}),e.jsx(ue,{id:"notes",placeholder:"Additional notes about this trip",value:j.notes,onChange:t=>y("notes",t.target.value),rows:2}),n.notes&&e.jsx(u,{message:n.notes,className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(T,{type:"button",variant:"outline",onClick:K,children:"Cancel"}),e.jsx(T,{type:"submit",disabled:P,children:P?"Updating...":"Update Trip Estimation"})]})]})]})})}function Bt({trips:x=[],overview:c={},start_date:r="",end_date:p="",products:l=[],suppliers:n=[]}){var s,g,C,D;const[f,b]=w.useState(!1),[j,y]=w.useState(null),[A,P]=w.useState(null),[_,I]=w.useState(null),R=new Date,K=new Date(R.getFullYear(),R.getMonth(),1).toISOString().slice(0,10),L=new Date(R.getFullYear(),R.getMonth()+1,0).toISOString().slice(0,10),[q,N]=w.useState(r||K),[S,E]=w.useState(p||L),J=(d,v)=>{const i=v==="start"?d:q,m=v==="end"?d:S;v==="start"&&N(d),v==="end"&&E(d),re.get(route("trip-estimations.index"),{start_date:i,end_date:m,page:1},{preserveState:!0,preserveScroll:!0,replace:!0})};function W(d){y(d)}function O(){A&&re.delete(route("trip-estimations.destroy",A.id),{preserveScroll:!0,preserveState:!0,only:["trips","overview","errors","flash"],onSuccess:()=>P(null)})}function $(d){I(d)}function a(d){return`GHC ${parseFloat(d||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function t(d){const v=parseFloat(d||0);return v>0?"text-green-600":v<0?"text-red-600":"text-gray-600"}return e.jsx(Se,{breadcrumbs:[{title:"Trip Profit Estimator",href:"/trip-estimations"}],children:e.jsxs("div",{className:"min-h-screen space-y-6 bg-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Trip Profit Estimator"}),e.jsxs(T,{onClick:()=>b(!0),className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Add Trip"]})]}),e.jsx(Ae,{startDate:q,endDate:S,onChange:J}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(G,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"Total Trips"}),e.jsx(Te,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Q,{children:e.jsx("div",{className:"text-2xl font-bold",children:c.total_trips||0})})]}),e.jsxs(G,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"Total Selling Price"}),e.jsx(Z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Q,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a(c.total_selling_price)})})]}),e.jsxs(G,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"Total Cost Price"}),e.jsx(Z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Q,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:a(c.total_cost_price)})})]}),e.jsxs(G,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"Gross Profit"}),e.jsx(ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Q,{children:e.jsx("div",{className:`text-2xl font-bold ${t(c.total_gross_profit)}`,children:a(c.total_gross_profit)})})]}),e.jsxs(G,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"Total Expenses"}),e.jsx(Z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Q,{children:e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:a(c.total_expenses)})})]}),e.jsxs(G,{children:[e.jsxs(H,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(z,{className:"text-sm font-medium",children:"Net Profit"}),e.jsx(ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Q,{children:e.jsx("div",{className:`text-2xl font-bold ${t(c.total_net_profit)}`,children:a(c.total_net_profit)})})]})]}),e.jsxs(G,{children:[e.jsx(H,{children:e.jsx(z,{children:"Trip Estimations"})}),e.jsxs(Q,{children:[e.jsxs(qe,{children:[e.jsx(Ee,{children:e.jsxs(X,{children:[e.jsx(F,{children:"Date"}),e.jsx(F,{children:"Description"}),e.jsx(F,{children:"Location"}),e.jsx(F,{children:"Items"}),e.jsx(F,{className:"text-right",children:"Cost Price"}),e.jsx(F,{className:"text-right",children:"Selling Price"}),e.jsx(F,{className:"text-right",children:"Gross Profit"}),e.jsx(F,{className:"text-right",children:"Expenses"}),e.jsx(F,{className:"text-right",children:"Net Profit"}),e.jsx(F,{className:"text-center",children:"Actions"})]})}),e.jsx(Fe,{children:((s=x.data)==null?void 0:s.length)>0?x.data.map(d=>e.jsxs(X,{children:[e.jsx(k,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4 text-gray-400"}),d.trip_date]})}),e.jsx(k,{children:d.description||"-"}),e.jsx(k,{children:d.location||"-"}),e.jsx(k,{children:e.jsxs(ke,{variant:"secondary",children:[d.items_count," items"]})}),e.jsx(k,{className:"text-right font-mono",children:a(d.total_cost_price)}),e.jsx(k,{className:"text-right font-mono",children:a(d.total_selling_price)}),e.jsx(k,{className:`text-right font-mono ${t(d.gross_profit)}`,children:a(d.gross_profit)}),e.jsx(k,{className:"text-right font-mono",children:a(d.total_expenses)}),e.jsx(k,{className:`text-right font-mono ${t(d.net_profit)}`,children:a(d.net_profit)}),e.jsx(k,{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(T,{variant:"outline",size:"sm",onClick:()=>$(d),children:e.jsx(Ye,{className:"h-3 w-3"})}),e.jsx(T,{variant:"outline",size:"sm",onClick:()=>W(d),children:e.jsx(Je,{className:"h-3 w-3"})}),e.jsx(T,{variant:"outline",size:"sm",onClick:()=>P(d),className:"text-red-600 hover:text-red-700",children:e.jsx(B,{className:"h-3 w-3"})})]})})]},d.id)):e.jsx(X,{children:e.jsxs(k,{colSpan:10,className:"text-center py-8 text-gray-500",children:["No trip estimations found for the selected period.",e.jsx("br",{}),e.jsx(T,{variant:"link",onClick:()=>b(!0),className:"mt-2",children:"Add your first trip estimation"})]})})})]}),((g=x.data)==null?void 0:g.length)===0?e.jsx("div",{className:"text-muted-foreground py-8 text-center",children:"No trip estimations found for the selected period."}):e.jsxs("div",{className:"my-3 flex items-center justify-center gap-4",children:[x.prev_page_url&&e.jsx(ne,{preserveScroll:!0,preserveState:!0,href:x.prev_page_url,className:"rounded border px-4 py-2 hover:bg-gray-100",children:"« Previous"}),e.jsxs("span",{className:"px-4 py-2 font-medium",children:["Page ",x.current_page]}),x.next_page_url&&e.jsx(ne,{preserveScroll:!0,preserveState:!0,href:x.next_page_url,className:"rounded border px-4 py-2 hover:bg-gray-100",children:"Next »"})]})]})]}),e.jsx($t,{isOpen:f,onClose:()=>b(!1),products:l,suppliers:n}),j&&e.jsx(Dt,{isOpen:!!j,onClose:()=>y(null),trip:j,products:l,suppliers:n}),_&&e.jsx(te,{open:!!_,onOpenChange:()=>I(null),children:e.jsxs(se,{className:"max-h-[90vh] max-w-3xl overflow-y-auto",children:[e.jsx(ae,{children:e.jsx(le,{children:"Trip Details"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Trip Date"}),e.jsx("div",{className:"font-medium",children:_.trip_date})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Location"}),e.jsx("div",{className:"font-medium",children:_.location||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Description"}),e.jsx("div",{className:"font-medium",children:_.description||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Notes"}),e.jsx("div",{className:"font-medium whitespace-pre-wrap",children:_.notes||"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Cost"}),e.jsx("div",{className:"font-mono",children:a(_.total_cost_price)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Selling"}),e.jsx("div",{className:"font-mono",children:a(_.total_selling_price)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Gross Profit"}),e.jsx("div",{className:`font-mono ${t(_.gross_profit)}`,children:a(_.gross_profit)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Expenses"}),e.jsx("div",{className:"font-mono",children:a(_.total_expenses)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Net Profit"}),e.jsx("div",{className:`font-mono ${t(_.net_profit)}`,children:a(_.net_profit)})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-blue-900 mb-2",children:["Items (",((C=_.items)==null?void 0:C.length)||0,")"]}),e.jsx("div",{className:"space-y-2",children:(D=_.items)!=null&&D.length?_.items.map((d,v)=>e.jsxs("div",{className:"flex flex-wrap gap-4 p-3 bg-gray-50 rounded border",children:[e.jsxs("div",{className:"min-w-[120px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Product"}),e.jsx("div",{className:"font-medium",children:d.product_name})]}),e.jsxs("div",{className:"min-w-[120px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Supplier"}),e.jsx("div",{className:"font-medium",children:d.supplier_name||"-"})]}),e.jsxs("div",{className:"min-w-[60px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Qty"}),e.jsx("div",{className:"font-mono",children:d.quantity})]}),e.jsxs("div",{className:"min-w-[100px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Unit Prices"}),e.jsxs("div",{className:"font-mono text-xs",children:["Cost: ",Number(d.unit_cost_price).toLocaleString("en-US",{minimumFractionDigits:2}),e.jsx("br",{}),"Sell: ",Number(d.unit_selling_price).toLocaleString("en-US",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"min-w-[100px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Total Cost"}),e.jsx("div",{className:"font-mono text-xs",children:Number(d.unit_cost_price*d.quantity).toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{className:"min-w-[100px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Total Selling"}),e.jsx("div",{className:"font-mono text-xs",children:Number(d.unit_selling_price*d.quantity).toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{className:"min-w-[100px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Profit (GHC)"}),e.jsx("div",{className:"font-mono text-green-600 font-bold",children:Number((parseFloat(d.unit_selling_price||0)-parseFloat(d.unit_cost_price||0))*parseFloat(d.quantity||0)).toLocaleString("en-US",{minimumFractionDigits:2})})]})]},v)):e.jsx("div",{className:"text-gray-500 text-sm",children:"No items found."})})]})]})]})}),e.jsx(gt,{open:!!A,onOpenChange:()=>P(null),children:e.jsxs(vt,{children:[e.jsxs(Nt,{children:[e.jsx(yt,{children:"Delete Trip Estimation"}),e.jsx(bt,{children:"Are you sure you want to delete this trip estimation? This action cannot be undone."})]}),e.jsxs(_t,{children:[e.jsx(wt,{children:"Cancel"}),e.jsx(Ct,{onClick:O,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]})})}export{Bt as default};
