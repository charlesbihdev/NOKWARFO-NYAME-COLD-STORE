import{b as Fe,r as d,u as T,j as e,H as Ee,L as P,a as z}from"./app-CJAfpu_B.js";import{B as A}from"./badge-CV-W2Fb_.js";import{c as ne,F as t}from"./createLucideIcon-Cg7ANiR-.js";import{C as u,a as b,b as N,c as p,d as ke}from"./card-CqjrLppC.js";import{D as F,a as ee,b as E,c as k,d as q,e as B,f as H}from"./dialog-CAA-wllh.js";import{I as l}from"./input-Dk-R2vtg.js";import{L as a}from"./label-Bg7Q41yp.js";import{T as qe,a as Be,b as se,c as j,d as He,e as g}from"./table-GVnBoJML.js";import{T as v}from"./textarea-B8GjicWn.js";import{D as Oe}from"./DateRangePicker-Cup-kuQ_.js";import{A as Re}from"./app-layout-BYjCDRLU.js";import{A as Ue}from"./arrow-left-CRWzbXQq.js";import{S as te}from"./square-pen-BFRhAgDe.js";import{C as Le}from"./calendar-C-hPx68D.js";import{T as $e}from"./trash-2-DWws5xuW.js";import"./index-Ca9tWU42.js";import"./index-Dqg2lGr_.js";import"./index-CzC18CvF.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],ae=ne("CircleArrowDown",Ie);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],re=ne("CircleArrowUp",Pe);function ls(){const{saving:r,transactions:n,summary:i,filters:G}=Fe().props,[ie,O]=d.useState(!1),[de,R]=d.useState(!1),[le,y]=d.useState(!1),[ce,M]=d.useState(null),[oe,f]=d.useState(!1),[U,V]=d.useState(G.start_date||""),[L,W]=d.useState(G.end_date||""),{data:$,setData:I,post:xe,processing:Z,errors:D,reset:me}=T({type:"credit",amount:"",transaction_date:new Date().toISOString().split("T")[0],notes:""}),{data:C,setData:w,post:he,processing:J,errors:c,reset:ue}=T({type:"debit",amount:"",transaction_date:new Date().toISOString().split("T")[0],reason:"",notes:""}),{data:o,setData:x,put:pe,processing:K,errors:m,reset:je}=T({type:"",amount:"",transaction_date:"",reason:"",notes:""}),{data:Q,setData:X,put:ge,processing:Y,errors:S,reset:ze}=T({name:r.name,description:r.description||""}),ve=[{title:"Savings",href:"/savings"},{title:r.name,href:`/savings/${r.id}`}],h=s=>new Intl.NumberFormat("en-GH",{style:"currency",currency:"GHS"}).format(s),be=s=>{switch(s){case"positive":return e.jsx(A,{className:"bg-green-100 text-green-800 hover:bg-green-100",children:"Positive"});case"negative":return e.jsx(A,{className:"bg-red-100 text-red-800 hover:bg-red-100",children:"Negative"});default:return e.jsx(A,{className:"bg-gray-100 text-gray-800 hover:bg-gray-100",children:"Zero"})}},Ne=(s,_)=>{const Te=_==="start"?s:U,Ae=_==="end"?s:L;_==="start"&&V(s),_==="end"&&W(s),z.get(route("savings.show",r.id),{start_date:Te||void 0,end_date:Ae||void 0},{preserveState:!0,preserveScroll:!0,replace:!0})},ye=s=>{s.preventDefault(),xe(route("savings.transactions.store",r.id),{onSuccess:()=>{O(!1),me()}})},fe=s=>{s.preventDefault(),he(route("savings.transactions.store",r.id),{onSuccess:()=>{R(!1),ue()}})},De=s=>{M(s),x({type:s.type,amount:s.amount,transaction_date:s.transaction_date,reason:s.reason||"",notes:s.notes||""}),y(!0)},Ce=s=>{s.preventDefault(),pe(route("savings.transactions.update",ce.id),{onSuccess:()=>{y(!1),je(),M(null)}})},we=s=>{confirm("Are you sure you want to delete this transaction? This will affect all subsequent balance calculations.")&&z.delete(route("savings.transactions.destroy",s.id),{preserveScroll:!0})},Se=s=>{s.preventDefault(),ge(route("savings.update",r.id),{onSuccess:()=>{f(!1)}})},_e=()=>{V(""),W(""),z.get(route("savings.show",r.id),{},{preserveState:!0,preserveScroll:!0,replace:!0})};return e.jsxs(Re,{breadcrumbs:ve,children:[e.jsx(Ee,{title:`${r.name} - Savings`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(P,{href:route("savings.index"),className:"mb-4 inline-flex items-center text-sm text-gray-600 hover:text-gray-900",children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"}),"Back to Savings"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:r.name}),r.description&&e.jsx("p",{className:"mt-1 text-gray-600",children:r.description})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(F,{open:ie,onOpenChange:O,children:[e.jsx(ee,{asChild:!0,children:e.jsxs(t,{className:"bg-green-600 hover:bg-green-700",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Credit"]})}),e.jsxs(E,{className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(q,{children:"Add Credit"}),e.jsx(B,{children:"Add funds to this savings account."})]}),e.jsxs("form",{onSubmit:ye,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{htmlFor:"credit-amount",children:["Amount ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{id:"credit-amount",type:"number",step:"0.01",min:"0.01",value:$.amount,onChange:s=>I("amount",s.target.value),placeholder:"0.00",required:!0}),D.amount&&e.jsx("p",{className:"text-sm text-red-500",children:D.amount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{htmlFor:"credit-date",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{id:"credit-date",type:"date",value:$.transaction_date,onChange:s=>I("transaction_date",s.target.value),required:!0}),D.transaction_date&&e.jsx("p",{className:"text-sm text-red-500",children:D.transaction_date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"credit-notes",children:"Notes"}),e.jsx(v,{id:"credit-notes",value:$.notes,onChange:s=>I("notes",s.target.value),placeholder:"Optional notes...",rows:3})]})]}),e.jsxs(H,{className:"mt-6",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>O(!1),children:"Cancel"}),e.jsx(t,{type:"submit",disabled:Z,className:"bg-green-600 hover:bg-green-700",children:Z?"Adding...":"Add Credit"})]})]})]})]}),e.jsxs(F,{open:de,onOpenChange:R,children:[e.jsx(ee,{asChild:!0,children:e.jsxs(t,{className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Debit"]})}),e.jsxs(E,{className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(q,{children:"Add Debit"}),e.jsx(B,{children:"Withdraw funds from this savings account."})]}),e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Current Balance:"}),e.jsx("span",{className:`text-lg font-bold ${i.balance>=0?"text-green-600":"text-red-600"}`,children:h(i.balance)})]})}),e.jsxs("form",{onSubmit:fe,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{htmlFor:"debit-amount",children:["Amount ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{id:"debit-amount",type:"number",step:"0.01",min:"0.01",value:C.amount,onChange:s=>w("amount",s.target.value),placeholder:"0.00",required:!0}),c.amount&&e.jsx("p",{className:"text-sm text-red-500",children:c.amount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{htmlFor:"debit-date",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{id:"debit-date",type:"date",value:C.transaction_date,onChange:s=>w("transaction_date",s.target.value),required:!0}),c.transaction_date&&e.jsx("p",{className:"text-sm text-red-500",children:c.transaction_date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{htmlFor:"debit-reason",children:["Reason ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(v,{id:"debit-reason",value:C.reason,onChange:s=>w("reason",s.target.value),placeholder:"Reason for withdrawal...",rows:2,required:!0}),c.reason&&e.jsx("p",{className:"text-sm text-red-500",children:c.reason})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"debit-notes",children:"Notes"}),e.jsx(v,{id:"debit-notes",value:C.notes,onChange:s=>w("notes",s.target.value),placeholder:"Optional notes...",rows:2})]})]}),e.jsxs(H,{className:"mt-6",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>R(!1),children:"Cancel"}),e.jsx(t,{type:"submit",disabled:J,className:"bg-red-600 hover:bg-red-700 text-white",children:J?"Adding...":"Add Debit"})]})]})]})]}),e.jsxs(t,{variant:"outline",onClick:()=>f(!0),children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Edit"]})]})]})]}),e.jsxs("div",{className:"mb-8 grid grid-cols-1 gap-6 md:grid-cols-4",children:[e.jsxs(u,{children:[e.jsx(b,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-gray-600",children:"Total Credits"})}),e.jsx(p,{children:e.jsx("div",{className:"text-lg font-bold text-green-600",children:h(i.total_credits)})})]}),e.jsxs(u,{children:[e.jsx(b,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-gray-600",children:"Total Debits"})}),e.jsx(p,{children:e.jsx("div",{className:"text-lg font-bold text-red-600",children:h(i.total_debits)})})]}),e.jsxs(u,{children:[e.jsx(b,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-gray-600",children:"Balance"})}),e.jsx(p,{children:e.jsx("div",{className:`text-lg font-bold ${i.balance>=0?"text-green-600":"text-red-600"}`,children:h(i.balance)})})]}),e.jsxs(u,{children:[e.jsx(b,{className:"pb-2",children:e.jsx(N,{className:"text-sm font-medium text-gray-600",children:"Status"})}),e.jsx(p,{children:be(i.balance_status)})]})]}),e.jsx(u,{className:"mb-6",children:e.jsx(p,{className:"pt-6",children:e.jsxs("div",{className:"flex items-end gap-4",children:[e.jsx(Oe,{startDate:U,endDate:L,onChange:Ne}),(U||L)&&e.jsx(t,{variant:"outline",size:"sm",onClick:_e,className:"mb-6",children:"Clear Filters"})]})})}),e.jsxs(u,{children:[e.jsxs(b,{children:[e.jsx(N,{children:"Transaction History"}),e.jsx(ke,{children:"All credits and debits for this savings account"})]}),e.jsxs(p,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(qe,{children:[e.jsx(Be,{children:e.jsxs(se,{children:[e.jsx(j,{children:"Date"}),e.jsx(j,{children:"Type"}),e.jsx(j,{className:"text-right",children:"Amount"}),e.jsx(j,{children:"Reason/Notes"}),e.jsx(j,{className:"text-right",children:"Running Balance"}),e.jsx(j,{className:"text-right",children:"Actions"})]})}),e.jsx(He,{children:n.data.map(s=>e.jsxs(se,{children:[e.jsx(g,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:s.transaction_date})]})}),e.jsx(g,{children:e.jsx(A,{className:s.type==="credit"?"bg-green-600 text-white hover:bg-green-700":"bg-red-600 text-white hover:bg-red-700",children:s.type==="credit"?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"mr-1 h-3 w-3"}),"Credit"]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"mr-1 h-3 w-3"}),"Debit"]})})}),e.jsx(g,{className:"text-right",children:e.jsxs("span",{className:`font-medium ${s.type==="credit"?"text-green-600":"text-red-600"}`,children:[s.type==="credit"?"+":"-",h(s.amount)]})}),e.jsx(g,{children:e.jsxs("div",{children:[s.reason&&e.jsx("div",{className:"font-medium",children:s.reason}),s.notes&&e.jsx("div",{className:"text-sm text-gray-500",children:s.notes}),!s.reason&&!s.notes&&e.jsx("span",{className:"text-gray-400",children:"-"})]})}),e.jsx(g,{className:"text-right",children:e.jsx("span",{className:`font-bold ${s.running_balance>=0?"text-green-600":"text-red-600"}`,children:h(s.running_balance)})}),e.jsx(g,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{variant:"outline",size:"sm",onClick:()=>De(s),className:"text-blue-600 hover:text-blue-700",children:e.jsx(te,{className:"h-3 w-3"})}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>we(s),className:"text-red-600 hover:text-red-700",children:e.jsx($e,{className:"h-3 w-3"})})]})})]},s.id))})]})}),n.data.length===0&&e.jsx("div",{className:"text-muted-foreground py-8 text-center",children:"No transactions found. Add a credit or debit to get started."}),(n.prev_page_url||n.next_page_url)&&e.jsxs("div",{className:"mt-6 flex items-center justify-center gap-4",children:[n.prev_page_url?e.jsx(P,{href:n.prev_page_url,preserveState:!0,preserveScroll:!0,className:"rounded border bg-white px-3 py-1 hover:bg-gray-100",children:"Previous"}):e.jsx("span",{className:"cursor-not-allowed rounded border bg-gray-200 px-3 py-1",children:"Previous"}),e.jsx("span",{className:"rounded border px-3 py-1",children:n.current_page}),n.next_page_url?e.jsx(P,{href:n.next_page_url,preserveState:!0,preserveScroll:!0,className:"rounded border bg-white px-3 py-1 hover:bg-gray-100",children:"Next"}):e.jsx("span",{className:"cursor-not-allowed rounded border bg-gray-200 px-3 py-1",children:"Next"})]})]})]}),e.jsx(F,{open:le,onOpenChange:y,children:e.jsxs(E,{className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(q,{children:"Edit Transaction"}),e.jsx(B,{children:"Update the transaction details."})]}),e.jsxs("form",{onSubmit:Ce,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"edit-type",children:"Type"}),e.jsxs("select",{id:"edit-type",value:o.type,onChange:s=>x("type",s.target.value),className:"w-full rounded border px-3 py-2",children:[e.jsx("option",{value:"credit",children:"Credit"}),e.jsx("option",{value:"debit",children:"Debit"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{htmlFor:"edit-amount",children:["Amount ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{id:"edit-amount",type:"number",step:"0.01",min:"0.01",value:o.amount,onChange:s=>x("amount",s.target.value),required:!0}),m.amount&&e.jsx("p",{className:"text-sm text-red-500",children:m.amount})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{htmlFor:"edit-date",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{id:"edit-date",type:"date",value:o.transaction_date,onChange:s=>x("transaction_date",s.target.value),required:!0}),m.transaction_date&&e.jsx("p",{className:"text-sm text-red-500",children:m.transaction_date})]}),o.type==="debit"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{htmlFor:"edit-reason",children:["Reason ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(v,{id:"edit-reason",value:o.reason,onChange:s=>x("reason",s.target.value),rows:2}),m.reason&&e.jsx("p",{className:"text-sm text-red-500",children:m.reason})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"edit-notes",children:"Notes"}),e.jsx(v,{id:"edit-notes",value:o.notes,onChange:s=>x("notes",s.target.value),rows:2})]})]}),e.jsxs(H,{className:"mt-6",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsx(t,{type:"submit",disabled:K,className:"bg-blue-600 hover:bg-blue-700",children:K?"Updating...":"Update Transaction"})]})]})]})}),e.jsx(F,{open:oe,onOpenChange:f,children:e.jsxs(E,{className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(q,{children:"Edit Savings"}),e.jsx(B,{children:"Update the savings account details."})]}),e.jsxs("form",{onSubmit:Se,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(a,{htmlFor:"savings-name",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(l,{id:"savings-name",value:Q.name,onChange:s=>X("name",s.target.value),required:!0}),S.name&&e.jsx("p",{className:"text-sm text-red-500",children:S.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{htmlFor:"savings-description",children:"Description"}),e.jsx(v,{id:"savings-description",value:Q.description,onChange:s=>X("description",s.target.value),rows:3}),S.description&&e.jsx("p",{className:"text-sm text-red-500",children:S.description})]})]}),e.jsxs(H,{className:"mt-6",children:[e.jsx(t,{type:"button",variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsx(t,{type:"submit",disabled:Y,children:Y?"Updating...":"Update Savings"})]})]})]})})]})})]})}export{ls as default};
