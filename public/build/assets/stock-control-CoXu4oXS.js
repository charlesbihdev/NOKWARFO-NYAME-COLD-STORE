import{j as e,r as g,m as U,S}from"./app-D2J-B9oG.js";import{f as _,A as z}from"./app-layout-GD4HsK_H.js";import{D as B}from"./DateRangePicker-Dya-fL7I.js";import{F as y}from"./createLucideIcon-C6_Fh7Gx.js";import{D as J,b as K,c as V,d as W}from"./dialog-CFqXz8PC.js";import{I as b}from"./index-Cutdopr1.js";import{L as h}from"./label-2sanNPpy.js";import{C as k,a as C,b as T,c as A}from"./card-BYx1Opn1.js";import{T as D,a as w,b as m,c as a,d as q,e as l}from"./table-Cf-Jrtd-.js";import"./index-amgbxTWX.js";import"./index-edZu-Coi.js";function X({isOpen:d,onClose:o,selectedProduct:t,data:s,setData:c,suppliers:N,errors:n,processing:f,onSubmit:u}){function v(){return s.type==="adjusted"?{type:"number",step:1,placeholder:"e.g. -5 for loss, 5 for gain",min:void 0}:{type:"number",step:1,placeholder:"Enter quantity",min:1}}return e.jsx(J,{open:d,onOpenChange:o,children:e.jsxs(K,{className:"max-w-2xl",children:[e.jsx(V,{children:e.jsxs(W,{children:["Add Stock for ",t==null?void 0:t.name]})}),e.jsxs("form",{onSubmit:u,className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(h,{htmlFor:"type",className:"text-right",children:"Type *"}),e.jsxs("div",{className:"col-span-3",children:[e.jsxs("select",{id:"type",value:s.type,onChange:r=>c("type",r.target.value),required:!0,className:"w-full rounded border px-2 py-1",children:[e.jsx("option",{value:"received",children:"Stock In"}),e.jsx("option",{value:"sold",children:"Stock Out"}),e.jsx("option",{value:"adjusted",children:"Adjusted"})]}),n.type&&e.jsx("div",{className:"mt-1 text-xs text-red-500",children:n.type})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(h,{htmlFor:"quantity",className:"text-right",children:"Quantity *"}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(b,{id:"quantity",...v(),value:s.quantity,onChange:r=>c("quantity",r.target.value),required:!0}),n.quantity&&e.jsx("div",{className:"mt-1 text-xs text-red-500",children:n.quantity}),s.type==="adjusted"&&e.jsx("div",{className:"text-muted-foreground mt-1 text-xs",children:"Use a negative number for loss (e.g. -5 for damaged/expired), positive for gain/correction."})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(h,{htmlFor:"unit_cost",className:"text-right",children:"Unit Cost (GH₵) *"}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(b,{id:"unit_cost",type:"number",step:"0.01",placeholder:"0.00",value:s.unit_cost,onChange:r=>c("unit_cost",r.target.value),required:!0}),n.unit_cost&&e.jsx("div",{className:"mt-1 text-xs text-red-500",children:n.unit_cost})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(h,{htmlFor:"supplier_id",className:"text-right",children:"Supplier *"}),e.jsxs("div",{className:"col-span-3",children:[e.jsxs("select",{id:"supplier_id",value:s.supplier_id,onChange:r=>c("supplier_id",r.target.value),required:!0,className:"w-full rounded border px-2 py-1",children:[e.jsx("option",{value:"",children:"Select supplier"}),N.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),n.supplier_id&&e.jsx("div",{className:"mt-1 text-xs text-red-500",children:n.supplier_id})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(h,{htmlFor:"notes",className:"text-right",children:"Notes"}),e.jsx("div",{className:"col-span-3",children:e.jsx(b,{id:"notes",placeholder:"Optional notes",value:s.notes,onChange:r=>c("notes",r.target.value)})})]}),e.jsx(y,{type:"submit",disabled:f,children:"Add Stock"})]})]})})}function Y({products:d,onAddStock:o}){return e.jsxs(k,{children:[e.jsx(C,{children:e.jsx(T,{children:"Product Inventory"})}),e.jsx(A,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-left font-medium",children:"Product Name"}),e.jsx("th",{className:"p-2 text-center",children:"Current Stock"}),e.jsx("th",{className:"p-2 text-left",children:"Supplier"}),e.jsx("th",{className:"p-2 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:d.map(t=>{var s;return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2 font-medium",children:t.name}),e.jsx("td",{className:"p-2 text-center",children:t.current_stock_display??"0"}),e.jsx("td",{className:"p-2",children:((s=t.supplier)==null?void 0:s.name)||"N/A"}),e.jsx("td",{className:"p-2 text-center",children:e.jsx(y,{variant:"outline",size:"sm",onClick:()=>o(t),children:"Add Stock"})})]},t.id)})})]})})})]})}function Z({stock_activity_summary:d,start_date:o,end_date:t}){return e.jsxs("div",{className:"mb-8 rounded-lg bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[e.jsx(_,{className:"h-6 w-6 text-gray-500"}),e.jsxs("h2",{className:"text-2xl font-bold",children:["Product Stock Activity Summary"," ",o&&t?e.jsxs(e.Fragment,{children:["(",new Date(o).toLocaleDateString()," - ",new Date(t).toLocaleDateString(),")"]}):"(Today)"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(D,{children:[e.jsx(w,{children:e.jsxs(m,{children:[e.jsx(a,{children:"Product"}),e.jsx(a,{children:"Stock Received today"}),e.jsx(a,{children:"Previous Stock"}),e.jsx(a,{className:"bg-blue-50",children:"Total Available"}),e.jsx(a,{children:"Cash Sales"}),e.jsx(a,{children:"Credit Sales"}),e.jsx(a,{children:"Partial Sales"}),e.jsx(a,{className:"bg-green-50",children:"Total Sales"}),e.jsx(a,{className:"bg-yellow-50",children:"Remaining Stock"})]})}),e.jsx(q,{children:d.length?d.map((s,c)=>e.jsxs(m,{children:[e.jsx(l,{className:"font-medium",children:s.product}),e.jsx(l,{className:"text-center",children:s.stock_received_today}),e.jsx(l,{className:"text-center",children:s.previous_stock}),e.jsx(l,{className:"bg-blue-50 text-center font-semibold",children:s.total_available}),e.jsx(l,{className:"text-center",children:s.cash_sales}),e.jsx(l,{className:"text-center",children:s.credit_sales}),e.jsx(l,{className:"text-center",children:s.partial_sales}),e.jsx(l,{className:"bg-green-50 text-center font-semibold",children:s.total_sales}),e.jsx(l,{className:"bg-yellow-50 text-center font-semibold",children:s.remaining_stock})]},s.product+c)):e.jsx(m,{children:e.jsx(l,{colSpan:9,className:"text-muted-foreground py-4 text-center",children:"No data for today."})})})]})}),e.jsxs("div",{className:"text-muted-foreground mt-3 flex flex-col gap-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-4 w-4 rounded-sm border border-blue-100 bg-blue-50"}),e.jsx("span",{children:"Total Available = Stock Received + Previous Stock"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-4 w-4 rounded-sm border border-green-100 bg-green-50"}),e.jsx("span",{children:"Total Sales = Cash Sales + Credit Sales + Partial Sales"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-4 w-4 rounded-sm border border-yellow-100 bg-yellow-50"}),e.jsx("span",{children:"Remaining Stock = Total Available - Total Sales"})]})]})]})}function $({stock_movements:d,onDelete:o}){return e.jsxs(k,{children:[e.jsx(C,{children:e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-5 w-5"}),"Stock Movements"]})}),e.jsx(A,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(D,{children:[e.jsx(w,{children:e.jsxs(m,{children:[e.jsx(a,{children:"Product"}),e.jsx(a,{children:"Supplier"}),e.jsx(a,{children:"Type"}),e.jsx(a,{children:"Quantity"}),e.jsx(a,{children:"Unit Cost"}),e.jsx(a,{children:"Total Cost"}),e.jsx(a,{children:"Notes"}),e.jsx(a,{children:"Actions"})]})}),e.jsx(q,{children:d.map(t=>{var s,c;return e.jsxs(m,{children:[e.jsx(l,{children:(s=t.product)==null?void 0:s.name}),e.jsx(l,{children:(c=t.supplier)==null?void 0:c.name}),e.jsx(l,{children:t.type}),e.jsx(l,{children:t.quantity_display}),e.jsxs(l,{children:["GH₵",parseFloat(t.price_per_carton).toFixed(2)]}),e.jsxs(l,{children:["GH₵",parseFloat(t.total_cost).toFixed(2)]}),e.jsx(l,{children:t.notes}),e.jsx(l,{children:e.jsx(y,{variant:"outline",size:"sm",onClick:()=>o(t.id),children:"Delete"})})]},t.id)})})]})})})]})}function xe({stock_movements:d=[],products:o=[],suppliers:t=[],stock_activity_summary:s=[],date:c}){const[N,n]=g.useState(!1),[f,u]=g.useState(null),{data:v,setData:r,post:F,processing:P,errors:I,reset:R}=U({product_id:"",supplier_id:"",type:"received",quantity:"",unit_cost:"",total_cost:"",notes:""}),[p,H]=g.useState(""),[j,M]=g.useState(""),O=[{title:"Stock Control",href:"/stock-control"}];function L(i){u(i),r({product_id:i.id,supplier_id:i.supplier_id?i.supplier_id.toString():"",type:"received",quantity:"",unit_cost:i.cost_price||"",total_cost:"",notes:""}),n(!0)}function E(i){i.preventDefault(),F(route("stock-control.store"),{onSuccess:()=>{R(),n(!1),u(null)},preserveScroll:!0,preserveState:!0,only:["products","stock_movements","stock_activity_summary","errors","flash"]})}function G(i){confirm("Are you sure you want to delete this stock movement?")&&S.delete(route("stock-control.destroy",i),{preserveScroll:!0,preserveState:!1})}const Q=(i,x)=>{x==="start"?H(i):x==="end"&&M(i),(x==="start"&&j||x==="end"&&p)&&S.get(route("stock-control.index"),{start_date:x==="start"?i:p,end_date:x==="end"?i:j},{preserveState:!0,replace:!0})};return e.jsx(z,{breadcrumbs:O,children:e.jsxs("div",{className:"min-h-screen space-y-6 bg-gray-100 p-6",children:[e.jsx(B,{startDate:p,endDate:j,onChange:Q}),e.jsx(Z,{stock_activity_summary:s,start_date:p,end_date:j}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Inventory Management"})}),e.jsx(Y,{products:o,onAddStock:L}),e.jsx(X,{isOpen:N,onClose:()=>n(!1),selectedProduct:f,data:v,setData:r,suppliers:t,errors:I,processing:P,onSubmit:E}),e.jsx($,{stock_movements:d,onDelete:G})]})})}export{xe as default};
