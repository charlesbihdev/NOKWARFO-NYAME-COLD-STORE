import{b as z,r as i,u as L,a as u,j as e}from"./app-IpDexUkN.js";import{F as d}from"./createLucideIcon-JR7TBAdw.js";import{C as p,a as j,b as g,c as N}from"./card-Datb66K2.js";import{D as y,a as R,b as w,c as S,d as T}from"./dialog-DX-NdddR.js";import{I as l}from"./input-Dwv0R-j5.js";import{L as r}from"./label-BdzILd_E.js";import{T as J,a as K,b as F,c as n,d as Q,e as c}from"./table-BAEXV-Dd.js";import{T as X}from"./textarea-bDV6g11N.js";import{A as V,U as A,d as W,M as Y}from"./app-layout-BFhBj9u0.js";import{l as Z,S as $}from"./lodash-BzbrT40b.js";import{P as ee}from"./plus-BoFh4Jbm.js";import{P as se,M as ae}from"./phone-EeJ7rh04.js";import{T as te}from"./triangle-alert-CpCi-qvB.js";import{H as re}from"./history-BwjHRvsg.js";import{S as le}from"./square-pen-D5ecgMa4.js";import{T as ie}from"./trash-2-5JMONNu1.js";import"./index-Cdu7Mxog.js";import"./index-CgFigxQE.js";function Te(){const{customers:o=[],filters:E={}}=z().props,[D,x]=i.useState(!1),[H,f]=i.useState(null),{data:t,setData:a,post:P,put:M,processing:v,errors:de,reset:b}=L({name:"",phone:"",email:"",address:""}),[O,h]=i.useState(!1),[m,_]=i.useState(E.search||""),C=i.useCallback(Z.debounce(s=>{u.get(route("customers.index"),{search:s||void 0},{preserveState:!0,preserveScroll:!0,replace:!0})},400),[]);i.useEffect(()=>{C(m)},[m,C]);const k=[{title:"Customers",href:"/customers"}];function I(s){s.preventDefault(),P(route("customers.store"),{onSuccess:()=>{b(),h(!1)}})}function q(s){f(s),a({name:s.name,phone:s.phone||"",email:s.email||"",address:s.address||""}),x(!0)}function B(s){s.preventDefault(),M(route("customers.update",H.id),{onSuccess:()=>{b(),x(!1),f(null)},preserveScroll:!0,preserveState:!0,only:["customers","errors","flash"]})}function G(s){confirm("Are you sure you want to delete this customer?")&&u.delete(route("customers.destroy",s),{preserveScroll:!0,preserveState:!0,only:["customers","flash"]})}return e.jsxs(V,{breadcrumbs:k,children:[e.jsxs("div",{className:"min-h-screen space-y-6 bg-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Customers"}),e.jsxs(y,{open:O,onOpenChange:h,children:[e.jsx(R,{asChild:!0,children:e.jsxs(d,{onClick:()=>h(!0),children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Add Customer"]})}),e.jsxs(w,{className:"max-w-2xl",children:[e.jsx(S,{children:e.jsx(T,{children:"Add New Customer"})}),e.jsxs("form",{onSubmit:I,className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"customer-name",className:"text-right",children:"Customer Name"}),e.jsx(l,{id:"customer-name",className:"col-span-3",placeholder:"Enter customer name",value:t.name,onChange:s=>a("name",s.target.value),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"phone",className:"text-right",children:"Phone"}),e.jsx(l,{id:"phone",className:"col-span-3",placeholder:"+233 XX XXX XXXX",value:t.phone,onChange:s=>a("phone",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"email",className:"text-right",children:"Email"}),e.jsx(l,{id:"email",type:"email",className:"col-span-3",placeholder:"customer@email.com",value:t.email,onChange:s=>a("email",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"address",className:"text-right",children:"Address"}),e.jsx(X,{id:"address",className:"col-span-3",placeholder:"Customer address",value:t.address,onChange:s=>a("address",s.target.value)})]}),e.jsx(d,{type:"submit",disabled:v,children:"Add Customer"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-4",children:[e.jsxs(p,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Total Customers"}),e.jsx(A,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(N,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.length}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Active customers"})]})]}),e.jsxs(p,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(g,{className:"text-sm font-medium",children:"Outstanding Balance"}),e.jsx(W,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(N,{children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["GH₵",o.reduce((s,U)=>s+parseFloat(U.outstanding_balance),0).toFixed(2)]}),e.jsx("p",{className:"text-muted-foreground text-xs",children:"Total owed"})]})]})]}),e.jsxs(p,{children:[e.jsxs(j,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Customer Directory"]}),e.jsx("div",{className:"mt-4 flex items-center space-x-2",children:e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx($,{className:"text-muted-foreground absolute top-2.5 left-2 h-4 w-4"}),e.jsx(l,{placeholder:"Search by name, phone, email, or address...",value:m,onChange:s=>_(s.target.value),className:"pl-8"})]})})]}),e.jsxs(N,{children:[e.jsxs(J,{children:[e.jsx(K,{children:e.jsxs(F,{children:[e.jsx(n,{children:"Customer Name"}),e.jsx(n,{children:"Contact Info"}),e.jsx(n,{children:"Address"}),e.jsx(n,{children:"Outstanding Balance"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(Q,{children:o.map(s=>e.jsxs(F,{children:[e.jsx(c,{className:"font-medium",children:s.name}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(se,{className:"h-3 w-3"}),s.phone]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(ae,{className:"h-3 w-3"}),s.email]})]})}),e.jsx(c,{className:"max-w-xs",children:e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Y,{className:"h-3 w-3"}),s.address]})}),e.jsx(c,{className:"font-medium",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:s.outstanding_balance>0?"text-red-600 font-bold":"text-green-600 font-bold",children:["GH₵",parseFloat(s.outstanding_balance).toFixed(2)]}),s.has_outstanding_debt&&e.jsx(te,{className:"h-4 w-4 text-red-500"})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Total Debt: GH₵",parseFloat(s.total_debt).toFixed(2)]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Total Payments: GH₵",parseFloat(s.total_payments).toFixed(2)]})]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:()=>u.visit(route("customers.transactions",s.id)),className:"text-blue-600 hover:text-blue-700",children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>q(s),children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>G(s.id),children:e.jsx(ie,{className:"h-4 w-4"})})]})})]},s.id))})]}),o.length===0&&e.jsx("div",{className:"text-muted-foreground py-8 text-center",children:m?"No customers found matching your search.":"No customers found."})]})]})]}),e.jsx(y,{open:D,onOpenChange:x,children:e.jsxs(w,{className:"max-w-2xl",children:[e.jsx(S,{children:e.jsx(T,{children:"Edit Customer"})}),e.jsxs("form",{onSubmit:B,className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"edit-customer-name",className:"text-right",children:"Customer Name"}),e.jsx(l,{id:"edit-customer-name",className:"col-span-3",placeholder:"Enter customer name",value:t.name,onChange:s=>a("name",s.target.value),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"edit-phone",className:"text-right",children:"Phone"}),e.jsx(l,{id:"edit-phone",className:"col-span-3",placeholder:"+233 XX XXX XXXX",value:t.phone,onChange:s=>a("phone",s.target.value),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"edit-email",className:"text-right",children:"Email"}),e.jsx(l,{id:"edit-email",type:"email",className:"col-span-3",placeholder:"customer@email.com",value:t.email,onChange:s=>a("email",s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(r,{htmlFor:"edit-address",className:"text-right",children:"Address"}),e.jsx(X,{id:"edit-address",className:"col-span-3",placeholder:"Customer address",value:t.address,onChange:s=>a("address",s.target.value)})]}),e.jsx(d,{type:"submit",disabled:v,children:"Update Customer"})]})]})})]})}export{Te as default};
