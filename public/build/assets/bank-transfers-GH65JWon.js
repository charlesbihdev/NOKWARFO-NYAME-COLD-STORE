import{j as e,u as D,r as g,b as I,L as C,a as T}from"./app-D9W2RBWy.js";import{B as R,A as G}from"./app-layout-hwuXJgsN.js";import{D as V}from"./DateRangePicker-CvIkg65D.js";import{F as u}from"./createLucideIcon-DfWXCTQJ.js";import{D as F,a as W,b as B,c as A,d as L}from"./dialog-BO9mjXxu.js";import{I as h}from"./input-BtH41U81.js";import{L as m}from"./label-BIJYTkn6.js";import{S as $,a as U,b as Y,c as z,d as q}from"./select-oaw8TwJf.js";import{C as J,a as K,b as Q,c as X}from"./card-wGNYwX-p.js";import{T as Z,a as ee,b as S,c as x,d as se,e as d}from"./table-diz_AGw9.js";import{T as te}from"./trash-2-CGZssAvt.js";import"./index-BeTU2ozR.js";import"./index-BWSr9lRR.js";import"./index-DBTfX-p9.js";function ae({analytics:i}){if(!i)return null;const{overall:t,by_tag:c}=i;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-green-100",children:e.jsx("svg",{className:"h-5 w-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Credit"}),e.jsxs("p",{className:"text-2xl font-semibold text-green-600",children:["₵",t.total_credit]})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-red-100",children:e.jsx("svg",{className:"h-5 w-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Debit"}),e.jsxs("p",{className:"text-2xl font-semibold text-red-600",children:["₵",t.total_debit]})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-md bg-blue-100",children:e.jsx("svg",{className:"h-5 w-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Transactions"}),e.jsx("p",{className:"text-2xl font-semibold text-blue-600",children:t.total_transactions})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`flex h-8 w-8 items-center justify-center rounded-md ${parseFloat(t.net_amount.replace(/,/g,""))>=0?"bg-green-100":"bg-red-100"}`,children:e.jsx("svg",{className:`h-5 w-5 ${parseFloat(t.net_amount.replace(/,/g,""))>=0?"text-green-600":"text-red-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Net Amount"}),e.jsxs("p",{className:`text-2xl font-semibold ${parseFloat(t.net_amount.replace(/,/g,""))>=0?"text-green-600":"text-red-600"}`,children:["₵",t.net_amount]})]})]})})]}),c&&c.length>0&&e.jsxs("div",{className:"rounded-lg bg-white shadow",children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Analytics by Tag"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Tag"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Total Credit"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Total Debit"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Transactions"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Net Amount"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:c.map((l,r)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 flex-shrink-0",children:e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-gray-200",children:e.jsx("span",{className:"text-sm font-medium text-gray-600",children:l.tag_name.charAt(0).toUpperCase()})})}),e.jsx("div",{className:"ml-3",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:l.tag_name})})]})}),e.jsxs("td",{className:"px-6 py-4 text-sm font-medium whitespace-nowrap text-green-600",children:["₵",l.total_credit]}),e.jsxs("td",{className:"px-6 py-4 text-sm font-medium whitespace-nowrap text-red-600",children:["₵",l.total_debit]}),e.jsx("td",{className:"px-6 py-4 text-sm whitespace-nowrap text-gray-900",children:l.transaction_count}),e.jsx("td",{className:"px-6 py-4 text-sm font-medium whitespace-nowrap",children:e.jsxs("span",{className:`${parseFloat(l.net_amount.replace(/,/g,""))>=0?"text-green-600":"text-red-600"}`,children:["₵",l.net_amount]})})]},l.tag_id||r))})]})})]})]})}function re({tags:i,lastBalance:t,isOpen:c,setIsOpen:l}){const{data:r,setData:s,post:o,processing:p,errors:a,reset:v}=D({date:new Date().toISOString().split("T")[0],previous_balance:t.toString(),credit:"0",total_balance:t.toString(),debit:"0",tag_id:"",current_balance:t.toString(),notes:""});g.useEffect(()=>{s(n=>({...n,previous_balance:t.toString(),total_balance:t.toString(),current_balance:t.toString()}))},[t]),g.useEffect(()=>{const n=parseFloat(r.previous_balance)||0,_=parseFloat(r.credit)||0,b=parseFloat(r.debit)||0,f=n+_,N=f-b;s(k=>({...k,total_balance:f.toFixed(2),current_balance:N.toFixed(2)}))},[r.previous_balance,r.credit,r.debit]);function j(n){n.preventDefault(),o(route("bank-transfers.store"),{preserveScroll:!0,preserveState:!0,only:["bank_transfers","last_balance","errors","flash"],onSuccess:()=>{v(),l(!1)}})}return e.jsxs(F,{open:c,onOpenChange:l,children:[e.jsx(W,{asChild:!0,children:e.jsx(u,{children:"Record Transfer"})}),e.jsxs(B,{className:"max-h-[96vh] max-w-2xl overflow-y-auto",children:[e.jsx(A,{children:e.jsx(L,{children:"Record Bank Transfer"})}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"date",children:"Date"}),e.jsx(h,{id:"date",type:"date",value:r.date,onChange:n=>s("date",n.target.value)}),a.date&&e.jsx("div",{className:"text-sm text-red-500",children:a.date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"previous_balance",children:"Previous Balance"}),e.jsx(h,{id:"previous_balance",type:"number",step:"0.01",value:r.previous_balance,onChange:n=>s("previous_balance",n.target.value)}),a.previous_balance&&e.jsx("div",{className:"text-sm text-red-500",children:a.previous_balance})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"credit",children:"Credit Amount"}),e.jsx(h,{id:"credit",type:"number",step:"0.01",value:r.credit,onChange:n=>s("credit",n.target.value)}),a.credit&&e.jsx("div",{className:"text-sm text-red-500",children:a.credit})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"total_balance",children:"Total Balance"}),e.jsx(h,{id:"total_balance",type:"number",step:"0.01",value:r.total_balance,readOnly:!0,className:"cursor-not-allowed bg-gray-200"}),a.total_balance&&e.jsx("div",{className:"text-sm text-red-500",children:a.total_balance})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"debit",children:"Debit Amount"}),e.jsx(h,{id:"debit",type:"number",step:"0.01",value:r.debit,onChange:n=>s("debit",n.target.value)}),a.debit&&e.jsx("div",{className:"text-sm text-red-500",children:a.debit})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"tag",children:"Tag"}),e.jsxs($,{value:r.tag_id,onValueChange:n=>s("tag_id",n),children:[e.jsx(U,{children:e.jsx(Y,{placeholder:"Select a tag"})}),e.jsx(z,{children:i.map(n=>e.jsx(q,{value:n.id.toString(),children:n.name},n.id))})]}),a.tag_id&&e.jsx("div",{className:"text-sm text-red-500",children:a.tag_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"current_balance",children:"Current Balance"}),e.jsx(h,{id:"current_balance",type:"number",step:"0.01",value:r.current_balance,readOnly:!0,className:"cursor-not-allowed bg-gray-200"}),a.current_balance&&e.jsx("div",{className:"text-sm text-red-500",children:a.current_balance})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(m,{htmlFor:"notes",children:"Notes"}),e.jsx("textarea",{id:"notes",className:"border-input bg-background ring-offset-background placeholder:text-muted-foreground focus-visible:ring-ring min-h-[60px] w-full rounded-md border px-3 py-2 text-sm focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",value:r.notes,onChange:n=>s("notes",n.target.value),placeholder:"Enter any additional notes...",rows:2}),a.notes&&e.jsx("div",{className:"text-sm text-red-500",children:a.notes})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsx(u,{type:"submit",disabled:p,children:p?"Recording...":"Record Transfer"})]})]})]})]})}function ne({bankTransfers:i,onDeleteClick:t}){const{start_date:c,end_date:l}=I().props,r=s=>{if(!s)return"#";const o=new URL(s);return o.searchParams.set("start_date",c||""),o.searchParams.set("end_date",l||""),o.toString()};return e.jsxs(J,{children:[e.jsx(K,{children:e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5"}),"Bank Transfer Ledger"]})}),e.jsxs(X,{children:[e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(S,{children:[e.jsx(x,{children:"Date"}),e.jsx(x,{children:"Previous Balance"}),e.jsx(x,{children:"Credit"}),e.jsx(x,{children:"Total Balance"}),e.jsx(x,{children:"Debit"}),e.jsx(x,{children:"Tag"}),e.jsx(x,{children:"Current Balance"}),e.jsx(x,{children:"Notes"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(se,{children:i.data.length>0?i.data.map(s=>e.jsxs(S,{children:[e.jsx(d,{children:s.date}),e.jsxs(d,{children:["GH₵",s.previous_balance||0]}),e.jsxs(d,{className:"text-green-600",children:["GH₵",s.credit||0]}),e.jsxs(d,{children:["GH₵",s.total_balance||0]}),e.jsxs(d,{className:"text-red-600",children:["GH₵",s.debit||0]}),e.jsx(d,{children:s.tag?s.tag.name:"No tag"}),e.jsxs(d,{className:"font-medium",children:["GH₵",s.current_balance||0]}),e.jsx(d,{className:"max-w-[200px]",children:e.jsx("span",{className:"truncate",children:s.notes||"-"})}),e.jsx(d,{className:"max-w-[200px]",children:e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>t(s.id),className:"h-8 w-8 bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-700",children:e.jsx(te,{className:"h-4 w-4"})})})]},s.id)):e.jsx(S,{children:e.jsx(d,{colSpan:9,className:"text-muted-foreground text-center",children:"No bank transfers recorded for the selected date range"})})})]}),e.jsxs("div",{className:"my-3 flex items-center justify-center gap-4",children:[i.prev_page_url&&e.jsx(C,{preserveScroll:!0,preserveState:!0,href:r(i.prev_page_url),className:"rounded border px-4 py-2 hover:bg-gray-100",children:"« Previous"}),e.jsxs("span",{className:"px-4 py-2 font-medium",children:["Page ",i.current_page]}),i.next_page_url&&e.jsx(C,{preserveScroll:!0,preserveState:!0,href:r(i.next_page_url),className:"rounded border px-4 py-2 hover:bg-gray-100",children:"Next »"})]})]})]})}function le({isOpen:i,onClose:t,onConfirm:c}){return e.jsx(F,{open:i,onOpenChange:l=>!l&&t(),children:e.jsxs(B,{children:[e.jsx(A,{children:e.jsx(L,{children:"Delete Bank Transfer"})}),e.jsx("div",{className:"py-4",children:e.jsx("p",{children:"Are you sure you want to delete this bank transfer record? This action cannot be undone."})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(u,{variant:"outline",onClick:t,children:"Cancel"}),e.jsx(u,{className:"text-white",variant:"destructive",onClick:c,children:"Delete"})]})]})})}function ie({onAddTag:i}){const{data:t,setData:c,post:l,processing:r,errors:s,reset:o}=D({name:""});function p(a){a.preventDefault(),t.name.trim()&&l(route("bank-transfer-tags.store"),{preserveScroll:!0,onSuccess:()=>{o(),i()}})}return e.jsxs("form",{onSubmit:p,className:"flex items-center space-x-2",children:[e.jsx(h,{placeholder:"New tag name",value:t.name,onChange:a=>c("name",a.target.value),className:s.name?"border-red-500":""}),s.name&&e.jsx("div",{className:"text-sm text-red-500",children:s.name}),e.jsx(u,{type:"submit",variant:"outline",disabled:!t.name.trim()||r,children:"Add Tag"})]})}function ye({bank_transfers:i=[],tags:t=[],last_balance:c=0,start_date:l="",end_date:r="",analytics:s=null}){const[o,p]=g.useState(!1),[a,v]=g.useState(null),j=new Date,n=new Date(j.getFullYear(),j.getMonth(),1).toISOString().slice(0,10),_=new Date(j.getFullYear(),j.getMonth()+1,0).toISOString().slice(0,10),[b,f]=g.useState(l||n),[N,k]=g.useState(r||_),M=(y,w)=>{const P=w==="start"?y:b,E=w==="end"?y:N;w==="start"&&f(y),w==="end"&&k(y),T.get(route("bank-transfers.index"),{start_date:P,end_date:E,page:1},{preserveState:!0,preserveScroll:!0,replace:!0})};function O(){a&&T.delete(route("bank-transfers.destroy",a),{method:"delete",preserveScroll:!0,preserveState:!1,onSuccess:()=>v(null)})}function H(){}return e.jsx(G,{breadcrumbs:[{title:"Bank Transfers",href:"/bank-transfers"}],children:e.jsxs("div",{className:"min-h-screen space-y-6 bg-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Bank Transfers"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(ie,{onAddTag:H}),e.jsx(re,{tags:t,lastBalance:c,isOpen:o,setIsOpen:p})]})]}),e.jsx(V,{startDate:b,endDate:N,onChange:M}),e.jsx(ae,{analytics:s}),e.jsx(ne,{bankTransfers:i,onDeleteClick:v}),e.jsx(le,{isOpen:!!a,onClose:()=>v(null),onConfirm:O})]})})}export{ye as default};
