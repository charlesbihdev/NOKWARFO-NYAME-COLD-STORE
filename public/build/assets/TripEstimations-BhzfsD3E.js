import{j as e,r as C,U as ae,u as $e,L as Ce,a as we}from"./app-B6lirdlh.js";import{A as Be,M as We,T as De}from"./app-layout-C1wjfMPJ.js";import{D as Ye}from"./DateRangePicker-C9y9tT6G.js";import{c as Ne,u as Te,a as Ke,b as B,d as Ae,F as P}from"./createLucideIcon-D4jR-BHI.js";import{C as K,a as J,b as X,c as Z}from"./card-y7TeMzlQ.js";import{B as Je}from"./badge-BCXijmTV.js";import{T as Xe,a as Ze,b as je,c as G,d as et,e as O}from"./table-Dwi86hgx.js";import{c as tt,a as st}from"./index-F8aK6LC_.js";import{g as Pe,R as at,P as lt,W as it,C as nt,T as rt,h as ct,i as ke,O as ot,j as dt,D as ve,b as _e,c as ye,d as be}from"./dialog-CPHFziJb.js";import{I as v}from"./index-C1QFYvfO.js";import{L as m}from"./label-Bxf_TVtZ.js";import{T as qe}from"./textarea-BtVR-xoP.js";import{S as k,a as q,b as E,c as F,d as I}from"./select-CRDghA5t.js";import{I as p}from"./InputError-DSsPX8nw.js";import{P as Se}from"./plus-Bt8nBrhT.js";import{T as ee}from"./trash-2-Ckn0AWfS.js";import{D as fe}from"./dollar-sign-wQTOmqxs.js";import{C as mt}from"./calendar-D10EHTab.js";import"./index-B05QmqfG.js";import"./index-B5z19LkR.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],Ee=Ne("Calculator",xt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],pt=Ne("Eye",ut);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],gt=Ne("Pen",ht);var Fe="AlertDialog",[jt,us]=tt(Fe,[Pe]),V=Pe(),Ie=u=>{const{__scopeAlertDialog:o,...c}=u,d=V(o);return e.jsx(at,{...d,...c,modal:!0})};Ie.displayName=Fe;var ft="AlertDialogTrigger",Nt=C.forwardRef((u,o)=>{const{__scopeAlertDialog:c,...d}=u,i=V(c);return e.jsx(dt,{...i,...d,ref:o})});Nt.displayName=ft;var vt="AlertDialogPortal",Me=u=>{const{__scopeAlertDialog:o,...c}=u,d=V(o);return e.jsx(lt,{...d,...c})};Me.displayName=vt;var _t="AlertDialogOverlay",Re=C.forwardRef((u,o)=>{const{__scopeAlertDialog:c,...d}=u,i=V(c);return e.jsx(ot,{...i,...d,ref:o})});Re.displayName=_t;var se="AlertDialogContent",[yt,bt]=jt(se),St=Ke("AlertDialogContent"),Oe=C.forwardRef((u,o)=>{const{__scopeAlertDialog:c,children:d,...i}=u,r=V(c),j=C.useRef(null),S=Te(o,j),g=C.useRef(null);return e.jsx(it,{contentName:se,titleName:Ue,docsSlug:"alert-dialog",children:e.jsx(yt,{scope:c,cancelRef:g,children:e.jsxs(nt,{role:"alertdialog",...r,...i,ref:S,onOpenAutoFocus:st(i.onOpenAutoFocus,b=>{var M;b.preventDefault(),(M=g.current)==null||M.focus({preventScroll:!0})}),onPointerDownOutside:b=>b.preventDefault(),onInteractOutside:b=>b.preventDefault(),children:[e.jsx(St,{children:d}),e.jsx(wt,{contentRef:j})]})})})});Oe.displayName=se;var Ue="AlertDialogTitle",Le=C.forwardRef((u,o)=>{const{__scopeAlertDialog:c,...d}=u,i=V(c);return e.jsx(rt,{...i,...d,ref:o})});Le.displayName=Ue;var Ge="AlertDialogDescription",He=C.forwardRef((u,o)=>{const{__scopeAlertDialog:c,...d}=u,i=V(c);return e.jsx(ct,{...i,...d,ref:o})});He.displayName=Ge;var Ct="AlertDialogAction",Ve=C.forwardRef((u,o)=>{const{__scopeAlertDialog:c,...d}=u,i=V(c);return e.jsx(ke,{...i,...d,ref:o})});Ve.displayName=Ct;var ze="AlertDialogCancel",Qe=C.forwardRef((u,o)=>{const{__scopeAlertDialog:c,...d}=u,{cancelRef:i}=bt(ze,c),r=V(c),j=Te(o,i);return e.jsx(ke,{...r,...d,ref:j})});Qe.displayName=ze;var wt=({contentRef:u})=>{const o=`\`${se}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${se}\` by passing a \`${Ge}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${se}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return C.useEffect(()=>{var d;document.getElementById((d=u.current)==null?void 0:d.getAttribute("aria-describedby"))||console.warn(o)},[o,u]),null},Dt=Ie,$t=Me,Tt=Re,At=Oe,Pt=Ve,kt=Qe,qt=Le,Et=He;const Ft=Dt,It=$t,Mt=ae.forwardRef(function({className:o,...c},d){return e.jsx(Tt,{className:B("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",o),...c,ref:d})}),Rt=ae.forwardRef(function({className:o,...c},d){return e.jsxs(It,{children:[e.jsx(Mt,{}),e.jsx(At,{ref:d,className:B("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",o),...c})]})}),Ot=function({className:o,...c}){return e.jsx("div",{className:B("flex flex-col space-y-2 text-center sm:text-left",o),...c})},Ut=function({className:o,...c}){return e.jsx("div",{className:B("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",o),...c})},Lt=ae.forwardRef(function({className:o,...c},d){return e.jsx(qt,{ref:d,className:B("text-lg font-semibold",o),...c})}),Gt=ae.forwardRef(function({className:o,...c},d){return e.jsx(Et,{ref:d,className:B("text-sm text-muted-foreground",o),...c})}),Ht=ae.forwardRef(function({className:o,...c},d){return e.jsx(Pt,{ref:d,className:B(Ae(),o),...c})}),Vt=ae.forwardRef(function({className:o,...c},d){return e.jsx(kt,{ref:d,className:B(Ae({variant:"outline"}),"mt-2 sm:mt-0",o),...c})});function zt({isOpen:u,onClose:o,products:c=[],suppliers:d=[],errors:i={}}){const[r,j]=C.useState([{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}]),{data:S,setData:g,post:b,processing:M,reset:R,clearErrors:y}=$e({trip_date:new Date().toISOString().split("T")[0],description:"",location:"",transportation_cost:"",other_expenses:"",notes:"",items:[{product_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}]});C.useEffect(()=>{if(u){const s=[{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}];j(s),R(),y(),g(t=>({...t,trip_date:new Date().toISOString().split("T")[0],description:"",location:"",transportation_cost:"",other_expenses:"",notes:"",items:s}))}},[u,R,y]);function H(s){s.preventDefault(),g({...S,items:r}),b(route("trip-estimations.store"),{onSuccess:()=>{R(),y(),j([{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}]),o()},preserveScroll:!0,preserveState:!0,only:["trips","overview","errors","flash"]})}function z(){R(),y(),j([{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}]),o()}function le(){const s=[...r,{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}];j(s),g("items",s)}function W(s){if(r.length>1){const t=r.filter((a,h)=>h!==s);j(t),g("items",t)}}function U(s,t){const a=c.find(h=>h.id==t);if(a){const h=[...r];h[s]={...h[s],product_name:a.name},j(h),g("items",h)}}function _(s,t,a){const h=[...r];h[s]={...h[s],[t]:a},j(h),g("items",h)}const A=r.reduce((s,t)=>{const a=parseInt(t.quantity)||0,h=parseFloat(t.unit_cost_price)||0,f=parseFloat(t.unit_selling_price)||0,$=a*h,x=a*f,N=x-$;return{totalCost:s.totalCost+$,totalSelling:s.totalSelling+x,grossProfit:s.grossProfit+N}},{totalCost:0,totalSelling:0,grossProfit:0}),L=parseFloat(S.transportation_cost)||0,ie=parseFloat(S.other_expenses)||0,te=L+ie,Q=A.grossProfit-te;function w(s){return`${parseFloat(s||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}return e.jsx(ve,{open:u,onOpenChange:o,children:e.jsxs(_e,{className:"max-h-[95vh] w-[95vw] max-w-none overflow-y-auto",children:[e.jsx(ye,{children:e.jsx(be,{children:"Add Trip Estimation"})}),e.jsxs("form",{onSubmit:H,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"trip_date",children:"Trip Date *"}),e.jsx(v,{id:"trip_date",type:"date",value:S.trip_date,onChange:s=>g("trip_date",s.target.value),required:!0}),i.trip_date&&e.jsx(p,{message:i.trip_date,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"description",children:"Description"}),e.jsx(v,{id:"description",placeholder:"e.g., Weekly stock purchase",value:S.description,onChange:s=>g("description",s.target.value)}),i.description&&e.jsx(p,{message:i.description,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"location",children:"Location"}),e.jsx(v,{id:"location",placeholder:"e.g., Kumasi Market",value:S.location,onChange:s=>g("location",s.target.value)}),i.location&&e.jsx(p,{message:i.location,className:"mt-1"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{className:"text-base font-semibold",children:"Products *"}),e.jsxs(P,{type:"button",variant:"outline",size:"sm",onClick:le,className:"h-8",children:[e.jsx(Se,{className:"mr-1 h-3 w-3"}),"Add Product"]})]}),r.map((s,t)=>{var D,Y,ne,re,ce,oe,de,me,xe,ue,pe,he;const a=parseInt(s.quantity)||0,h=parseFloat(s.unit_cost_price)||0,f=parseFloat(s.unit_selling_price)||0,$=a*h,N=a*f-$;return e.jsxs("div",{className:"rounded-lg border bg-white shadow-sm",children:[e.jsxs("div",{className:"block lg:hidden p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium text-gray-700",children:["Product ",t+1]}),e.jsx(P,{type:"button",variant:"outline",size:"sm",onClick:()=>W(t),disabled:r.length===1,className:"h-8 w-8 p-0 text-red-600 disabled:text-gray-400 disabled:cursor-not-allowed",children:e.jsx(ee,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Product *"}),e.jsxs(k,{value:s.product_name&&((Y=(D=c.find(n=>n.name===s.product_name))==null?void 0:D.id)==null?void 0:Y.toString())||"",onValueChange:n=>U(t,n),children:[e.jsx(q,{className:"mt-1",children:e.jsx(E,{placeholder:"Select a product"})}),e.jsx(F,{children:c.map(n=>e.jsx(I,{value:n.id.toString(),children:n.name},n.id))})]}),i[`items.${t}.product_name`]&&e.jsx(p,{message:i[`items.${t}.product_name`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Supplier"}),e.jsxs(k,{value:s.supplier_name&&((re=(ne=d.find(n=>n.name===s.supplier_name))==null?void 0:ne.id)==null?void 0:re.toString())||"",onValueChange:n=>{const l=d.find(T=>T.id==n);l&&_(t,"supplier_name",l.name)},children:[e.jsx(q,{className:"mt-1",children:e.jsx(E,{placeholder:"Select a supplier"})}),e.jsx(F,{children:d.map(n=>e.jsx(I,{value:n.id.toString(),children:n.name},n.id))})]}),i[`items.${t}.supplier_name`]&&e.jsx(p,{message:i[`items.${t}.supplier_name`],className:"mt-1"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Quantity"}),e.jsx(v,{type:"number",placeholder:"1",value:s.quantity,onChange:n=>_(t,"quantity",n.target.value),min:"1",required:!0,className:"mt-1 w-full text-center text-lg font-medium h-12"}),i[`items.${t}.quantity`]&&e.jsx(p,{message:i[`items.${t}.quantity`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Unit Cost (GHC)"}),e.jsx(v,{type:"number",step:"0.01",placeholder:"0.00",value:s.unit_cost_price,onChange:n=>_(t,"unit_cost_price",n.target.value),min:"0",required:!0,className:"mt-1"}),i[`items.${t}.unit_cost_price`]&&e.jsx(p,{message:i[`items.${t}.unit_cost_price`],className:"mt-1"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Total Cost"}),e.jsx("div",{className:"mt-1 flex h-10 w-full rounded-md border border-input bg-gray-50 px-3 py-2 text-sm text-gray-700 items-center",children:w($)})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Unit Selling (GHC)"}),e.jsx(v,{type:"number",step:"0.01",placeholder:"0.00",value:s.unit_selling_price,onChange:n=>_(t,"unit_selling_price",n.target.value),min:"0",required:!0,className:"mt-1"}),i[`items.${t}.unit_selling_price`]&&e.jsx(p,{message:i[`items.${t}.unit_selling_price`],className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Profit"}),e.jsxs("div",{className:`mt-1 flex h-16 w-full rounded-md border-2 py-3 text-lg font-bold items-center justify-center ${N>0?"bg-green-50 text-green-700 border-green-300":N<0?"bg-red-50 text-red-700 border-red-300":"bg-gray-50 text-gray-700 border-gray-300"}`,children:[N>0?"+":"",w(N)]})]})]})]}),e.jsxs("div",{className:"hidden xl:block xl:p-4 xl:space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Product *"}),e.jsxs(k,{value:s.product_name&&((oe=(ce=c.find(n=>n.name===s.product_name))==null?void 0:ce.id)==null?void 0:oe.toString())||"",onValueChange:n=>U(t,n),children:[e.jsx(q,{className:"w-full h-12",children:e.jsx(E,{placeholder:"Select a product"})}),e.jsx(F,{children:c.map(n=>e.jsx(I,{value:n.id.toString(),children:n.name},n.id))})]}),i[`items.${t}.product_name`]&&e.jsx(p,{message:i[`items.${t}.product_name`],className:"mt-1"})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Supplier"}),e.jsxs(k,{value:s.supplier_name&&((me=(de=d.find(n=>n.name===s.supplier_name))==null?void 0:de.id)==null?void 0:me.toString())||"",onValueChange:n=>{const l=d.find(T=>T.id==n);l&&_(t,"supplier_name",l.name)},children:[e.jsx(q,{className:"w-full h-12",children:e.jsx(E,{placeholder:"Select a supplier"})}),e.jsx(F,{children:d.map(n=>e.jsx(I,{value:n.id.toString(),children:n.name},n.id))})]}),i[`items.${t}.supplier_name`]&&e.jsx(p,{message:i[`items.${t}.supplier_name`],className:"mt-1"})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Profit"}),e.jsxs("div",{className:`inline-flex items-center justify-center px-4 py-2 rounded-lg text-xl font-bold h-12 ${N>0?"bg-green-100 text-green-800 border-2 border-green-300":N<0?"bg-red-100 text-red-800 border-2 border-red-300":"bg-gray-100 text-gray-800 border-2 border-gray-300"}`,children:[N>0?"+":"",w(N)]})]})})]}),e.jsxs("div",{className:"grid gap-4",style:{gridTemplateColumns:"1fr 1fr 1fr 40px"},children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Quantity"}),e.jsx(v,{type:"number",placeholder:"1",value:s.quantity,onChange:n=>_(t,"quantity",n.target.value),min:"1",required:!0,className:"text-center w-full text-lg font-bold h-12"}),i[`items.${t}.quantity`]&&e.jsx(p,{message:i[`items.${t}.quantity`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Unit Cost"}),e.jsx(v,{type:"number",step:"0.01",placeholder:"0.00",value:s.unit_cost_price,onChange:n=>_(t,"unit_cost_price",n.target.value),min:"0",required:!0,className:"w-full h-12"}),e.jsxs("div",{className:"text-center text-xs text-gray-600 mt-1",children:["Total: ",w(a*h)]}),i[`items.${t}.unit_cost_price`]&&e.jsx(p,{message:i[`items.${t}.unit_cost_price`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Unit Selling"}),e.jsx(v,{type:"number",step:"0.01",placeholder:"0.00",value:s.unit_selling_price,onChange:n=>_(t,"unit_selling_price",n.target.value),min:"0",required:!0,className:"w-full h-12"}),e.jsxs("div",{className:"text-center text-xs text-gray-600 mt-1",children:["Total: ",w(a*f)]}),i[`items.${t}.unit_selling_price`]&&e.jsx(p,{message:i[`items.${t}.unit_selling_price`],className:"mt-1"})]}),e.jsx("div",{className:"flex justify-center items-end h-12",children:e.jsx(ee,{className:`h-5 w-5 cursor-pointer transition-colors ${r.length===1?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-800"}`,onClick:()=>r.length>1&&W(t)})})]})]}),e.jsxs("div",{className:"hidden lg:block xl:hidden lg:p-3 lg:space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Product *"}),e.jsxs(k,{value:s.product_name&&((ue=(xe=c.find(n=>n.name===s.product_name))==null?void 0:xe.id)==null?void 0:ue.toString())||"",onValueChange:n=>U(t,n),children:[e.jsx(q,{className:"w-full h-10",children:e.jsx(E,{placeholder:"Select a product"})}),e.jsx(F,{children:c.map(n=>e.jsx(I,{value:n.id.toString(),children:n.name},n.id))})]}),i[`items.${t}.product_name`]&&e.jsx(p,{message:i[`items.${t}.product_name`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Supplier"}),e.jsxs(k,{value:s.supplier_name&&((he=(pe=d.find(n=>n.name===s.supplier_name))==null?void 0:pe.id)==null?void 0:he.toString())||"",onValueChange:n=>{const l=d.find(T=>T.id==n);l&&_(t,"supplier_name",l.name)},children:[e.jsx(q,{className:"w-full h-10",children:e.jsx(E,{placeholder:"Select a supplier"})}),e.jsx(F,{children:d.map(n=>e.jsx(I,{value:n.id.toString(),children:n.name},n.id))})]}),i[`items.${t}.supplier_name`]&&e.jsx(p,{message:i[`items.${t}.supplier_name`],className:"mt-1"})]}),e.jsx("div",{children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Profit"}),e.jsxs("div",{className:`inline-flex items-center justify-center px-3 py-2 rounded-lg text-base font-bold h-10 w-full ${N>0?"bg-green-100 text-green-800 border-2 border-green-300":N<0?"bg-red-100 text-red-800 border-2 border-red-300":"bg-gray-100 text-gray-800 border-2 border-gray-300"}`,children:[N>0?"+":"",w(N)]})]})})]}),e.jsxs("div",{className:"grid gap-3",style:{gridTemplateColumns:"1fr 1fr 1fr 32px"},children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Quantity"}),e.jsx(v,{type:"number",placeholder:"1",value:s.quantity,onChange:n=>_(t,"quantity",n.target.value),min:"1",required:!0,className:"text-center w-full text-base font-medium h-10"}),i[`items.${t}.quantity`]&&e.jsx(p,{message:i[`items.${t}.quantity`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Unit Cost"}),e.jsx(v,{type:"number",step:"0.01",placeholder:"0.00",value:s.unit_cost_price,onChange:n=>_(t,"unit_cost_price",n.target.value),min:"0",required:!0,className:"w-full h-10"}),e.jsx("div",{className:"text-center text-xs text-gray-600 mt-1",children:w(a*h)}),i[`items.${t}.unit_cost_price`]&&e.jsx(p,{message:i[`items.${t}.unit_cost_price`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Unit Selling"}),e.jsx(v,{type:"number",step:"0.01",placeholder:"0.00",value:s.unit_selling_price,onChange:n=>_(t,"unit_selling_price",n.target.value),min:"0",required:!0,className:"w-full h-10"}),e.jsx("div",{className:"text-center text-xs text-gray-600 mt-1",children:w(a*f)}),i[`items.${t}.unit_selling_price`]&&e.jsx(p,{message:i[`items.${t}.unit_selling_price`],className:"mt-1"})]}),e.jsx("div",{className:"flex justify-center items-end h-10",children:e.jsx(ee,{className:`h-4 w-4 cursor-pointer transition-colors ${r.length===1?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-800"}`,onClick:()=>r.length>1&&W(t)})})]})]})]},t)})]}),e.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[e.jsx(m,{className:"text-base font-semibold",children:"Trip Expenses"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"transportation_cost",children:"Transportation Cost (GHC)"}),e.jsx(v,{id:"transportation_cost",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:S.transportation_cost,onChange:s=>g("transportation_cost",s.target.value)}),i.transportation_cost&&e.jsx(p,{message:i.transportation_cost,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"other_expenses",children:"Other Expenses (GHC)"}),e.jsx(v,{id:"other_expenses",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:S.other_expenses,onChange:s=>g("other_expenses",s.target.value)}),i.other_expenses&&e.jsx(p,{message:i.other_expenses,className:"mt-1"})]})]})]}),e.jsxs("div",{className:"space-y-4 rounded-lg bg-blue-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-5 w-5 text-blue-600"}),e.jsx(m,{className:"text-base font-semibold text-blue-900",children:"Trip Summary"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Cost"}),e.jsx("div",{className:"text-lg font-semibold text-red-600",children:w(A.totalCost)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Selling"}),e.jsx("div",{className:"text-lg font-semibold text-green-600",children:w(A.totalSelling)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Gross Profit"}),e.jsx("div",{className:`text-lg font-semibold ${A.grossProfit>0?"text-green-600":A.grossProfit<0?"text-red-600":"text-gray-600"}`,children:w(A.grossProfit)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Expenses"}),e.jsx("div",{className:"text-lg font-semibold text-orange-600",children:w(te)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Net Profit"}),e.jsx("div",{className:`text-lg font-semibold ${Q>0?"text-green-600":Q<0?"text-red-600":"text-gray-600"}`,children:w(Q)})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"notes",children:"Notes"}),e.jsx(qe,{id:"notes",placeholder:"Additional notes about this trip",value:S.notes,onChange:s=>g("notes",s.target.value),rows:2}),i.notes&&e.jsx(p,{message:i.notes,className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(P,{type:"button",variant:"outline",onClick:z,children:"Cancel"}),e.jsx(P,{type:"submit",disabled:M,children:M?"Creating...":"Create Trip Estimation"})]})]})]})})}function Qt({isOpen:u,onClose:o,trip:c,products:d=[],suppliers:i=[],errors:r={}}){const[j,S]=C.useState([]),{data:g,setData:b,put:M,processing:R,reset:y,clearErrors:H}=$e({trip_date:"",description:"",location:"",transportation_cost:"",other_expenses:"",notes:"",items:[]});C.useEffect(()=>{if(c&&u){const a=new Date(c.trip_date).toISOString().split("T")[0],h=c.items||[{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}];S(h),b({trip_date:a,description:c.description||"",location:c.location||"",transportation_cost:c.transportation_cost||"",other_expenses:c.other_expenses||"",notes:c.notes||"",items:h}),H()}},[c,u,H]);function z(t){t.preventDefault(),c&&(b({...g,items:j}),M(route("trip-estimations.update",c.id),{onSuccess:()=>{y(),H(),o()},preserveScroll:!0,preserveState:!0,only:["trips","overview","errors","flash"]}))}function le(){y(),H(),S([]),o()}function W(){const t=[...j,{product_name:"",supplier_name:"",quantity:1,unit_cost_price:0,unit_selling_price:0}];S(t),b("items",t)}function U(t){if(j.length>1){const a=j.filter((h,f)=>f!==t);S(a),b("items",a)}}function _(t,a,h){const f=[...j];f[t]={...f[t],[a]:h},S(f),b("items",f)}function A(t,a){const h=d.find(f=>f.id==a);if(h){const f=[...j];f[t]={...f[t],product_name:h.name},S(f),b("items",f)}}if(!c)return null;const L=j.reduce((t,a)=>{const h=parseInt(a.quantity)||0,f=parseFloat(a.unit_cost_price)||0,$=parseFloat(a.unit_selling_price)||0,x=h*f,N=h*$,D=N-x;return{totalCost:t.totalCost+x,totalSelling:t.totalSelling+N,grossProfit:t.grossProfit+D}},{totalCost:0,totalSelling:0,grossProfit:0}),ie=parseFloat(g.transportation_cost)||0,te=parseFloat(g.other_expenses)||0,Q=ie+te,w=L.grossProfit-Q;function s(t){return`${parseFloat(t||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}return e.jsx(ve,{open:u,onOpenChange:o,children:e.jsxs(_e,{className:"max-h-[95vh] w-[95vw] max-w-none overflow-y-auto",children:[e.jsx(ye,{children:e.jsx(be,{children:"Edit Trip Estimation"})}),e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"trip_date",children:"Trip Date *"}),e.jsx(v,{id:"trip_date",type:"date",value:g.trip_date,onChange:t=>b("trip_date",t.target.value),required:!0}),r.trip_date&&e.jsx(p,{message:r.trip_date,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"description",children:"Description"}),e.jsx(v,{id:"description",placeholder:"e.g., Weekly stock purchase",value:g.description,onChange:t=>b("description",t.target.value)}),r.description&&e.jsx(p,{message:r.description,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"location",children:"Location"}),e.jsx(v,{id:"location",placeholder:"e.g., Kumasi Market",value:g.location,onChange:t=>b("location",t.target.value)}),r.location&&e.jsx(p,{message:r.location,className:"mt-1"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{className:"text-base font-semibold",children:"Products *"}),e.jsxs(P,{type:"button",variant:"outline",size:"sm",onClick:W,className:"h-8",children:[e.jsx(Se,{className:"mr-1 h-3 w-3"}),"Add Product"]})]}),j.map((t,a)=>{var Y,ne,re,ce,oe,de,me,xe,ue,pe,he,n;const h=parseInt(t.quantity)||0,f=parseFloat(t.unit_cost_price)||0,$=parseFloat(t.unit_selling_price)||0,x=h*f,D=h*$-x;return e.jsxs("div",{className:"rounded-lg border bg-white shadow-sm",children:[e.jsxs("div",{className:"block lg:hidden p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium text-gray-700",children:["Product ",a+1]}),e.jsx(P,{type:"button",variant:"outline",size:"sm",onClick:()=>U(a),disabled:j.length===1,className:"h-8 w-8 p-0 text-red-600 disabled:text-gray-400 disabled:cursor-not-allowed",children:e.jsx(ee,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Product *"}),e.jsxs(k,{value:t.product_name&&((ne=(Y=d.find(l=>l.name===t.product_name))==null?void 0:Y.id)==null?void 0:ne.toString())||"",onValueChange:l=>A(a,l),children:[e.jsx(q,{className:"mt-1",children:e.jsx(E,{placeholder:"Select a product"})}),e.jsx(F,{children:d.map(l=>e.jsx(I,{value:l.id.toString(),children:l.name},l.id))})]}),r[`items.${a}.product_name`]&&e.jsx(p,{message:r[`items.${a}.product_name`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Supplier"}),e.jsxs(k,{value:t.supplier_name&&((ce=(re=i.find(l=>l.name===t.supplier_name))==null?void 0:re.id)==null?void 0:ce.toString())||"",onValueChange:l=>{const T=i.find(ge=>ge.id==l);T&&_(a,"supplier_name",T.name)},children:[e.jsx(q,{className:"mt-1",children:e.jsx(E,{placeholder:"Select a supplier"})}),e.jsx(F,{children:i.map(l=>e.jsx(I,{value:l.id.toString(),children:l.name},l.id))})]}),r[`items.${a}.supplier_name`]&&e.jsx(p,{message:r[`items.${a}.supplier_name`],className:"mt-1"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Quantity"}),e.jsx(v,{type:"number",placeholder:"1",value:t.quantity,onChange:l=>_(a,"quantity",l.target.value),min:"1",required:!0,className:"mt-1 w-full text-center text-lg font-medium h-12"}),r[`items.${a}.quantity`]&&e.jsx(p,{message:r[`items.${a}.quantity`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Unit Cost (GHC)"}),e.jsx(v,{type:"number",step:"0.01",placeholder:"0.00",value:t.unit_cost_price,onChange:l=>_(a,"unit_cost_price",l.target.value),min:"0",required:!0,className:"mt-1"}),r[`items.${a}.unit_cost_price`]&&e.jsx(p,{message:r[`items.${a}.unit_cost_price`],className:"mt-1"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Total Cost"}),e.jsx("div",{className:"mt-1 flex h-10 w-full rounded-md border border-input bg-gray-50 px-3 py-2 text-sm text-gray-700 items-center",children:s(x)})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Unit Selling (GHC)"}),e.jsx(v,{type:"number",step:"0.01",placeholder:"0.00",value:t.unit_selling_price,onChange:l=>_(a,"unit_selling_price",l.target.value),min:"0",required:!0,className:"mt-1"}),r[`items.${a}.unit_selling_price`]&&e.jsx(p,{message:r[`items.${a}.unit_selling_price`],className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium",children:"Profit"}),e.jsxs("div",{className:`mt-1 flex h-16 w-full rounded-md border-2 px-4 py-3 text-lg font-bold items-center justify-center ${D>0?"bg-green-50 text-green-700 border-green-300":D<0?"bg-red-50 text-red-700 border-red-300":"bg-gray-50 text-gray-700 border-gray-300"}`,children:[D>0?"+":"",s(D)]})]})]})]}),e.jsxs("div",{className:"hidden xl:block xl:p-4 xl:space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Product *"}),e.jsxs(k,{value:t.product_name&&((de=(oe=d.find(l=>l.name===t.product_name))==null?void 0:oe.id)==null?void 0:de.toString())||"",onValueChange:l=>A(a,l),children:[e.jsx(q,{className:"w-full h-12",children:e.jsx(E,{placeholder:"Select a product"})}),e.jsx(F,{children:d.map(l=>e.jsx(I,{value:l.id.toString(),children:l.name},l.id))})]}),r[`items.${a}.product_name`]&&e.jsx(p,{message:r[`items.${a}.product_name`],className:"mt-1"})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Supplier"}),e.jsxs(k,{value:t.supplier_name&&((xe=(me=i.find(l=>l.name===t.supplier_name))==null?void 0:me.id)==null?void 0:xe.toString())||"",onValueChange:l=>{const T=i.find(ge=>ge.id==l);T&&_(a,"supplier_name",T.name)},children:[e.jsx(q,{className:"w-full h-12",children:e.jsx(E,{placeholder:"Select a supplier"})}),e.jsx(F,{children:i.map(l=>e.jsx(I,{value:l.id.toString(),children:l.name},l.id))})]}),r[`items.${a}.supplier_name`]&&e.jsx(p,{message:r[`items.${a}.supplier_name`],className:"mt-1"})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Profit"}),e.jsxs("div",{className:`inline-flex items-center justify-center px-4 py-2 rounded-lg text-xl font-bold h-12 ${D>0?"bg-green-100 text-green-800 border-2 border-green-300":D<0?"bg-red-100 text-red-800 border-2 border-red-300":"bg-gray-100 text-gray-800 border-2 border-gray-300"}`,children:[D>0?"+":"",s(D)]})]})})]}),e.jsxs("div",{className:"grid gap-4",style:{gridTemplateColumns:"1fr 1fr 1fr 40px"},children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Quantity"}),e.jsx(v,{type:"number",placeholder:"1",value:t.quantity,onChange:l=>_(a,"quantity",l.target.value),min:"1",required:!0,className:"text-center w-full text-lg font-bold h-12"}),r[`items.${a}.quantity`]&&e.jsx(p,{message:r[`items.${a}.quantity`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Unit Cost"}),e.jsx(v,{type:"number",step:"0.01",placeholder:"0.00",value:t.unit_cost_price,onChange:l=>_(a,"unit_cost_price",l.target.value),min:"0",required:!0,className:"w-full h-12"}),e.jsxs("div",{className:"text-center text-xs text-gray-600 mt-1",children:["Total: ",s(h*f)]}),r[`items.${a}.unit_cost_price`]&&e.jsx(p,{message:r[`items.${a}.unit_cost_price`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Unit Selling"}),e.jsx(v,{type:"number",step:"0.01",placeholder:"0.00",value:t.unit_selling_price,onChange:l=>_(a,"unit_selling_price",l.target.value),min:"0",required:!0,className:"w-full h-12"}),e.jsxs("div",{className:"text-center text-xs text-gray-600 mt-1",children:["Total: ",s(h*$)]}),r[`items.${a}.unit_selling_price`]&&e.jsx(p,{message:r[`items.${a}.unit_selling_price`],className:"mt-1"})]}),e.jsx("div",{className:"flex justify-center items-end h-12",children:e.jsx(ee,{className:`h-5 w-5 cursor-pointer transition-colors ${j.length===1?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-800"}`,onClick:()=>j.length>1&&U(a)})})]})]}),e.jsxs("div",{className:"hidden lg:block xl:hidden lg:p-3 lg:space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Product *"}),e.jsxs(k,{value:t.product_name&&((pe=(ue=d.find(l=>l.name===t.product_name))==null?void 0:ue.id)==null?void 0:pe.toString())||"",onValueChange:l=>A(a,l),children:[e.jsx(q,{className:"w-full h-10",children:e.jsx(E,{placeholder:"Select a product"})}),e.jsx(F,{children:d.map(l=>e.jsx(I,{value:l.id.toString(),children:l.name},l.id))})]}),r[`items.${a}.product_name`]&&e.jsx(p,{message:r[`items.${a}.product_name`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Supplier"}),e.jsxs(k,{value:t.supplier_name&&((n=(he=i.find(l=>l.name===t.supplier_name))==null?void 0:he.id)==null?void 0:n.toString())||"",onValueChange:l=>{const T=i.find(ge=>ge.id==l);T&&_(a,"supplier_name",T.name)},children:[e.jsx(q,{className:"w-full h-10",children:e.jsx(E,{placeholder:"Select a supplier"})}),e.jsx(F,{children:i.map(l=>e.jsx(I,{value:l.id.toString(),children:l.name},l.id))})]}),r[`items.${a}.supplier_name`]&&e.jsx(p,{message:r[`items.${a}.supplier_name`],className:"mt-1"})]}),e.jsx("div",{children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Profit"}),e.jsxs("div",{className:`inline-flex items-center justify-center px-3 py-2 rounded-lg text-base font-bold h-10 w-full ${D>0?"bg-green-100 text-green-800 border-2 border-green-300":D<0?"bg-red-100 text-red-800 border-2 border-red-300":"bg-gray-100 text-gray-800 border-2 border-gray-300"}`,children:[D>0?"+":"",s(D)]})]})})]}),e.jsxs("div",{className:"grid gap-3",style:{gridTemplateColumns:"1fr 1fr 1fr 32px"},children:[e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Quantity"}),e.jsx(v,{type:"number",placeholder:"1",value:t.quantity,onChange:l=>_(a,"quantity",l.target.value),min:"1",required:!0,className:"text-center w-full text-base font-medium h-10"}),r[`items.${a}.quantity`]&&e.jsx(p,{message:r[`items.${a}.quantity`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Unit Cost"}),e.jsx(v,{type:"number",step:"0.01",placeholder:"0.00",value:t.unit_cost_price,onChange:l=>_(a,"unit_cost_price",l.target.value),min:"0",required:!0,className:"w-full h-10"}),e.jsx("div",{className:"text-center text-xs text-gray-600 mt-1",children:s(h*f)}),r[`items.${a}.unit_cost_price`]&&e.jsx(p,{message:r[`items.${a}.unit_cost_price`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{className:"text-sm font-medium mb-2 block",children:"Unit Selling"}),e.jsx(v,{type:"number",step:"0.01",placeholder:"0.00",value:t.unit_selling_price,onChange:l=>_(a,"unit_selling_price",l.target.value),min:"0",required:!0,className:"w-full h-10"}),e.jsx("div",{className:"text-center text-xs text-gray-600 mt-1",children:s(h*$)}),r[`items.${a}.unit_selling_price`]&&e.jsx(p,{message:r[`items.${a}.unit_selling_price`],className:"mt-1"})]}),e.jsx("div",{className:"flex justify-center items-end h-10",children:e.jsx(ee,{className:`h-4 w-4 cursor-pointer transition-colors ${j.length===1?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-800"}`,onClick:()=>j.length>1&&U(a)})})]})]})]},a)})]}),e.jsxs("div",{className:"space-y-4 rounded-lg border p-4",children:[e.jsx(m,{className:"text-base font-semibold",children:"Trip Expenses"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"transportation_cost",children:"Transportation Cost (GHC)"}),e.jsx(v,{id:"transportation_cost",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:g.transportation_cost,onChange:t=>b("transportation_cost",t.target.value)}),r.transportation_cost&&e.jsx(p,{message:r.transportation_cost,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"other_expenses",children:"Other Expenses (GHC)"}),e.jsx(v,{id:"other_expenses",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:g.other_expenses,onChange:t=>b("other_expenses",t.target.value)}),r.other_expenses&&e.jsx(p,{message:r.other_expenses,className:"mt-1"})]})]})]}),e.jsxs("div",{className:"space-y-4 rounded-lg bg-blue-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-5 w-5 text-blue-600"}),e.jsx(m,{className:"text-base font-semibold text-blue-900",children:"Trip Summary"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Cost"}),e.jsx("div",{className:"text-lg font-semibold text-red-600",children:s(L.totalCost)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Selling"}),e.jsx("div",{className:"text-lg font-semibold text-green-600",children:s(L.totalSelling)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Gross Profit"}),e.jsx("div",{className:`text-lg font-semibold ${L.grossProfit>0?"text-green-600":L.grossProfit<0?"text-red-600":"text-gray-600"}`,children:s(L.grossProfit)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Expenses"}),e.jsx("div",{className:"text-lg font-semibold text-orange-600",children:s(Q)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Net Profit"}),e.jsx("div",{className:`text-lg font-semibold ${w>0?"text-green-600":w<0?"text-red-600":"text-gray-600"}`,children:s(w)})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"notes",children:"Notes"}),e.jsx(qe,{id:"notes",placeholder:"Additional notes about this trip",value:g.notes,onChange:t=>b("notes",t.target.value),rows:2}),r.notes&&e.jsx(p,{message:r.notes,className:"mt-1"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(P,{type:"button",variant:"outline",onClick:le,children:"Cancel"}),e.jsx(P,{type:"submit",disabled:R,children:R?"Updating...":"Update Trip Estimation"})]})]})]})})}function ps({trips:u=[],overview:o={},start_date:c="",end_date:d="",products:i=[],suppliers:r=[]}){var a,h,f,$;const[j,S]=C.useState(!1),[g,b]=C.useState(null),[M,R]=C.useState(null),[y,H]=C.useState(null),z=new Date,le=new Date(z.getFullYear(),z.getMonth(),1).toISOString().slice(0,10),W=new Date(z.getFullYear(),z.getMonth()+1,0).toISOString().slice(0,10),[U,_]=C.useState(c||le),[A,L]=C.useState(d||W),ie=(x,N)=>{const D=N==="start"?x:U,Y=N==="end"?x:A;N==="start"&&_(x),N==="end"&&L(x),we.get(route("trip-estimations.index"),{start_date:D,end_date:Y,page:1},{preserveState:!0,preserveScroll:!0,replace:!0})};function te(x){b(x)}function Q(){M&&we.delete(route("trip-estimations.destroy",M.id),{preserveScroll:!0,preserveState:!0,only:["trips","overview","errors","flash"],onSuccess:()=>R(null)})}function w(x){H(x)}function s(x){return`GHC ${parseFloat(x||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function t(x){const N=parseFloat(x||0);return N>0?"text-green-600":N<0?"text-red-600":"text-gray-600"}return e.jsx(Be,{breadcrumbs:[{title:"Trip Profit Estimator",href:"/trip-estimations"}],children:e.jsxs("div",{className:"min-h-screen space-y-6 bg-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Trip Profit Estimator"}),e.jsxs(P,{onClick:()=>S(!0),className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"}),"Add Trip"]})]}),e.jsx(Ye,{startDate:U,endDate:A,onChange:ie}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(K,{children:[e.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(X,{className:"text-sm font-medium",children:"Total Trips"}),e.jsx(We,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Z,{children:e.jsx("div",{className:"text-2xl font-bold",children:o.total_trips||0})})]}),e.jsxs(K,{children:[e.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(X,{className:"text-sm font-medium",children:"Total Selling Price"}),e.jsx(fe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Z,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:s(o.total_selling_price)})})]}),e.jsxs(K,{children:[e.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(X,{className:"text-sm font-medium",children:"Total Cost Price"}),e.jsx(fe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Z,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:s(o.total_cost_price)})})]}),e.jsxs(K,{children:[e.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(X,{className:"text-sm font-medium",children:"Gross Profit"}),e.jsx(De,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Z,{children:e.jsx("div",{className:`text-2xl font-bold ${t(o.total_gross_profit)}`,children:s(o.total_gross_profit)})})]}),e.jsxs(K,{children:[e.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(X,{className:"text-sm font-medium",children:"Total Expenses"}),e.jsx(fe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Z,{children:e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:s(o.total_expenses)})})]}),e.jsxs(K,{children:[e.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(X,{className:"text-sm font-medium",children:"Net Profit"}),e.jsx(De,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(Z,{children:e.jsx("div",{className:`text-2xl font-bold ${t(o.total_net_profit)}`,children:s(o.total_net_profit)})})]})]}),e.jsxs(K,{children:[e.jsx(J,{children:e.jsx(X,{children:"Trip Estimations"})}),e.jsxs(Z,{children:[e.jsxs(Xe,{children:[e.jsx(Ze,{children:e.jsxs(je,{children:[e.jsx(G,{children:"Date"}),e.jsx(G,{children:"Description"}),e.jsx(G,{children:"Location"}),e.jsx(G,{children:"Items"}),e.jsx(G,{className:"text-right",children:"Cost Price"}),e.jsx(G,{className:"text-right",children:"Selling Price"}),e.jsx(G,{className:"text-right",children:"Gross Profit"}),e.jsx(G,{className:"text-right",children:"Expenses"}),e.jsx(G,{className:"text-right",children:"Net Profit"}),e.jsx(G,{className:"text-center",children:"Actions"})]})}),e.jsx(et,{children:((a=u.data)==null?void 0:a.length)>0?u.data.map(x=>e.jsxs(je,{children:[e.jsx(O,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(mt,{className:"h-4 w-4 text-gray-400"}),x.trip_date]})}),e.jsx(O,{children:x.description||"-"}),e.jsx(O,{children:x.location||"-"}),e.jsx(O,{children:e.jsxs(Je,{variant:"secondary",children:[x.items_count," items"]})}),e.jsx(O,{className:"text-right font-mono",children:s(x.total_cost_price)}),e.jsx(O,{className:"text-right font-mono",children:s(x.total_selling_price)}),e.jsx(O,{className:`text-right font-mono ${t(x.gross_profit)}`,children:s(x.gross_profit)}),e.jsx(O,{className:"text-right font-mono",children:s(x.total_expenses)}),e.jsx(O,{className:`text-right font-mono ${t(x.net_profit)}`,children:s(x.net_profit)}),e.jsx(O,{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>w(x),children:e.jsx(pt,{className:"h-3 w-3"})}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>te(x),children:e.jsx(gt,{className:"h-3 w-3"})}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>R(x),className:"text-red-600 hover:text-red-700",children:e.jsx(ee,{className:"h-3 w-3"})})]})})]},x.id)):e.jsx(je,{children:e.jsxs(O,{colSpan:10,className:"text-center py-8 text-gray-500",children:["No trip estimations found for the selected period.",e.jsx("br",{}),e.jsx(P,{variant:"link",onClick:()=>S(!0),className:"mt-2",children:"Add your first trip estimation"})]})})})]}),((h=u.data)==null?void 0:h.length)===0?e.jsx("div",{className:"text-muted-foreground py-8 text-center",children:"No trip estimations found for the selected period."}):e.jsxs("div",{className:"my-3 flex items-center justify-center gap-4",children:[u.prev_page_url&&e.jsx(Ce,{preserveScroll:!0,preserveState:!0,href:u.prev_page_url,className:"rounded border px-4 py-2 hover:bg-gray-100",children:"« Previous"}),e.jsxs("span",{className:"px-4 py-2 font-medium",children:["Page ",u.current_page]}),u.next_page_url&&e.jsx(Ce,{preserveScroll:!0,preserveState:!0,href:u.next_page_url,className:"rounded border px-4 py-2 hover:bg-gray-100",children:"Next »"})]})]})]}),e.jsx(zt,{isOpen:j,onClose:()=>S(!1),products:i,suppliers:r}),g&&e.jsx(Qt,{isOpen:!!g,onClose:()=>b(null),trip:g,products:i,suppliers:r}),y&&e.jsx(ve,{open:!!y,onOpenChange:()=>H(null),children:e.jsxs(_e,{className:"max-h-[90vh] max-w-3xl overflow-y-auto",children:[e.jsx(ye,{children:e.jsx(be,{children:"Trip Details"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Trip Date"}),e.jsx("div",{className:"font-medium",children:y.trip_date})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Location"}),e.jsx("div",{className:"font-medium",children:y.location||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Description"}),e.jsx("div",{className:"font-medium",children:y.description||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Notes"}),e.jsx("div",{className:"font-medium whitespace-pre-wrap",children:y.notes||"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Cost"}),e.jsx("div",{className:"font-mono",children:s(y.total_cost_price)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Selling"}),e.jsx("div",{className:"font-mono",children:s(y.total_selling_price)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Gross Profit"}),e.jsx("div",{className:`font-mono ${t(y.gross_profit)}`,children:s(y.gross_profit)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Expenses"}),e.jsx("div",{className:"font-mono",children:s(y.total_expenses)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Net Profit"}),e.jsx("div",{className:`font-mono ${t(y.net_profit)}`,children:s(y.net_profit)})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold text-blue-900 mb-2",children:["Items (",((f=y.items)==null?void 0:f.length)||0,")"]}),e.jsx("div",{className:"space-y-2",children:($=y.items)!=null&&$.length?y.items.map((x,N)=>e.jsxs("div",{className:"flex flex-wrap gap-4 p-3 bg-gray-50 rounded border",children:[e.jsxs("div",{className:"min-w-[120px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Product"}),e.jsx("div",{className:"font-medium",children:x.product_name})]}),e.jsxs("div",{className:"min-w-[120px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Supplier"}),e.jsx("div",{className:"font-medium",children:x.supplier_name||"-"})]}),e.jsxs("div",{className:"min-w-[60px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Qty"}),e.jsx("div",{className:"font-mono",children:x.quantity})]}),e.jsxs("div",{className:"min-w-[100px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Unit Prices"}),e.jsxs("div",{className:"font-mono text-xs",children:["Cost: ",Number(x.unit_cost_price).toLocaleString("en-US",{minimumFractionDigits:2}),e.jsx("br",{}),"Sell: ",Number(x.unit_selling_price).toLocaleString("en-US",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"min-w-[100px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Total Cost"}),e.jsx("div",{className:"font-mono text-xs",children:Number(x.unit_cost_price*x.quantity).toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{className:"min-w-[100px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Total Selling"}),e.jsx("div",{className:"font-mono text-xs",children:Number(x.unit_selling_price*x.quantity).toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{className:"min-w-[100px]",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Profit (GHC)"}),e.jsx("div",{className:"font-mono text-green-600 font-bold",children:Number((parseFloat(x.unit_selling_price||0)-parseFloat(x.unit_cost_price||0))*parseFloat(x.quantity||0)).toLocaleString("en-US",{minimumFractionDigits:2})})]})]},N)):e.jsx("div",{className:"text-gray-500 text-sm",children:"No items found."})})]})]})]})}),e.jsx(Ft,{open:!!M,onOpenChange:()=>R(null),children:e.jsxs(Rt,{children:[e.jsxs(Ot,{children:[e.jsx(Lt,{children:"Delete Trip Estimation"}),e.jsx(Gt,{children:"Are you sure you want to delete this trip estimation? This action cannot be undone."})]}),e.jsxs(Ut,{children:[e.jsx(Vt,{children:"Cancel"}),e.jsx(Ht,{onClick:Q,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]})})}export{ps as default};
