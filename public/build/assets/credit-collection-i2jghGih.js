import{r as b,u as R,j as e}from"./app-DUtXgMsJ.js";import{I as N}from"./InputError-Cf5EZXwu.js";import{B as k}from"./badge-B5uS_jRX.js";import{c as q,F as _}from"./createLucideIcon-BsyMmKAN.js";import{C as d,a as i,b as m,c as x}from"./card-DCpXWH4X.js";import{D as E,b as M,c as V,d as Q}from"./dialog-B-hHNItd.js";import{I as h}from"./input-BogF8VYv.js";import{L as j}from"./label-DoXehEub.js";import{S as W,a as z,b as J,c as K,d as U}from"./select-CnJ-pvUd.js";import{T as F,a as S,b as c,c as t,d as w,e as a}from"./table-BYGLCm-c.js";import{A as X}from"./app-layout-CfGcrLHe.js";import{T}from"./triangle-alert-D4niRQkn.js";import"./index-lI6q_VJN.js";import"./index-CvWcqQt7.js";import"./index-CnUM9vPo.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],Z=q("Wallet",Y);function je({credit_collections:u=[],outstanding_debts:p=[],customers:D=[]}){const[H,g]=b.useState(!1),[f,O]=b.useState(""),G=p.filter(s=>s.customer.toLowerCase().includes(f.toLowerCase())),{data:o,setData:n,post:A,processing:y,errors:r,reset:I}=R({customer_id:"",amount_collected:"",payment_date:new Date().toISOString().split("T")[0],notes:""}),L=[{title:"Credit Collection",href:"/credit-collection"}];function B(s){n({customer_id:s.customer_id,amount_collected:"",payment_date:new Date().toISOString().split("T")[0],notes:""}),g(!0)}function P(s){s.preventDefault(),A(route("credit-collection.store"),{onSuccess:()=>{I(),g(!1)},preserveScroll:!0})}const C=u.reduce((s,l)=>s+parseFloat(l.amount_collected),0),v=p.reduce((s,l)=>s+parseFloat(l.balance),0);return e.jsx(X,{breadcrumbs:L,children:e.jsxs("div",{className:"min-h-screen space-y-6 bg-gray-100 p-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Credit Collection & Debt Management"})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs(d,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Collections Today"}),e.jsx(Z,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(x,{children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["GH₵",C.toFixed(2)]}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:["From ",u.length," customers"]})]})]}),e.jsxs(d,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Total Outstanding"}),e.jsx(T,{className:"h-4 w-4 text-orange-600"})]}),e.jsxs(x,{children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:["GH₵",v.toFixed(2)]}),e.jsxs("p",{className:"text-muted-foreground text-xs",children:[p.length," customers"]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:e.jsxs(d,{children:[e.jsx(i,{children:e.jsx(m,{children:"Amount Collected from Creditors (Today's Payments)"})}),e.jsx(x,{children:e.jsxs(F,{children:[e.jsx(S,{children:e.jsxs(c,{children:[e.jsx(t,{children:"Customer Name"}),e.jsx(t,{children:"Amount Collected"}),e.jsx(t,{children:"Payment Date"})]})}),e.jsxs(w,{children:[u.map((s,l)=>e.jsxs(c,{children:[e.jsx(a,{className:"font-medium",children:s.customer}),e.jsxs(a,{className:"font-medium text-green-600",children:["GH₵",parseFloat(s.amount_collected).toFixed(2)]}),e.jsx(a,{className:"text-gray-600",children:s.payment_date})]},l)),e.jsxs(c,{className:"bg-green-50",children:[e.jsx(a,{className:"font-bold",children:"Total Collected"}),e.jsxs(a,{className:"font-bold text-green-600",children:["GH₵",C.toFixed(2)]}),e.jsx(a,{})]})]})]})})]})}),e.jsxs(d,{children:[e.jsxs(i,{className:"flex flex-col space-y-4",children:[e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5 text-orange-600"}),"Outstanding Customer Debts"]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(h,{placeholder:"Search customers...",value:f,onChange:s=>O(s.target.value),className:"max-w-sm"})})]}),e.jsx(x,{children:e.jsxs(F,{children:[e.jsx(S,{children:e.jsxs(c,{children:[e.jsx(t,{children:"Customer Name"}),e.jsx(t,{children:"Total Debt"}),e.jsx(t,{children:"Amount Paid"}),e.jsx(t,{children:"Outstanding Balance"}),e.jsx(t,{children:"Last Payment"}),e.jsx(t,{children:"Days Overdue"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Actions"})]})}),e.jsxs(w,{children:[G.map((s,l)=>e.jsxs(c,{children:[e.jsx(a,{className:"font-medium",children:s.customer}),e.jsxs(a,{children:["GH₵",parseFloat(s.total_debt).toFixed(2)]}),e.jsxs(a,{className:"text-green-600",children:["GH₵",parseFloat(s.amount_paid).toFixed(2)]}),e.jsxs(a,{className:"font-medium text-orange-600",children:["GH₵",parseFloat(s.balance).toFixed(2)]}),e.jsx(a,{children:s.last_payment}),e.jsxs(a,{className:s.days_overdue>14?"font-medium text-red-600":"text-orange-600",children:[s.days_overdue," days"]}),e.jsx(a,{children:e.jsx(k,{className:s.days_overdue>14?"bg-red-600 text-white hover:bg-red-700":"bg-orange-600 text-white hover:bg-orange-700",children:s.days_overdue>14?"Critical":"Overdue"})}),e.jsx(a,{children:e.jsx(_,{variant:"outline",size:"sm",onClick:()=>B(s),children:"Collect"})})]},l)),e.jsxs(c,{className:"bg-orange-50",children:[e.jsx(a,{colSpan:3,className:"font-bold",children:"Total Outstanding"}),e.jsxs(a,{className:"font-bold text-orange-600",children:["GH₵",v.toFixed(2)]}),e.jsx(a,{colSpan:4})]})]})]})})]}),e.jsx(E,{open:H,onOpenChange:g,children:e.jsxs(M,{className:"sm:max-w-[425px]",children:[e.jsx(V,{children:e.jsx(Q,{children:"Record Credit Collection"})}),e.jsxs("form",{onSubmit:P,className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(j,{htmlFor:"customer",className:"text-right",children:"Customer"}),e.jsxs(W,{value:o.customer_id,onValueChange:s=>n("customer_id",s),disabled:!0,children:[e.jsx(z,{className:"col-span-3",children:e.jsx(J,{placeholder:"Select customer"})}),e.jsx(K,{children:D.map(s=>e.jsx(U,{value:s.id,children:s.name},s.id))})]}),r.customer_id&&e.jsx(N,{message:r.customer_id,className:"mt-2"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(j,{htmlFor:"amount",className:"text-right",children:"Amount (GH₵)"}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(h,{id:"amount",type:"number",className:"w-full",placeholder:"0.00",value:o.amount_collected,onChange:s=>n("amount_collected",s.target.value),required:!0}),r.amount_collected&&e.jsx(N,{message:r.amount_collected,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(j,{htmlFor:"payment_date",className:"text-right",children:"Payment Date"}),e.jsxs("div",{className:"col-span-3",children:[e.jsx(h,{id:"payment_date",type:"date",className:"w-full",value:o.payment_date,onChange:s=>n("payment_date",s.target.value),required:!0}),r.payment_date&&e.jsx(N,{message:r.payment_date,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(j,{htmlFor:"notes",className:"text-right",children:"Notes"}),e.jsx("div",{className:"col-span-3",children:e.jsx(h,{id:"notes",placeholder:"Optional notes",value:o.notes,onChange:s=>n("notes",s.target.value)})})]}),e.jsx(_,{type:"submit",disabled:y,children:y?"Recording...":"Record Collection"})]})]})})]})})}export{je as default};
