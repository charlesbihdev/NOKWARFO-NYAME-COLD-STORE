import{u as k,r as g,j as e,b as R,L as T,a as w}from"./app-jGLXoZvw.js";import{B as L,A as M}from"./app-layout-Dg9rn6sB.js";import{D as G}from"./DateRangePicker-DE_aGtvL.js";import{F as p}from"./createLucideIcon-B8S0lRyn.js";import{D as F,a as U,b as B,c as A,d as O}from"./dialog-DXwLAFTY.js";import{I as h}from"./index-GbGB8ENB.js";import{L as m}from"./label-BSw2AgNI.js";import{S as V,a as Y,b as z,c as q,d as J}from"./select-DgEHjFrB.js";import{C as K,a as Q,b as W,c as X}from"./card-CqBp3kC8.js";import{T as Z,a as $,b as D,c as x,d as ee,e as i}from"./table-mMKcwbH3.js";import{T as ae}from"./trash-2-D4Eygqjp.js";import"./index-DbNPUeHE.js";import"./index-BLLXiH5O.js";import"./index-B6ioFcQP.js";function te({tags:l,lastBalance:n,isOpen:d,setIsOpen:c}){const{data:r,setData:a,post:o,processing:u,errors:t,reset:j}=k({date:new Date().toISOString().split("T")[0],previous_balance:n.toString(),credit:"0",total_balance:n.toString(),debit:"0",tag_id:"",current_balance:n.toString(),notes:""});g.useEffect(()=>{a(s=>({...s,previous_balance:n.toString(),total_balance:n.toString(),current_balance:n.toString()}))},[n]),g.useEffect(()=>{const s=parseFloat(r.previous_balance)||0,v=parseFloat(r.credit)||0,S=parseFloat(r.debit)||0,b=s+v,y=b-S;a(C=>({...C,total_balance:b.toFixed(2),current_balance:y.toFixed(2)}))},[r.previous_balance,r.credit,r.debit]);function _(s){s.preventDefault(),o(route("bank-transfers.store"),{preserveScroll:!0,preserveState:!0,only:["bank_transfers","last_balance","errors","flash"],onSuccess:()=>{j(),c(!1)}})}return e.jsxs(F,{open:d,onOpenChange:c,children:[e.jsx(U,{asChild:!0,children:e.jsx(p,{children:"Record Transfer"})}),e.jsxs(B,{className:"max-h-[96vh] max-w-2xl overflow-y-auto",children:[e.jsx(A,{children:e.jsx(O,{children:"Record Bank Transfer"})}),e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"date",children:"Date"}),e.jsx(h,{id:"date",type:"date",value:r.date,onChange:s=>a("date",s.target.value)}),t.date&&e.jsx("div",{className:"text-sm text-red-500",children:t.date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"previous_balance",children:"Previous Balance"}),e.jsx(h,{id:"previous_balance",type:"number",step:"0.01",value:r.previous_balance,onChange:s=>a("previous_balance",s.target.value)}),t.previous_balance&&e.jsx("div",{className:"text-sm text-red-500",children:t.previous_balance})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"credit",children:"Credit Amount"}),e.jsx(h,{id:"credit",type:"number",step:"0.01",value:r.credit,onChange:s=>a("credit",s.target.value)}),t.credit&&e.jsx("div",{className:"text-sm text-red-500",children:t.credit})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"total_balance",children:"Total Balance"}),e.jsx(h,{id:"total_balance",type:"number",step:"0.01",value:r.total_balance,readOnly:!0,className:"cursor-not-allowed bg-gray-200"}),t.total_balance&&e.jsx("div",{className:"text-sm text-red-500",children:t.total_balance})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"debit",children:"Debit Amount"}),e.jsx(h,{id:"debit",type:"number",step:"0.01",value:r.debit,onChange:s=>a("debit",s.target.value)}),t.debit&&e.jsx("div",{className:"text-sm text-red-500",children:t.debit})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"tag",children:"Tag"}),e.jsxs(V,{value:r.tag_id,onValueChange:s=>a("tag_id",s),children:[e.jsx(Y,{children:e.jsx(z,{placeholder:"Select a tag"})}),e.jsx(q,{children:l.map(s=>e.jsx(J,{value:s.id.toString(),children:s.name},s.id))})]}),t.tag_id&&e.jsx("div",{className:"text-sm text-red-500",children:t.tag_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"current_balance",children:"Current Balance"}),e.jsx(h,{id:"current_balance",type:"number",step:"0.01",value:r.current_balance,readOnly:!0,className:"cursor-not-allowed bg-gray-200"}),t.current_balance&&e.jsx("div",{className:"text-sm text-red-500",children:t.current_balance})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(m,{htmlFor:"notes",children:"Notes"}),e.jsx("textarea",{id:"notes",className:"border-input bg-background ring-offset-background placeholder:text-muted-foreground focus-visible:ring-ring min-h-[60px] w-full rounded-md border px-3 py-2 text-sm focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",value:r.notes,onChange:s=>a("notes",s.target.value),placeholder:"Enter any additional notes...",rows:2}),t.notes&&e.jsx("div",{className:"text-sm text-red-500",children:t.notes})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(p,{type:"submit",disabled:u,children:u?"Recording...":"Record Transfer"})]})]})]})]})}function se({bankTransfers:l,onDeleteClick:n}){const{start_date:d,end_date:c}=R().props,r=a=>{if(!a)return"#";const o=new URL(a);return o.searchParams.set("start_date",d||""),o.searchParams.set("end_date",c||""),o.toString()};return e.jsxs(K,{children:[e.jsx(Q,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),"Bank Transfer Ledger"]})}),e.jsxs(X,{children:[e.jsxs(Z,{children:[e.jsx($,{children:e.jsxs(D,{children:[e.jsx(x,{children:"Date"}),e.jsx(x,{children:"Previous Balance"}),e.jsx(x,{children:"Credit"}),e.jsx(x,{children:"Total Balance"}),e.jsx(x,{children:"Debit"}),e.jsx(x,{children:"Tag"}),e.jsx(x,{children:"Current Balance"}),e.jsx(x,{children:"Notes"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(ee,{children:l.data.length>0?l.data.map(a=>e.jsxs(D,{children:[e.jsx(i,{children:a.date}),e.jsxs(i,{children:["GH₵",a.previous_balance||0]}),e.jsxs(i,{className:"text-green-600",children:["GH₵",a.credit||0]}),e.jsxs(i,{children:["GH₵",a.total_balance||0]}),e.jsxs(i,{className:"text-red-600",children:["GH₵",a.debit||0]}),e.jsx(i,{children:a.tag?a.tag.name:"No tag"}),e.jsxs(i,{className:"font-medium",children:["GH₵",a.current_balance||0]}),e.jsx(i,{className:"max-w-[200px]",children:e.jsx("span",{className:"truncate",children:a.notes||"-"})}),e.jsx(i,{className:"max-w-[200px]",children:e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>n(a.id),className:"h-8 w-8 bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-700",children:e.jsx(ae,{className:"h-4 w-4"})})})]},a.id)):e.jsx(D,{children:e.jsx(i,{colSpan:9,className:"text-muted-foreground text-center",children:"No bank transfers recorded for the selected date range"})})})]}),e.jsxs("div",{className:"my-3 flex items-center justify-center gap-4",children:[l.prev_page_url&&e.jsx(T,{preserveScroll:!0,preserveState:!0,href:r(l.prev_page_url),className:"rounded border px-4 py-2 hover:bg-gray-100",children:"« Previous"}),e.jsxs("span",{className:"px-4 py-2 font-medium",children:["Page ",l.current_page]}),l.next_page_url&&e.jsx(T,{preserveScroll:!0,preserveState:!0,href:r(l.next_page_url),className:"rounded border px-4 py-2 hover:bg-gray-100",children:"Next »"})]})]})]})}function re({isOpen:l,onClose:n,onConfirm:d}){return e.jsx(F,{open:l,onOpenChange:c=>!c&&n(),children:e.jsxs(B,{children:[e.jsx(A,{children:e.jsx(O,{children:"Delete Bank Transfer"})}),e.jsx("div",{className:"py-4",children:e.jsx("p",{children:"Are you sure you want to delete this bank transfer record? This action cannot be undone."})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(p,{variant:"outline",onClick:n,children:"Cancel"}),e.jsx(p,{className:"text-white",variant:"destructive",onClick:d,children:"Delete"})]})]})})}function ne({onAddTag:l}){const{data:n,setData:d,post:c,processing:r,errors:a,reset:o}=k({name:""});function u(t){t.preventDefault(),n.name.trim()&&c(route("bank-transfer-tags.store"),{preserveScroll:!0,onSuccess:()=>{o(),l()}})}return e.jsxs("form",{onSubmit:u,className:"flex items-center space-x-2",children:[e.jsx(h,{placeholder:"New tag name",value:n.name,onChange:t=>d("name",t.target.value),className:a.name?"border-red-500":""}),a.name&&e.jsx("div",{className:"text-sm text-red-500",children:a.name}),e.jsx(p,{type:"submit",variant:"outline",disabled:!n.name.trim()||r,children:"Add Tag"})]})}function fe({bank_transfers:l=[],tags:n=[],last_balance:d=0,start_date:c="",end_date:r=""}){const[a,o]=g.useState(!1),[u,t]=g.useState(null),j=new Date,_=new Date(j.getFullYear(),j.getMonth(),1).toISOString().slice(0,10),s=new Date(j.getFullYear(),j.getMonth()+1,0).toISOString().slice(0,10),[v,S]=g.useState(c||_),[b,y]=g.useState(r||s),C=(f,N)=>{const E=N==="start"?f:v,I=N==="end"?f:b;N==="start"&&S(f),N==="end"&&y(f),w.get(route("bank-transfers.index"),{start_date:E,end_date:I,page:1},{preserveState:!0,preserveScroll:!0,replace:!0})};function H(){u&&w.delete(route("bank-transfers.destroy",u),{method:"delete",preserveScroll:!0,preserveState:!1,onSuccess:()=>t(null)})}function P(){}return e.jsx(M,{breadcrumbs:[{title:"Bank Transfers",href:"/bank-transfers"}],children:e.jsxs("div",{className:"min-h-screen space-y-6 bg-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Bank Transfers"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(ne,{onAddTag:P}),e.jsx(te,{tags:n,lastBalance:d,isOpen:a,setIsOpen:o})]})]}),e.jsx(G,{startDate:v,endDate:b,onChange:C}),e.jsx(se,{bankTransfers:l,onDeleteClick:t}),e.jsx(re,{isOpen:!!u,onClose:()=>t(null),onConfirm:H})]})})}export{fe as default};
