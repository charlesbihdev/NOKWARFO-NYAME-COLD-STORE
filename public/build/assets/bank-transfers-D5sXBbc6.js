import{r as p,j as e,u as C,b as P,L as F,a as D}from"./app-DQhkPuQZ.js";import{B as I,A as E}from"./app-layout-6u-mPteH.js";import{D as R}from"./DateRangePicker-Qmh4BQVA.js";import{F as g}from"./createLucideIcon-VEZQV3Fw.js";import{D as T,a as W,b as L,c as B,d as H}from"./dialog-Ddjua7TT.js";import{I as u}from"./input-rTFlLLdT.js";import{L as h}from"./label-BqxiEfrF.js";import{S as $,a as Y,b as z,c as V,d as q}from"./select-CwcoJ1LA.js";import{C as J,a as K,b as Q,c as X}from"./card-DIopfx_o.js";import{T as Z,a as ee,b as k,c as m,d as te,e as x}from"./table-B076YVDd.js";import{T as se}from"./trash-2-DsXZJY4r.js";import"./index-Bt3EaTa5.js";import"./index-Cbe5flDp.js";import"./index-B90u_Dtf.js";function ae({statistics:t,startDate:r,endDate:c}){const[d,n]=p.useState(!1);if(!t)return null;const s=l=>{const a=new Date().toISOString().split("T")[0];return l===a},o=()=>r===c?s(r)?"Today":new Date(r).toLocaleDateString():`${new Date(r).toLocaleDateString()} - ${new Date(c).toLocaleDateString()}`;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"mb-4 text-lg font-semibold text-gray-700",children:["Period Summary (",o(),")"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-md bg-green-100",children:e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})}),e.jsxs("div",{className:"ml-4 flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Total Money IN"}),e.jsxs("p",{className:"text-base font-semibold text-green-600",children:["GH₵",parseFloat(t.total_credit).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Credit/Deposits"})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-md bg-red-100",children:e.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})})}),e.jsxs("div",{className:"ml-4 flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Total Money OUT"}),e.jsxs("p",{className:"text-base font-semibold text-red-600",children:["GH₵",parseFloat(t.total_debit).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Debit/Expenses"})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-md ${parseFloat(t.net_flow)>=0?"bg-green-100":"bg-orange-100"}`,children:e.jsx("svg",{className:`h-6 w-6 ${parseFloat(t.net_flow)>=0?"text-green-600":"text-orange-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})})}),e.jsxs("div",{className:"ml-4 flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Net Flow"}),e.jsxs("p",{className:`text-base font-semibold ${parseFloat(t.net_flow)>=0?"text-green-600":"text-orange-600"}`,children:[parseFloat(t.net_flow)>=0?"+":"","GH₵",Math.abs(parseFloat(t.net_flow)).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-gray-400",children:parseFloat(t.net_flow)>=0?"Profit":"Loss"})]})]})}),e.jsx("div",{className:"rounded-lg bg-white p-6 shadow border-2 border-blue-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-md bg-blue-100",children:e.jsx("svg",{className:"h-6 w-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),e.jsxs("div",{className:"ml-4 flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Today's Activity"}),e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsxs("span",{className:"text-xs font-semibold text-green-600",children:["+GH₵",parseFloat(t.today_credit).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("span",{className:"text-xs font-semibold text-red-600",children:["-GH₵",parseFloat(t.today_debit).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[t.today_count," transaction",t.today_count!==1?"s":""," today"]})]})]})})]})]}),t.tag_breakdown&&t.tag_breakdown.length>0&&e.jsxs("div",{className:"rounded-lg bg-white shadow",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 px-6 py-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Where is Your Money Going?"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Detailed breakdown of transactions by category"})]}),e.jsx("button",{onClick:()=>n(!d),className:"flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 transition-all hover:bg-gray-50 hover:border-gray-400",children:d?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Hide Details"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Show Details"]})})]}),d&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Money IN"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Money OUT"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Transactions"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Net Amount"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:t.tag_breakdown.map((l,a)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 flex-shrink-0",children:e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-gradient-to-br from-blue-400 to-blue-600",children:e.jsx("span",{className:"text-sm font-bold text-white",children:l.tag_name.charAt(0).toUpperCase()})})}),e.jsx("div",{className:"ml-3",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:l.tag_name})})]})}),e.jsxs("td",{className:"px-6 py-4 text-sm font-medium whitespace-nowrap text-right text-green-600",children:["+GH₵",parseFloat(l.total_credit).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("td",{className:"px-6 py-4 text-sm font-medium whitespace-nowrap text-right text-red-600",children:["-GH₵",parseFloat(l.total_debit).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("td",{className:"px-6 py-4 text-sm whitespace-nowrap text-center",children:e.jsxs("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-2.5 py-0.5 text-xs font-medium text-blue-800",children:[l.transaction_count," txn",l.transaction_count>1?"s":""]})}),e.jsx("td",{className:"px-6 py-4 text-sm font-medium whitespace-nowrap text-right",children:e.jsxs("span",{className:`font-semibold ${parseFloat(l.net_amount)>=0?"text-green-600":"text-orange-600"}`,children:[parseFloat(l.net_amount)>=0?"+":"","GH₵",Math.abs(parseFloat(l.net_amount)).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]},a))})]})})]})]})}function re({tags:t,lastBalance:r,isOpen:c,setIsOpen:d}){const{data:n,setData:s,post:o,processing:l,errors:a,reset:b}=C({date:new Date().toISOString().split("T")[0],previous_balance:r.toString(),credit:"0",total_balance:r.toString(),debit:"0",tag_id:"",current_balance:r.toString(),notes:""});p.useEffect(()=>{s(i=>({...i,previous_balance:r.toString(),total_balance:r.toString(),current_balance:r.toString()}))},[r]),p.useEffect(()=>{const i=parseFloat(n.previous_balance)||0,_=parseFloat(n.credit)||0,f=parseFloat(n.debit)||0,N=i+_,v=N-f;s(S=>({...S,total_balance:N.toFixed(2),current_balance:v.toFixed(2)}))},[n.previous_balance,n.credit,n.debit]);function j(i){i.preventDefault(),o(route("bank-transfers.store"),{preserveScroll:!0,preserveState:!0,only:["bank_transfers","last_balance","statistics","errors","flash"],onSuccess:()=>{b(),d(!1)}})}return e.jsxs(T,{open:c,onOpenChange:d,children:[e.jsx(W,{asChild:!0,children:e.jsx(g,{children:"Record Transfer"})}),e.jsxs(L,{className:"max-h-[96vh] max-w-2xl overflow-y-auto",children:[e.jsx(B,{children:e.jsx(H,{children:"Record Bank Transfer"})}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"date",children:"Date"}),e.jsx(u,{id:"date",type:"date",value:n.date,onChange:i=>s("date",i.target.value)}),a.date&&e.jsx("div",{className:"text-sm text-red-500",children:a.date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"previous_balance",children:"Previous Balance"}),e.jsx(u,{id:"previous_balance",type:"number",step:"0.01",value:n.previous_balance,onChange:i=>s("previous_balance",i.target.value)}),a.previous_balance&&e.jsx("div",{className:"text-sm text-red-500",children:a.previous_balance})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"credit",children:"Credit Amount"}),e.jsx(u,{id:"credit",type:"number",step:"0.01",value:n.credit,onChange:i=>s("credit",i.target.value)}),a.credit&&e.jsx("div",{className:"text-sm text-red-500",children:a.credit})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"total_balance",children:"Total Balance"}),e.jsx(u,{id:"total_balance",type:"number",step:"0.01",value:n.total_balance,readOnly:!0,className:"cursor-not-allowed bg-gray-200"}),a.total_balance&&e.jsx("div",{className:"text-sm text-red-500",children:a.total_balance})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"debit",children:"Debit Amount"}),e.jsx(u,{id:"debit",type:"number",step:"0.01",value:n.debit,onChange:i=>s("debit",i.target.value)}),a.debit&&e.jsx("div",{className:"text-sm text-red-500",children:a.debit})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"tag",children:"Tag"}),e.jsxs($,{value:n.tag_id,onValueChange:i=>s("tag_id",i),children:[e.jsx(Y,{children:e.jsx(z,{placeholder:"Select a tag"})}),e.jsx(V,{children:t.map(i=>e.jsx(q,{value:i.id.toString(),children:i.name},i.id))})]}),a.tag_id&&e.jsx("div",{className:"text-sm text-red-500",children:a.tag_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"current_balance",children:"Current Balance"}),e.jsx(u,{id:"current_balance",type:"number",step:"0.01",value:n.current_balance,readOnly:!0,className:"cursor-not-allowed bg-gray-200"}),a.current_balance&&e.jsx("div",{className:"text-sm text-red-500",children:a.current_balance})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(h,{htmlFor:"notes",children:"Notes"}),e.jsx("textarea",{id:"notes",className:"border-input bg-background ring-offset-background placeholder:text-muted-foreground focus-visible:ring-ring min-h-[60px] w-full rounded-md border px-3 py-2 text-sm focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",value:n.notes,onChange:i=>s("notes",i.target.value),placeholder:"Enter any additional notes...",rows:2}),a.notes&&e.jsx("div",{className:"text-sm text-red-500",children:a.notes})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(g,{type:"submit",disabled:l,children:l?"Recording...":"Record Transfer"})]})]})]})]})}function ne({bankTransfers:t,onDeleteClick:r}){const{start_date:c,end_date:d}=P().props,n=s=>{if(!s)return"#";const o=new URL(s);return o.searchParams.set("start_date",c||""),o.searchParams.set("end_date",d||""),o.toString()};return e.jsxs(J,{children:[e.jsx(K,{children:e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5"}),"Bank Transfer Ledger"]})}),e.jsxs(X,{children:[e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(k,{children:[e.jsx(m,{children:"Date"}),e.jsx(m,{children:"Previous Balance"}),e.jsx(m,{children:"Credit"}),e.jsx(m,{children:"Total Balance"}),e.jsx(m,{children:"Debit"}),e.jsx(m,{children:"Tag"}),e.jsx(m,{children:"Current Balance"}),e.jsx(m,{children:"Notes"}),e.jsx(m,{children:"Actions"})]})}),e.jsx(te,{children:t.data.length>0?t.data.map(s=>e.jsxs(k,{children:[e.jsx(x,{children:s.date}),e.jsxs(x,{children:["GH₵",s.previous_balance||0]}),e.jsxs(x,{className:"text-green-600",children:["GH₵",s.credit||0]}),e.jsxs(x,{children:["GH₵",s.total_balance||0]}),e.jsxs(x,{className:"text-red-600",children:["GH₵",s.debit||0]}),e.jsx(x,{children:s.tag?s.tag.name:"No tag"}),e.jsxs(x,{className:"font-medium",children:["GH₵",s.current_balance||0]}),e.jsx(x,{className:"max-w-[200px]",children:e.jsx("span",{className:"truncate",children:s.notes||"-"})}),e.jsx(x,{className:"max-w-[200px]",children:e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>r(s.id),className:"h-8 w-8 bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-700",children:e.jsx(se,{className:"h-4 w-4"})})})]},s.id)):e.jsx(k,{children:e.jsx(x,{colSpan:9,className:"text-muted-foreground text-center",children:"No bank transfers recorded for the selected date range"})})})]}),e.jsxs("div",{className:"my-3 flex items-center justify-center gap-4",children:[t.prev_page_url&&e.jsx(F,{preserveScroll:!0,preserveState:!0,href:n(t.prev_page_url),className:"rounded border px-4 py-2 hover:bg-gray-100",children:"« Previous"}),e.jsxs("span",{className:"px-4 py-2 font-medium",children:["Page ",t.current_page]}),t.next_page_url&&e.jsx(F,{preserveScroll:!0,preserveState:!0,href:n(t.next_page_url),className:"rounded border px-4 py-2 hover:bg-gray-100",children:"Next »"})]})]})]})}function ie({isOpen:t,onClose:r,onConfirm:c}){return e.jsx(T,{open:t,onOpenChange:d=>!d&&r(),children:e.jsxs(L,{children:[e.jsx(B,{children:e.jsx(H,{children:"Delete Bank Transfer"})}),e.jsx("div",{className:"py-4",children:e.jsx("p",{children:"Are you sure you want to delete this bank transfer record? This action cannot be undone."})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(g,{variant:"outline",onClick:r,children:"Cancel"}),e.jsx(g,{className:"text-white",variant:"destructive",onClick:c,children:"Delete"})]})]})})}function le({onAddTag:t}){const{data:r,setData:c,post:d,processing:n,errors:s,reset:o}=C({name:""});function l(a){a.preventDefault(),r.name.trim()&&d(route("bank-transfer-tags.store"),{preserveScroll:!0,onSuccess:()=>{o(),t()}})}return e.jsxs("form",{onSubmit:l,className:"flex items-center space-x-2",children:[e.jsx(u,{placeholder:"New tag name",value:r.name,onChange:a=>c("name",a.target.value),className:s.name?"border-red-500":""}),s.name&&e.jsx("div",{className:"text-sm text-red-500",children:s.name}),e.jsx(g,{type:"submit",variant:"outline",disabled:!r.name.trim()||n,children:"Add Tag"})]})}function ye({bank_transfers:t=[],tags:r=[],last_balance:c=0,start_date:d="",end_date:n="",statistics:s=null}){const[o,l]=p.useState(!1),[a,b]=p.useState(null),j=new Date,i=new Date(j.getFullYear(),j.getMonth(),1).toISOString().slice(0,10),_=new Date(j.getFullYear(),j.getMonth()+1,0).toISOString().slice(0,10),[f,N]=p.useState(d||i),[v,S]=p.useState(n||_),M=(y,w)=>{const O=w==="start"?y:f,U=w==="end"?y:v;w==="start"&&N(y),w==="end"&&S(y),D.get(route("bank-transfers.index"),{start_date:O,end_date:U,page:1},{preserveState:!0,preserveScroll:!0,replace:!0})};function A(){a&&D.delete(route("bank-transfers.destroy",a),{method:"delete",preserveScroll:!0,preserveState:!1,onSuccess:()=>b(null)})}function G(){}return e.jsx(E,{breadcrumbs:[{title:"Bank Transfers",href:"/bank-transfers"}],children:e.jsxs("div",{className:"min-h-screen space-y-6 bg-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Bank Transfers"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(le,{onAddTag:G}),e.jsx(re,{tags:r,lastBalance:c,isOpen:o,setIsOpen:l})]})]}),e.jsx(R,{startDate:f,endDate:v,onChange:M}),e.jsx(ae,{statistics:s,startDate:f,endDate:v}),e.jsx(ne,{bankTransfers:t,onDeleteClick:b}),e.jsx(ie,{isOpen:!!a,onClose:()=>b(null),onConfirm:A})]})})}export{ye as default};
