import{m as f,r as b,j as e,$ as v,S as k}from"./app-Cr2q6RgE.js";import{B as A,A as H}from"./app-layout-DY7q61lp.js";import{F as p}from"./createLucideIcon-BWJBnjvx.js";import{D as N,a as O,b as y,c as _,d as S}from"./dialog-MAc-lJ1S.js";import{I as u}from"./index-CG6i6Mhb.js";import{L as x}from"./label-CENo8H-f.js";import{S as I,a as R,b as G,c as E,d as L}from"./select-BOCfcHkJ.js";import{C as P,a as M,b as V,c as $}from"./card-BfpklwD7.js";import{T as z,a as q,b as j,c as i,d as J,e as d}from"./table-Cpg4yUgs.js";import{T as K}from"./trash-2-D-7b2KcM.js";import"./index-Cuxjp_Nf.js";import"./index-9UfKOC-3.js";import"./index-EZ40-6Qe.js";function Q({tags:n,lastBalance:c,isOpen:s,setIsOpen:o}){const{data:t,setData:l,post:m,processing:h,errors:a,reset:C}=f({date:new Date().toISOString().split("T")[0],previous_balance:c.toString(),credit:"0",total_balance:c.toString(),debit:"0",tag_id:"",current_balance:c.toString(),notes:""});b.useEffect(()=>{const r=parseFloat(t.previous_balance)||0,D=parseFloat(t.credit)||0,B=parseFloat(t.debit)||0,g=r+D,w=g-B;l(F=>({...F,total_balance:g.toFixed(2),current_balance:w.toFixed(2)}))},[t.previous_balance,t.credit,t.debit]);function T(r){r.preventDefault(),m(route("bank-transfers.store"),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{C(),o(!1)}})}return e.jsxs(N,{open:s,onOpenChange:o,children:[e.jsx(O,{asChild:!0,children:e.jsx(p,{children:"Record Transfer"})}),e.jsxs(y,{className:"max-w-2xl",children:[e.jsx(_,{children:e.jsx(S,{children:"Record Bank Transfer"})}),e.jsxs("form",{onSubmit:T,className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"date",children:"Date"}),e.jsx(u,{id:"date",type:"date",value:t.date,onChange:r=>l("date",r.target.value)}),a.date&&e.jsx("div",{className:"text-sm text-red-500",children:a.date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"previous_balance",children:"Previous Balance"}),e.jsx(u,{id:"previous_balance",type:"number",step:"0.01",value:t.previous_balance,onChange:r=>l("previous_balance",r.target.value)}),a.previous_balance&&e.jsx("div",{className:"text-sm text-red-500",children:a.previous_balance})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"credit",children:"Credit Amount"}),e.jsx(u,{id:"credit",type:"number",step:"0.01",value:t.credit,onChange:r=>l("credit",r.target.value)}),a.credit&&e.jsx("div",{className:"text-sm text-red-500",children:a.credit})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"total_balance",children:"Total Balance"}),e.jsx(u,{id:"total_balance",type:"number",step:"0.01",value:t.total_balance,readOnly:!0,className:"cursor-not-allowed bg-gray-200"}),a.total_balance&&e.jsx("div",{className:"text-sm text-red-500",children:a.total_balance})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"debit",children:"Debit Amount"}),e.jsx(u,{id:"debit",type:"number",step:"0.01",value:t.debit,onChange:r=>l("debit",r.target.value)}),a.debit&&e.jsx("div",{className:"text-sm text-red-500",children:a.debit})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"tag",children:"Tag"}),e.jsxs(I,{value:t.tag_id,onValueChange:r=>l("tag_id",r),children:[e.jsx(R,{children:e.jsx(G,{placeholder:"Select a tag"})}),e.jsx(E,{children:n.map(r=>e.jsx(L,{value:r.id.toString(),children:r.name},r.id))})]}),a.tag_id&&e.jsx("div",{className:"text-sm text-red-500",children:a.tag_id})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"current_balance",children:"Current Balance"}),e.jsx(u,{id:"current_balance",type:"number",step:"0.01",value:t.current_balance,readOnly:!0,className:"cursor-not-allowed bg-gray-200"}),a.current_balance&&e.jsx("div",{className:"text-sm text-red-500",children:a.current_balance})]}),e.jsxs("div",{className:"col-span-2 space-y-2",children:[e.jsx(x,{htmlFor:"notes",children:"Notes"}),e.jsx("textarea",{id:"notes",className:"border-input bg-background ring-offset-background placeholder:text-muted-foreground focus-visible:ring-ring min-h-[100px] w-full rounded-md border px-3 py-2 text-sm focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",value:t.notes,onChange:r=>l("notes",r.target.value),placeholder:"Enter any additional notes..."}),a.notes&&e.jsx("div",{className:"text-sm text-red-500",children:a.notes})]})]}),e.jsx(p,{type:"submit",disabled:h,children:h?"Recording...":"Record Transfer"})]})]})]})}function U({bankTransfers:n,onDeleteClick:c}){return e.jsxs(P,{children:[e.jsx(M,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Bank Transfer Ledger"]})}),e.jsxs($,{children:[e.jsxs(z,{children:[e.jsx(q,{children:e.jsxs(j,{children:[e.jsx(i,{children:"Date"}),e.jsx(i,{children:"Previous Balance"}),e.jsx(i,{children:"Credit"}),e.jsx(i,{children:"Total Balance"}),e.jsx(i,{children:"Debit"}),e.jsx(i,{children:"Tag"}),e.jsx(i,{children:"Current Balance"}),e.jsx(i,{children:"Notes"}),e.jsx(i,{children:"Actions"})]})}),e.jsx(J,{children:n.data.length>0?n.data.map(s=>e.jsxs(j,{children:[e.jsx(d,{children:s.date}),e.jsxs(d,{children:["GH₵",s.previous_balance||0]}),e.jsxs(d,{className:"text-green-600",children:["GH₵",s.credit||0]}),e.jsxs(d,{children:["GH₵",s.total_balance||0]}),e.jsxs(d,{className:"text-red-600",children:["GH₵",s.debit||0]}),e.jsx(d,{children:s.tag?s.tag.name:"No tag"}),e.jsxs(d,{className:"font-medium",children:["GH₵",s.current_balance||0]}),e.jsx(d,{className:"max-w-[200px]",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"truncate",children:s.notes||"-"}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>c(s.id),className:"h-8 w-8 bg-red-50 text-red-600 hover:bg-red-100 hover:text-red-700",children:e.jsx(K,{className:"h-4 w-4"})})]})})]},s.id)):e.jsx(j,{children:e.jsx(d,{colSpan:9,className:"text-muted-foreground text-center",children:"No bank transfers recorded yet"})})})]}),e.jsxs("div",{className:"my-3 flex items-center justify-center gap-4",children:[n.prev_page_url&&e.jsx(v,{preserveScroll:!0,preserveState:!0,href:n.prev_page_url,className:"rounded border px-4 py-2 hover:bg-gray-100",children:"« Previous"}),e.jsxs("span",{className:"px-4 py-2 font-medium",children:["Page ",n.current_page]}),n.next_page_url&&e.jsx(v,{preserveScroll:!0,preserveState:!0,href:n.next_page_url,className:"rounded border px-4 py-2 hover:bg-gray-100",children:"Next »"})]})]})]})}function W({isOpen:n,onClose:c,onConfirm:s}){return e.jsx(N,{open:n,onOpenChange:o=>!o&&c(),children:e.jsxs(y,{children:[e.jsx(_,{children:e.jsx(S,{children:"Delete Bank Transfer"})}),e.jsx("div",{className:"py-4",children:e.jsx("p",{children:"Are you sure you want to delete this bank transfer record? This action cannot be undone."})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(p,{variant:"outline",onClick:c,children:"Cancel"}),e.jsx(p,{className:"text-white",variant:"destructive",onClick:s,children:"Delete"})]})]})})}function X({onAddTag:n}){const{data:c,setData:s,post:o,processing:t,errors:l,reset:m}=f({name:""});function h(a){a.preventDefault(),c.name.trim()&&o(route("bank-transfer-tags.store"),{preserveScroll:!0,onSuccess:()=>{m(),n()}})}return e.jsxs("form",{onSubmit:h,className:"flex items-center space-x-2",children:[e.jsx(u,{placeholder:"New tag name",value:c.name,onChange:a=>s("name",a.target.value),className:l.name?"border-red-500":""}),l.name&&e.jsx("div",{className:"text-sm text-red-500",children:l.name}),e.jsx(p,{type:"submit",variant:"outline",disabled:!c.name.trim()||t,children:"Add Tag"})]})}function xe({bank_transfers:n=[],tags:c=[],last_balance:s=0}){const[o,t]=b.useState(!1),[l,m]=b.useState(null);function h(){l&&k.delete(route("bank-transfers.destroy",l),{method:"delete",preserveScroll:!0,preserveState:!1,onSuccess:()=>m(null)})}function a(){}return e.jsx(H,{breadcrumbs:[{title:"Bank Transfers",href:"/bank-transfers"}],children:e.jsxs("div",{className:"min-h-screen space-y-6 bg-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Bank Transfers"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(X,{onAddTag:a}),e.jsx(Q,{tags:c,lastBalance:s,isOpen:o,setIsOpen:t})]})]}),e.jsx(U,{bankTransfers:n,onDeleteClick:m}),e.jsx(W,{isOpen:!!l,onClose:()=>m(null),onConfirm:h})]})})}export{xe as default};
