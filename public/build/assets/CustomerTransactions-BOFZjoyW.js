import{r as P,u as S,j as e,H,L as h}from"./app-CSpnaBUl.js";import{A as F,M as L,S as R}from"./app-layout-CWV4g8tt.js";import{C as d,a as c,b as i,c as x,d as A}from"./card-DpGhQ29Y.js";import{c as B,F as j}from"./createLucideIcon-QiRiosVH.js";import{I as M}from"./index-DLSs-Ycf.js";import{L as y}from"./label-CAW60j__.js";import{T as k}from"./textarea-D_KU1JBi.js";import{B as N}from"./badge-COLQlMEF.js";import{D as I,a as O,b as $,c as q,d as z,e as E,f as G}from"./dialog-ap17z-JQ.js";import{T as U,a as J,b as f,c as l,d as K,e as n}from"./table-B3iHrbkm.js";import{P as Q}from"./plus-BhIQGGLC.js";import{P as V,M as W}from"./phone-BEseQiGm.js";import{C as X}from"./calendar-Dbu_Q80G.js";import{D as Y}from"./dollar-sign-FtfDRhbg.js";import"./index-Bc7ey0Ni.js";import"./index-B3_FoTJa.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ee=B("ArrowLeft",Z);function ue({customer:a,transactions:r}){const[v,m]=P.useState(!1),{data:p,setData:g,post:_,processing:u,errors:b,reset:w}=S({amount_collected:"",notes:""}),C=s=>{s.preventDefault(),_(route("customers.payments.store",a.id),{onSuccess:()=>{m(!1),w()}})},D=s=>{switch(s){case"paid":return"bg-green-100 text-green-800";case"current":return"bg-blue-100 text-blue-800";case"overdue_30":return"bg-yellow-100 text-yellow-800";case"overdue_60":return"bg-orange-100 text-orange-800";case"overdue_90":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},t=s=>new Intl.NumberFormat("en-GH",{style:"currency",currency:"GHS"}).format(s);return e.jsxs(F,{children:[e.jsx(H,{title:`${a.name} - Transaction History`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(h,{href:route("customers.index"),className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 mb-4",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Back to Customers"]}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:a.name}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Transaction History & Debt Management"})]}),e.jsxs(I,{open:v,onOpenChange:m,children:[e.jsx(O,{asChild:!0,children:e.jsxs(j,{className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Record Payment"]})}),e.jsxs($,{children:[e.jsxs(q,{children:[e.jsx(z,{children:"Record Payment"}),e.jsxs(E,{children:["Record a payment from ",a.name," against their outstanding debt."]})]}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"amount_collected",children:"Amount Collected"}),e.jsx(M,{id:"amount_collected",type:"number",step:"0.01",value:p.amount_collected,onChange:s=>g("amount_collected",s.target.value),placeholder:"0.00",required:!0}),b.amount_collected&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:b.amount_collected})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"notes",children:"Notes (Optional)"}),e.jsx(k,{id:"notes",value:p.notes,onChange:s=>g("notes",s.target.value),placeholder:"Payment notes...",rows:3})]})]}),e.jsxs(G,{className:"mt-6",children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(j,{type:"submit",disabled:u,children:u?"Recording...":"Record Payment"})]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs(d,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium text-gray-600",children:"Total Debt"})}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:t(a.total_debt)})})]}),e.jsxs(d,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium text-gray-600",children:"Outstanding Balance"})}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:t(a.outstanding_balance)})})]}),e.jsxs(d,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium text-gray-600",children:"Total Payments"})}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t(a.total_payments)})})]}),e.jsxs(d,{children:[e.jsx(c,{className:"pb-2",children:e.jsx(i,{className:"text-sm font-medium text-gray-600",children:"Status"})}),e.jsx(x,{children:e.jsx(N,{className:D(a.outstanding_balance>0?"overdue_30":"paid"),children:a.outstanding_balance>0?"Has Outstanding Debt":"Paid Up"})})]})]}),e.jsxs(d,{className:"mb-8",children:[e.jsx(c,{children:e.jsx(i,{children:"Customer Information"})}),e.jsx(x,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:a.phone||"No phone number"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(W,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:a.email||"No email address"})]}),a.address&&e.jsxs("div",{className:"flex items-start space-x-2 md:col-span-2",children:[e.jsx(L,{className:"w-4 h-4 text-gray-500 mt-0.5"}),e.jsx("span",{className:"text-sm text-gray-600",children:a.address})]})]})})]}),e.jsxs(d,{children:[e.jsxs(c,{children:[e.jsx(i,{children:"Transaction History"}),e.jsx(A,{children:"Complete history of debt transactions and payments"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(U,{children:[e.jsx(J,{children:e.jsxs(f,{children:[e.jsx(l,{children:"Date"}),e.jsx(l,{children:"Type"}),e.jsx(l,{children:"Reference"}),e.jsx(l,{children:"Description"}),e.jsx(l,{className:"text-right",children:"Debt Amount"}),e.jsx(l,{className:"text-right",children:"Payment Amount"}),e.jsx(l,{className:"text-right",children:"Balance"})]})}),e.jsx(K,{children:r.data.map(s=>e.jsxs(f,{children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:s.date})]})}),e.jsx(n,{children:e.jsx(N,{className:`capitalize ${s.type==="debt"?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"}`,children:s.type==="debt"?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"w-3 h-3 mr-1"}),"Debt"]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"w-3 h-3 mr-1"}),"Payment"]})})}),e.jsx(n,{className:"font-mono text-sm",children:s.reference}),e.jsx(n,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.description}),s.notes&&e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:s.notes}),s.sale_items&&s.sale_items.length>0&&e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:s.sale_items.map((o,T)=>e.jsxs("div",{children:[o.product," - ",o.quantity," @ ",t(o.unit_price)]},T))})]})}),e.jsx(n,{className:"text-right",children:s.debt_amount>0?e.jsxs("span",{className:"text-red-600 font-medium",children:["+",t(s.debt_amount)]}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx(n,{className:"text-right",children:s.payment_amount>0?e.jsxs("span",{className:"text-green-600 font-medium",children:["-",t(s.payment_amount)]}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx(n,{className:"text-right",children:e.jsx("span",{className:`font-bold ${s.current_balance>0?"text-red-600":"text-green-600"}`,children:t(s.current_balance)})})]},s.id))})]})}),(r.prev_page_url||r.next_page_url)&&e.jsxs("div",{className:"mt-6 flex items-center justify-center gap-4",children:[r.prev_page_url?e.jsx(h,{href:r.prev_page_url,preserveState:!0,preserveScroll:!0,className:"rounded border px-3 py-1 bg-white hover:bg-gray-100",children:"Previous"}):e.jsx("span",{className:"rounded border px-3 py-1 cursor-not-allowed bg-gray-200",children:"Previous"}),e.jsx("span",{className:"rounded border px-3 py-1",children:r.current_page}),r.next_page_url?e.jsx(h,{href:r.next_page_url,preserveState:!0,preserveScroll:!0,className:"rounded border px-3 py-1 bg-white hover:bg-gray-100",children:"Next"}):e.jsx("span",{className:"rounded border px-3 py-1 cursor-not-allowed bg-gray-200",children:"Next"})]})]})]})]})})]})}export{ue as default};
