import{r as S,u as H,j as e,H as F,L as g}from"./app-BsTl-jtS.js";import{B as N}from"./badge-Basujmit.js";import{c as L,F as u}from"./createLucideIcon-DqPu5nj0.js";import{C as d,a as i,b as c,c as x,d as R}from"./card-CpArIIAG.js";import{D as A,a as B,b as I,c as M,d as k,e as O,f as q}from"./dialog-Dr4RSNtO.js";import{I as f}from"./input-DNFionIr.js";import{L as y}from"./label-Ce2cjAzt.js";import{T as $,a as z,b as v,c as l,d as E,e as n}from"./table-Cb5fe21K.js";import{T as G}from"./textarea-B9EwZDcA.js";import{A as U,M as J,S as K}from"./app-layout-CxsX89b6.js";import{P as Q}from"./plus-bko0k5mB.js";import{P as V,M as W}from"./phone-D4ajUH9d.js";import{C as X}from"./calendar-C3F2nz_B.js";import{D as Y}from"./dollar-sign-D5C6XolU.js";import"./index-D_DDstXb.js";import"./index-BvTb0DQp.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ee=L("ArrowLeft",Z);function ue({customer:a,transactions:t}){const[_,o]=S.useState(!1),{data:h,setData:p,post:w,processing:b,errors:m,reset:C}=H({amount_collected:"",payment_date:new Date().toISOString().split("T")[0],notes:""}),D=s=>{s.preventDefault(),w(route("customers.payments.store",a.id),{onSuccess:()=>{o(!1),C()}})},T=s=>{switch(s){case"paid":return"bg-green-100 text-green-800";case"current":return"bg-blue-100 text-blue-800";case"overdue_30":return"bg-yellow-100 text-yellow-800";case"overdue_60":return"bg-orange-100 text-orange-800";case"overdue_90":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},r=s=>new Intl.NumberFormat("en-GH",{style:"currency",currency:"GHS"}).format(s);return e.jsxs(U,{children:[e.jsx(F,{title:`${a.name} - Transaction History`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(g,{href:route("customers.index"),className:"mb-4 inline-flex items-center text-sm text-gray-600 hover:text-gray-900",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Back to Customers"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:a.name}),e.jsx("p",{className:"mt-1 text-gray-600",children:"Transaction History & Debt Management"})]}),e.jsxs(A,{open:_,onOpenChange:o,children:[e.jsx(B,{asChild:!0,children:e.jsxs(u,{className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),"Record Payment"]})}),e.jsxs(I,{children:[e.jsxs(M,{children:[e.jsx(k,{children:"Record Payment"}),e.jsxs(O,{children:["Record a payment from ",a.name," against their outstanding debt."]})]}),e.jsxs("form",{onSubmit:D,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"amount_collected",children:"Amount Collected"}),e.jsx(f,{id:"amount_collected",type:"number",step:"0.01",value:h.amount_collected,onChange:s=>p("amount_collected",s.target.value),placeholder:"0.00",required:!0}),m.amount_collected&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:m.amount_collected})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"payment_date",children:"Payment Date"}),e.jsx(f,{id:"payment_date",type:"date",value:h.payment_date,onChange:s=>p("payment_date",s.target.value),required:!0}),m.payment_date&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:m.payment_date})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"notes",children:"Notes (Optional)"}),e.jsx(G,{id:"notes",value:h.notes,onChange:s=>p("notes",s.target.value),placeholder:"Payment notes...",rows:3})]})]}),e.jsxs(q,{className:"mt-6",children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(u,{type:"submit",disabled:b,children:b?"Recording...":"Record Payment"})]})]})]})]})]})]}),e.jsxs("div",{className:"mb-8 grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(d,{children:[e.jsx(i,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"Total Debt"})}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:r(a.total_debt)})})]}),e.jsxs(d,{children:[e.jsx(i,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"Outstanding Balance"})}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:r(a.outstanding_balance)})})]}),e.jsxs(d,{children:[e.jsx(i,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"Total Payments"})}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:r(a.total_payments)})})]}),e.jsxs(d,{children:[e.jsx(i,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium text-gray-600",children:"Status"})}),e.jsx(x,{children:e.jsx(N,{className:T(a.outstanding_balance>0?"overdue_30":"paid"),children:a.outstanding_balance>0?"Has Outstanding Debt":"Paid Up"})})]})]}),e.jsxs(d,{className:"mb-8",children:[e.jsx(i,{children:e.jsx(c,{children:"Customer Information"})}),e.jsx(x,{children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:a.phone||"No phone number"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(W,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:a.email||"No email address"})]}),a.address&&e.jsxs("div",{className:"flex items-start space-x-2 md:col-span-2",children:[e.jsx(J,{className:"mt-0.5 h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:a.address})]})]})})]}),e.jsxs(d,{children:[e.jsxs(i,{children:[e.jsx(c,{children:"Transaction History"}),e.jsx(R,{children:"Complete history of debt transactions and payments"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs($,{children:[e.jsx(z,{children:e.jsxs(v,{children:[e.jsx(l,{children:"Date"}),e.jsx(l,{children:"Type"}),e.jsx(l,{children:"Reference"}),e.jsx(l,{children:"Description"}),e.jsx(l,{className:"text-right",children:"Debt Amount"}),e.jsx(l,{className:"text-right",children:"Payment Amount"}),e.jsx(l,{className:"text-right",children:"Balance"})]})}),e.jsx(E,{children:t.data.map(s=>e.jsxs(v,{children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:s.date})]})}),e.jsx(n,{children:e.jsx(N,{className:`capitalize ${s.type==="debt"?"bg-red-600 text-white hover:bg-red-700":"bg-green-600 text-white hover:bg-green-700"}`,children:s.type==="debt"?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"mr-1 h-3 w-3"}),"Debt"]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"mr-1 h-3 w-3"}),"Payment"]})})}),e.jsx(n,{className:"font-mono text-sm",children:s.reference}),e.jsx(n,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.description}),s.notes&&e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:s.notes}),s.sale_items&&s.sale_items.length>0&&e.jsx("div",{className:"mt-1 text-sm text-gray-600",children:s.sale_items.map((j,P)=>e.jsxs("div",{children:[j.product," - ",j.quantity," @ ",r(j.unit_price)]},P))})]})}),e.jsx(n,{className:"text-right",children:s.debt_amount>0?e.jsxs("span",{className:"font-medium text-red-600",children:["+",r(s.debt_amount)]}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx(n,{className:"text-right",children:s.payment_amount>0?e.jsxs("span",{className:"font-medium text-green-600",children:["-",r(s.payment_amount)]}):e.jsx("span",{className:"text-gray-500",children:"-"})}),e.jsx(n,{className:"text-right",children:e.jsx("span",{className:`font-bold ${s.current_balance>0?"text-red-600":"text-green-600"}`,children:r(s.current_balance)})})]},s.id))})]})}),(t.prev_page_url||t.next_page_url)&&e.jsxs("div",{className:"mt-6 flex items-center justify-center gap-4",children:[t.prev_page_url?e.jsx(g,{href:t.prev_page_url,preserveState:!0,preserveScroll:!0,className:"rounded border bg-white px-3 py-1 hover:bg-gray-100",children:"Previous"}):e.jsx("span",{className:"cursor-not-allowed rounded border bg-gray-200 px-3 py-1",children:"Previous"}),e.jsx("span",{className:"rounded border px-3 py-1",children:t.current_page}),t.next_page_url?e.jsx(g,{href:t.next_page_url,preserveState:!0,preserveScroll:!0,className:"rounded border bg-white px-3 py-1 hover:bg-gray-100",children:"Next"}):e.jsx("span",{className:"cursor-not-allowed rounded border bg-gray-200 px-3 py-1",children:"Next"})]})]})]})]})})]})}export{ue as default};
